
<!doctype html>
<html itemscope = "" lang = "zh-CN">
<head>
<meta charset = "UTF-8">
<meta content = "origin" name = "referrer">
<script src="js/highlight/highlight.min.js"></script>
<link rel="stylesheet" type="text/css" href="js/highlight/styles/lioshi.min.css"/>
<style type="text/css">
.library{}
.sb::-webkit-scrollbar {width: 10px; height: 1px;}
.sb::-webkit-scrollbar-thumb {border-radius: 10px;box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);background: #838383;}
.sb::-webkit-scrollbar-track {box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);border-radius: 10px;background: #ededed;}
.entry{color:;background-color:;padding-left:236px;}
.entrytitle{text-align:center;background-color:#efefef;font-weight: bold;height: 48px;line-height:48px;}
.function{color:#0;}
.instvar{color:;background-color:#f8f8f8;}
.proto{color:;background-color:#f8f8f8;}
.comment{color:#2a2;}
table{width:100%;}
.contexts{font-size: small;border:1px solid;background-color:#f8fbf8;overflow-y:auto;height:100%;width:230px;position:fixed; z-index:999; top:0px;left: 0px;}
.grayrow{background-color:#e8ebe8;}
</style>

<title>pbidea manual</title>
<script>
window.onload = function(){
    //alert('window.onload');
//hljs.highlightAll();
}
document.load = function(){
    //alert('document.ready');
}
 hljs.initHighlightingOnLoad();
//hljs.highlightAll();
</script>
</head>
<body>
<div id="contexts" class="contexts sb">
<table>
<tr><td align="center" width=32px>1</td><td><a href="#uo_7z">uo_7z</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>2</td><td class="grayrow"><a href="#uo_asn1">uo_asn1</a></td><td></td></tr>
<tr><td align="center" width=32px>3</td><td><a href="#uo_autoresize">uo_autoresize</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>4</td><td class="grayrow"><a href="#uo_bcrypto">uo_bcrypto</a></td><td></td></tr>
<tr><td align="center" width=32px>5</td><td><a href="#uo_biginteger">uo_biginteger</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>6</td><td class="grayrow"><a href="#uo_bits">uo_bits</a></td><td></td></tr>
<tr><td align="center" width=32px>7</td><td><a href="#uo_blob">uo_blob</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>8</td><td class="grayrow"><a href="#uo_bson">uo_bson</a></td><td></td></tr>
<tr><td align="center" width=32px>9</td><td><a href="#uo_bson_iter">uo_bson_iter</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>10</td><td class="grayrow"><a href="#uo_buffer">uo_buffer</a></td><td></td></tr>
<tr><td align="center" width=32px>11</td><td><a href="#uo_calculator">uo_calculator</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>12</td><td class="grayrow"><a href="#uo_calendar">uo_calendar</a></td><td></td></tr>
<tr><td align="center" width=32px>13</td><td><a href="#uo_camera">uo_camera</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>14</td><td class="grayrow"><a href="#uo_charset">uo_charset</a></td><td></td></tr>
<tr><td align="center" width=32px>15</td><td><a href="#uo_compress">uo_compress</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>16</td><td class="grayrow"><a href="#uo_config">uo_config</a></td><td></td></tr>
<tr><td align="center" width=32px>17</td><td><a href="#uo_cover">uo_cover</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>18</td><td class="grayrow"><a href="#uo_crypto">uo_crypto</a></td><td></td></tr>
<tr><td align="center" width=32px>19</td><td><a href="#uo_csharp">uo_csharp</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>20</td><td class="grayrow"><a href="#uo_csharp_object">uo_csharp_object</a></td><td></td></tr>
<tr><td align="center" width=32px>21</td><td><a href="#uo_curl">uo_curl</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>22</td><td class="grayrow"><a href="#uo_curl_async">uo_curl_async</a></td><td></td></tr>
<tr><td align="center" width=32px>23</td><td><a href="#uo_datawindowex">uo_datawindowex</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>24</td><td class="grayrow"><a href="#uo_datetime">uo_datetime</a></td><td></td></tr>
<tr><td align="center" width=32px>25</td><td><a href="#uo_dbf">uo_dbf</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>26</td><td class="grayrow"><a href="#uo_dib">uo_dib</a></td><td></td></tr>
<tr><td align="center" width=32px>27</td><td><a href="#uo_dicom">uo_dicom</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>28</td><td class="grayrow"><a href="#uo_dir">uo_dir</a></td><td></td></tr>
<tr><td align="center" width=32px>29</td><td><a href="#uo_dir_watcher">uo_dir_watcher</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>30</td><td class="grayrow"><a href="#uo_dll">uo_dll</a></td><td></td></tr>
<tr><td align="center" width=32px>31</td><td><a href="#uo_dns">uo_dns</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>32</td><td class="grayrow"><a href="#uo_dragfile">uo_dragfile</a></td><td></td></tr>
<tr><td align="center" width=32px>33</td><td><a href="#uo_eventlog">uo_eventlog</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>34</td><td class="grayrow"><a href="#uo_file">uo_file</a></td><td></td></tr>
<tr><td align="center" width=32px>35</td><td><a href="#uo_font">uo_font</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>36</td><td class="grayrow"><a href="#uo_ftp">uo_ftp</a></td><td></td></tr>
<tr><td align="center" width=32px>37</td><td><a href="#uo_ftp_server">uo_ftp_server</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>38</td><td class="grayrow"><a href="#uo_hardware">uo_hardware</a></td><td></td></tr>
<tr><td align="center" width=32px>39</td><td><a href="#uo_hook">uo_hook</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>40</td><td class="grayrow"><a href="#uo_htmlrender">uo_htmlrender</a></td><td></td></tr>
<tr><td align="center" width=32px>41</td><td><a href="#uo_httpclient">uo_httpclient</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>42</td><td class="grayrow"><a href="#uo_i18n">uo_i18n</a></td><td></td></tr>
<tr><td align="center" width=32px>43</td><td><a href="#uo_image">uo_image</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>44</td><td class="grayrow"><a href="#uo_imageview">uo_imageview</a></td><td></td></tr>
<tr><td align="center" width=32px>45</td><td><a href="#uo_instance">uo_instance</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>46</td><td class="grayrow"><a href="#uo_json">uo_json</a></td><td></td></tr>
<tr><td align="center" width=32px>47</td><td><a href="#uo_json_s">uo_json_s</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>48</td><td class="grayrow"><a href="#uo_jwt">uo_jwt</a></td><td></td></tr>
<tr><td align="center" width=32px>49</td><td><a href="#uo_kafka_consumer">uo_kafka_consumer</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>50</td><td class="grayrow"><a href="#uo_kafka_producer">uo_kafka_producer</a></td><td></td></tr>
<tr><td align="center" width=32px>51</td><td><a href="#uo_kv">uo_kv</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>52</td><td class="grayrow"><a href="#uo_logfile">uo_logfile</a></td><td></td></tr>
<tr><td align="center" width=32px>53</td><td><a href="#uo_logger">uo_logger</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>54</td><td class="grayrow"><a href="#uo_lua">uo_lua</a></td><td></td></tr>
<tr><td align="center" width=32px>55</td><td><a href="#uo_mail">uo_mail</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>56</td><td class="grayrow"><a href="#uo_map">uo_map</a></td><td></td></tr>
<tr><td align="center" width=32px>57</td><td><a href="#uo_menuex">uo_menuex</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>58</td><td class="grayrow"><a href="#uo_messagebox_options">uo_messagebox_options</a></td><td></td></tr>
<tr><td align="center" width=32px>59</td><td><a href="#uo_messagewidget">uo_messagewidget</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>60</td><td class="grayrow"><a href="#uo_modbus_tcp">uo_modbus_tcp</a></td><td></td></tr>
<tr><td align="center" width=32px>61</td><td><a href="#uo_monitor">uo_monitor</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>62</td><td class="grayrow"><a href="#uo_mouseevent">uo_mouseevent</a></td><td></td></tr>
<tr><td align="center" width=32px>63</td><td><a href="#uo_mqtt">uo_mqtt</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>64</td><td class="grayrow"><a href="#uo_ofdreader">uo_ofdreader</a></td><td></td></tr>
<tr><td align="center" width=32px>65</td><td><a href="#uo_ofdserver">uo_ofdserver</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>66</td><td class="grayrow"><a href="#uo_ofdview">uo_ofdview</a></td><td></td></tr>
<tr><td align="center" width=32px>67</td><td><a href="#uo_orca">uo_orca</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>68</td><td class="grayrow"><a href="#uo_painter">uo_painter</a></td><td></td></tr>
<tr><td align="center" width=32px>69</td><td><a href="#uo_pdfmaker">uo_pdfmaker</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>70</td><td class="grayrow"><a href="#uo_pdfview">uo_pdfview</a></td><td></td></tr>
<tr><td align="center" width=32px>71</td><td><a href="#uo_pdfwriter">uo_pdfwriter</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>72</td><td class="grayrow"><a href="#uo_printer">uo_printer</a></td><td></td></tr>
<tr><td align="center" width=32px>73</td><td><a href="#uo_printer_usb">uo_printer_usb</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>74</td><td class="grayrow"><a href="#uo_process">uo_process</a></td><td></td></tr>
<tr><td align="center" width=32px>75</td><td><a href="#uo_progress">uo_progress</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>76</td><td class="grayrow"><a href="#uo_progress_dialog">uo_progress_dialog</a></td><td></td></tr>
<tr><td align="center" width=32px>77</td><td><a href="#uo_rabbitmq">uo_rabbitmq</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>78</td><td class="grayrow"><a href="#uo_rabbitmq_exchange">uo_rabbitmq_exchange</a></td><td></td></tr>
<tr><td align="center" width=32px>79</td><td><a href="#uo_rabbitmq_queue">uo_rabbitmq_queue</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>80</td><td class="grayrow"><a href="#uo_redis">uo_redis</a></td><td></td></tr>
<tr><td align="center" width=32px>81</td><td><a href="#uo_redisasync">uo_redisasync</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>82</td><td class="grayrow"><a href="#uo_redisreply">uo_redisreply</a></td><td></td></tr>
<tr><td align="center" width=32px>83</td><td><a href="#uo_response">uo_response</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>84</td><td class="grayrow"><a href="#uo_rsa">uo_rsa</a></td><td></td></tr>
<tr><td align="center" width=32px>85</td><td><a href="#uo_scintilla">uo_scintilla</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>86</td><td class="grayrow"><a href="#uo_script">uo_script</a></td><td></td></tr>
<tr><td align="center" width=32px>87</td><td><a href="#uo_script2">uo_script2</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>88</td><td class="grayrow"><a href="#uo_sdtapi">uo_sdtapi</a></td><td></td></tr>
<tr><td align="center" width=32px>89</td><td><a href="#uo_serial">uo_serial</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>90</td><td class="grayrow"><a href="#uo_sftp">uo_sftp</a></td><td></td></tr>
<tr><td align="center" width=32px>91</td><td><a href="#uo_sharedata">uo_sharedata</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>92</td><td class="grayrow"><a href="#uo_shellapi">uo_shellapi</a></td><td></td></tr>
<tr><td align="center" width=32px>93</td><td><a href="#uo_socket_client">uo_socket_client</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>94</td><td class="grayrow"><a href="#uo_socket_server">uo_socket_server</a></td><td></td></tr>
<tr><td align="center" width=32px>95</td><td><a href="#uo_socket_server_thread">uo_socket_server_thread</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>96</td><td class="grayrow"><a href="#uo_socket_udp_client">uo_socket_udp_client</a></td><td></td></tr>
<tr><td align="center" width=32px>97</td><td><a href="#uo_speak">uo_speak</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>98</td><td class="grayrow"><a href="#uo_speak_recognizer">uo_speak_recognizer</a></td><td></td></tr>
<tr><td align="center" width=32px>99</td><td><a href="#uo_sqlite3">uo_sqlite3</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>100</td><td class="grayrow"><a href="#uo_string">uo_string</a></td><td></td></tr>
<tr><td align="center" width=32px>101</td><td><a href="#uo_structure">uo_structure</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>102</td><td class="grayrow"><a href="#uo_subclass">uo_subclass</a></td><td></td></tr>
<tr><td align="center" width=32px>103</td><td><a href="#uo_svg">uo_svg</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>104</td><td class="grayrow"><a href="#uo_sysenv">uo_sysenv</a></td><td></td></tr>
<tr><td align="center" width=32px>105</td><td><a href="#uo_tempfile">uo_tempfile</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>106</td><td class="grayrow"><a href="#uo_thread">uo_thread</a></td><td></td></tr>
<tr><td align="center" width=32px>107</td><td><a href="#uo_thread_factory">uo_thread_factory</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>108</td><td class="grayrow"><a href="#uo_timer">uo_timer</a></td><td></td></tr>
<tr><td align="center" width=32px>109</td><td><a href="#uo_tooltip">uo_tooltip</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>110</td><td class="grayrow"><a href="#uo_transaction">uo_transaction</a></td><td></td></tr>
<tr><td align="center" width=32px>111</td><td><a href="#uo_trayicon">uo_trayicon</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>112</td><td class="grayrow"><a href="#uo_uhfreader18">uo_uhfreader18</a></td><td></td></tr>
<tr><td align="center" width=32px>113</td><td><a href="#uo_utils">uo_utils</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>114</td><td class="grayrow"><a href="#uo_variable">uo_variable</a></td><td></td></tr>
<tr><td align="center" width=32px>115</td><td><a href="#uo_version">uo_version</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>116</td><td class="grayrow"><a href="#uo_wait_box">uo_wait_box</a></td><td></td></tr>
<tr><td align="center" width=32px>117</td><td><a href="#uo_wavfile">uo_wavfile</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>118</td><td class="grayrow"><a href="#uo_websocket_client">uo_websocket_client</a></td><td></td></tr>
<tr><td align="center" width=32px>119</td><td><a href="#uo_websocket_server">uo_websocket_server</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>120</td><td class="grayrow"><a href="#uo_webview2">uo_webview2</a></td><td></td></tr>
<tr><td align="center" width=32px>121</td><td><a href="#uo_widgetstack">uo_widgetstack</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>122</td><td class="grayrow"><a href="#uo_wmf">uo_wmf</a></td><td></td></tr>
<tr><td align="center" width=32px>123</td><td><a href="#uo_wxface">uo_wxface</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>124</td><td class="grayrow"><a href="#uo_xl_base">uo_xl_base</a></td><td></td></tr>
<tr><td align="center" width=32px>125</td><td><a href="#uo_xl_book">uo_xl_book</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>126</td><td class="grayrow"><a href="#uo_xl_cell">uo_xl_cell</a></td><td></td></tr>
<tr><td align="center" width=32px>127</td><td><a href="#uo_xl_font">uo_xl_font</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>128</td><td class="grayrow"><a href="#uo_xl_format">uo_xl_format</a></td><td></td></tr>
<tr><td align="center" width=32px>129</td><td><a href="#uo_xl_sheet">uo_xl_sheet</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>130</td><td class="grayrow"><a href="#uo_xls">uo_xls</a></td><td></td></tr>
<tr><td align="center" width=32px>131</td><td><a href="#uo_xlsx">uo_xlsx</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>132</td><td class="grayrow"><a href="#uo_xml">uo_xml</a></td><td></td></tr>
<tr><td align="center" width=32px>133</td><td><a href="#uo_xml_attribute">uo_xml_attribute</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>134</td><td class="grayrow"><a href="#uo_xml_node">uo_xml_node</a></td><td></td></tr>
<tr><td align="center" width=32px>135</td><td><a href="#uo_yibao">uo_yibao</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>136</td><td class="grayrow"><a href="#uo_zip">uo_zip</a></td><td></td></tr>
<tr><td align="center" width=32px>137</td><td><a href="#uo_zplay">uo_zplay</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>138</td><td class="grayrow"><a href="#vo_button">vo_button</a></td><td></td></tr>
<tr><td align="center" width=32px>139</td><td><a href="#vo_datawindow_tree">vo_datawindow_tree</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>140</td><td class="grayrow"><a href="#vo_identification">vo_identification</a></td><td></td></tr>
<tr><td align="center" width=32px>141</td><td><a href="#vo_json_datawindow">vo_json_datawindow</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>142</td><td class="grayrow"><a href="#vo_lineedit">vo_lineedit</a></td><td></td></tr>
<tr><td align="center" width=32px>143</td><td><a href="#vo_menubar">vo_menubar</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>144</td><td class="grayrow"><a href="#vo_pbidea_toolbar">vo_pbidea_toolbar</a></td><td></td></tr>
<tr><td align="center" width=32px>145</td><td><a href="#vo_splitbar">vo_splitbar</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>146</td><td class="grayrow"><a href="#vo_splitbar_h">vo_splitbar_h</a></td><td></td></tr>
<tr><td align="center" width=32px>147</td><td><a href="#vo_splitbar_v">vo_splitbar_v</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>148</td><td class="grayrow"><a href="#vo_statusbar">vo_statusbar</a></td><td></td></tr>
<tr><td align="center" width=32px>149</td><td><a href="#uo_database">uo_database</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>150</td><td class="grayrow"><a href="#uo_database_pool">uo_database_pool</a></td><td></td></tr>
<tr><td align="center" width=32px>151</td><td><a href="#uo_field">uo_field</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>152</td><td class="grayrow"><a href="#uo_recordset">uo_recordset</a></td><td></td></tr>
<tr><td align="center" width=32px>153</td><td><a href="#uo_chart">uo_chart</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>154</td><td class="grayrow"><a href="#uo_led">uo_led</a></td><td></td></tr>
<tr><td align="center" width=32px>155</td><td><a href="#uo_fingerprint">uo_fingerprint</a></td><td></td></tr>
<tr class="grayrow"><td align="center" width=32px>156</td><td class="grayrow"><a href="#uo_hcusb">uo_hcusb</a></td><td></td></tr>
</table>
</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_7z" id="uo_7z">uo_7z</a></div>
<pre><code>
//cn:7z压缩、解压缩
//en:7z compress decompress

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 17:36:37
>--------------------------------------------------------------------
> uo_7z
>====================================================================*/

private:

/*====================================================================
> 私有函数，内部使用
> Private function, used internally
>====================================================================*/
subroutine SevenZipCreate() system library "PbIdea.dll" alias for "SevenZipCreate"
subroutine SevenZipDestroy() system library "PbIdea.dll" alias for "SevenZipDestroy"

public:

/*====================================================================
> 添加一个目录到压缩文档
> Add a directory to the compressed document
> return: Success or not
> Parameter:
> strDir:        Specify Add Directory
> includeSubDir: Include Subdirectories Add All
> strFilter:     File type filtering, such as *. txt
>====================================================================*/
function boolean AddDir(readonly string strDir) system library "PbIdea.dll" alias for "SevenZipAddDir"
function boolean AddDir(readonly string strDir, boolean includeSubDir) system library "PbIdea.dll" alias for "SevenZipAddDir"
function boolean AddDir(readonly string strDir, readonly string strFilter,boolean includeSubDir) system library "PbIdea.dll" alias for "SevenZipAddDir"

/*====================================================================
> 添加一个文件到压缩文档
> Add a file to the compressed document
> return: Success or not
> Parameter:
> fileName: file name
>====================================================================*/
function boolean AddFile(readonly string fileName) system library "PbIdea.dll" alias for "SevenZipAddFile"

/*====================================================================
> 开始压缩
> Start compression
> return: Success or not
> Parameter:
> str7zFile:    Target File Name
> showProgress: Show progress bar
>====================================================================*/
function boolean Compress(readonly string str7zFile) system library "PbIdea.dll" alias for "SevenZipCompress"
function boolean Compress(readonly string str7zFile,boolean showProgress) system library "PbIdea.dll" alias for "SevenZipCompress"

/*====================================================================
> 解压缩文档
> Extract the document
> return: Success or not
> Parameter:
> str7zFile:   Source file name
> strDir:      Extract to the specified directory
> showProgress: Show progress bar
>====================================================================*/
function boolean Extract(readonly string str7zFile,readonly string strDir) system library "PbIdea.dll" alias for "SevenZipExtract"
function boolean Extract(readonly string str7zFile,readonly string strDir,boolean showProgress) system library "PbIdea.dll" alias for "SevenZipExtract"

/*====================================================================
> 对数据进行 7z压缩、解压缩，使用了自定义格式
> The data is compressed and decompressed in 7z, using a custom format
> return: binary data
> Parameter:
> data: binary data
>====================================================================*/
function blob Compress7Z(readonly blob data) system library "PbIdea.dll" alias for "Compress7Z"
function blob Uncompress7Z(readonly blob data) system library "PbIdea.dll" alias for "Uncompress7Z"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_asn1" id="uo_asn1">uo_asn1</a></div>
<pre><code>
//cn:asn1编码、解码
//en:asn1 encode/decode

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 17:36:58
>--------------------------------------------------------------------
> uo_asn1
>====================================================================*/

private:
/*====================================================================
> Internal use
>====================================================================*/
function ulong asn1Create() system library "PbIdea.dll" alias for "asn1Create"
function ulong asn1Destroy() system library "PbIdea.dll" alias for "asn1Destroy"

public:

/*====================================================================
> 添加blob数据。其他数据类型，需要转成blob添加.添加字符串时，内部会自动转成utf8编码
> Add blob data. Other data types need to be converted to blob for addition. Add a string and it will be automatically converted to utf8 code internally
> return: success or not
> parameter: 
> data: source data
>====================================================================*/
function boolean AddBlob    (readonly blob data)     system library "PbIdea.dll" alias for "asn1AddData"
function boolean AddString  (readonly string data)   system library "PbIdea.dll" alias for "asn1AddData"
function boolean AddLong    (readonly long data)     system library "PbIdea.dll" alias for "asn1AddData"
function boolean AddDouble  (readonly double data)   system library "PbIdea.dll" alias for "asn1AddData"
function boolean AddBoolean (readonly boolean data)  system library "PbIdea.dll" alias for "asn1AddData"
function boolean AddLongLong(readonly LongLong data) system library "PbIdea.dll" alias for "asn1AddData"

/*====================================================================
> 添加一个文件
> Add a file
> return: success or not
> parameter:
> fileName: source file
>====================================================================*/
function ulong AddFile(readonly string fileName) system library "PbIdea.dll" alias for "asn1AddFile"

//对添加的数据进行编码打包，返回blob,可选择是否存入指定文件
function blob Encode(boolean crypto) system library "PbIdea.dll" alias for "asn1Encode"
function blob Encode(boolean crypto,readonly string saveToFilenNme) system library "PbIdea.dll" alias for "asn1Encode"
//对已经打包过的blob进行解码，返回blob组,也可以从指定文件直接解码
function int Decode(boolean cryptoed,readonly blob asn1Data,ref any datas[]) system library "PbIdea.dll" alias for "asn1Decode"
function int Decode(boolean cryptoed,readonly blob asn1Data,ref any datas[] , ref string typeName[]) system library "PbIdea.dll" alias for "asn1Decode"
function int Decode(boolean cryptoed,readonly blob asn1Data,ref any datas[] , ref string typeName[],ref string asn1type[]) system library "PbIdea.dll" alias for "asn1Decode"
function int Decode(boolean cryptoed,readonly string fileName,ref any datas[]) system library "PbIdea.dll" alias for "asn1Decode"
function int Decode(boolean cryptoed,readonly string fileName,ref any datas[] , ref string typeName[]) system library "PbIdea.dll" alias for "asn1Decode"
function int Decode(boolean cryptoed,readonly string fileName,ref any datas[] , ref string typeName[],ref string asn1type[]) system library "PbIdea.dll" alias for "asn1Decode"

/*====================================================================
> 清除, 删除对象内容
> clear, Delete Object Content
> return:
> parameter:
>====================================================================*/
subroutine Clear() system library "PbIdea.dll" alias for "asn1Clear"

/*====================================================================
> 需要加密时，设置密钥
> Set the key when encryption is required
> return:
> parameter:
> pri: SM2 private key, base64 format, 32-bit
> pub: SM2 public key, base64 format, 64-bit
>====================================================================*/
subroutine SetKey(readonly string pri,readonly string pub) system library "PbIdea.dll" alias for "asn1SetKey"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_autoresize" id="uo_autoresize">uo_autoresize</a></div>
<pre><code>
//cn:窗口及控件自动绽放
//en:window and control auto zoom

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 18:08:59
>--------------------------------------------------------------------
> uo_autoresize
>====================================================================*/

public:
/*====================================================================
> 向一个窗口注册缩放对象，参数dragobject obj可以是窗口,autoResize 指定是否不需要响应 resize 事件，直接生效
> Register a scaling object to a window. The dragobject obj parameter can be a window. AutoResize specifies whether to respond to the resize event without directly taking effect
> return: success or not
> parameter:
> obj:        window or userobject
> autoResize: Auto Zoom
>====================================================================*/
FUNCTION boolean Init(powerobject obj,boolean autoResize) system library  "PbIdea.dll" alias for "AutoResize_Init"

/*====================================================================
> 在 window resize 事件中调用此函数，让控件随窗口大小自动缩放
> Call this function in the window resize event to make the control automatically scale with the window size
> return:
> parameter:
> nNewWidth,nNewHeight: the new size of the window
>====================================================================*/
subroutine Resize(int nNewWidth,int nNewHeight) system library  "PbIdea.dll" alias for "AutoResize_Resize"

/*====================================================================
> 注册子控件缩放模式
> Register child control zoom mode
> return: 
> parameter:
> control:  window or userobject
> xMove: Whether the x coordinate value is scaled
> yMove: Whether the y coordinate value is scaled
> widthZoom:  Whether the width value is scaled
> HeightZoom: Whether the height value is scaled
>====================================================================*/
subroutine Register(powerobject control,boolean xMove,boolean yMove,boolean widthZoom,boolean heightZoom) system library  "PbIdea.dll" alias for "AutoResize_Register"

/*====================================================================
> 设置某子控件不加入窗口缩放队列
> Set a sub control not to join the window zoom queue
> return:
> parameter:
> control: window or userobject
>====================================================================*/
subroutine UnRegister(powerobject control) system library  "PbIdea.dll" alias for "AutoResize_UnRegister"

/*====================================================================
> 关闭窗口中缩放对象功能
> Turn off the function of scaling objects in the window
>====================================================================*/
subroutine Close() system library  "PbIdea.dll" alias for "AutoResize_Close"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_bcrypto" id="uo_bcrypto">uo_bcrypto</a></div>
<pre><code>
// bcrypto 算法, 用于对密码hash

//取盐
function string getSalt() system library "pbidea.dll" alias for "bcryptoSalt"
//ver: $2a$, $2b$, $2y$
function string getSalt(readonly string ver) system library "pbidea.dll" alias for "bcryptoSalt"
//factor默认为12
function string getSalt(readonly string ver, int factor) system library "pbidea.dll" alias for "bcryptoSalt"
//对密码取hash
function string HashPW(readonly string password) system library "pbidea.dll" alias for "bcryptoHashPW"
function string HashPW(readonly string password, readonly string salt) system library "pbidea.dll" alias for "bcryptoHashPW"
//检查密码有效性
function boolean CheckPW(readonly string password, readonly string hash) system library "pbidea.dll" alias for "bcryptoCheckPW"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_biginteger" id="uo_biginteger">uo_biginteger</a></div>
<pre><code>
//cn:BigInteger ,大整数，兼容JAVA里的 BigInteger
//en:BigInteger ,Compatible with BigInteger in JAVA

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 18:18:08
>--------------------------------------------------------------------
> uo_BigInteger
>====================================================================*/

private:
/*====================================================================
> Internal use
>====================================================================*/
subroutine bnCreate() system library "pbidea.dll" alias for "bnCreate"
subroutine bnDestroy() system library "pbidea.dll" alias for "bnDestroy"

public:
/*====================================================================
> 从十六进制字符串生成一个 biginteger
> Generate a biginteger from a hexadecimal string
> return: success or not
> parameter:
> hex: a hexadecimal string
>====================================================================*/
function boolean FromHex(readonly string hex) system library "pbidea.dll" alias for "bnFromHex"

/*====================================================================
> 从10进制字符串生成一个 biginteger
> Generate a biginteger from a decimal string
> return: success or not
> parameter:
> hex: a decimal string
>====================================================================*/
function boolean FromStr(readonly string dec) system library "pbidea.dll" alias for "bnFromDec"

/*====================================================================
> 转换成二进制数据
> Convert to binary data
> return: blob data
> parameter:
>====================================================================*/
function blob toBlob() system library "pbidea.dll" alias for "bnToBlob"

/*====================================================================
> 转换成指定进制的字符串，如果不指定参数，则默认为10进制
> Convert to the specified decimal string. If no parameter is specified, the default value is decimal
> return: string
> parameter:
>====================================================================*/
function string toString()          system library "pbidea.dll" alias for "bnToString"
function string toString(int radix) system library "pbidea.dll" alias for "bnToString"

/*====================================================================
> 生成一个指定长度的随机字符串
> Generate a random string of specified length
> return: string
>====================================================================*/
function string Rand(int size) system library "pbidea.dll" alias for "bnRand"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_bits" id="uo_bits">uo_bits</a></div>
<pre><code>
//cn:位操作
//en:Bit operation

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 18:24:32
>--------------------------------------------------------------------
> uo_bits
>====================================================================*/
public:
/*====================================================================
> 等同于 C 里的 & 操作
> Equivalent to the & operation in C
>====================================================================*/
function long Bit_And(long n1,long n2) system library "PbIdea.dll" alias for "Bit_And"

/*====================================================================
> 等同于 C 里的 | 操作
> Equivalent to the | operation in C
>====================================================================*/
function long Bit_Or(long n1,long n2) system library "PbIdea.dll" alias for "Bit_Or"

/*====================================================================
> 等同于 C 里的 ^ 操作
> Equivalent to the & operation in C
>====================================================================*/
function long Bit_Xor(long n1,long n2) system library "PbIdea.dll" alias for "Bit_Xor"

/*====================================================================
> 等同于 C 里的 ~ 操作
> Equivalent to the ~& operation in C
>====================================================================*/
function long Bit_Not(long n1) system library "PbIdea.dll" alias for "Bit_Not"

/*====================================================================
> 等同于 C 里的 >> 操作
> Equivalent to the >> operation in C
>====================================================================*/
function long Bit_MoveRight(long n1,long n2) system library "PbIdea.dll" alias for "Bit_MoveRight"

/*====================================================================
> 等同于 C 里的 << 操作
> Equivalent to the << operation in C
>====================================================================*/
function long Bit_MoveLeft(long n1,long n2) system library "PbIdea.dll" alias for "Bit_MoveLeft"

/*====================================================================
> 设置指定位的值
> Set the value of the pointing position
> return: the result
> parameter:
> n:    Operand
> nPos: positioning
> bSet: Set to 1 if it is true, otherwise set to 0
>====================================================================*/
function long Bit_Set(long n,long nPos,boolean bSet) system library "PbIdea.dll" alias for "Bit_Set"

/*====================================================================
> 把一个十六进制数值的字符串转成十进制数,例如 "4A"-> 74
> Convert a string of hexadecimal values to decimal numbers, such as "4A" ->74
>====================================================================*/
function ulong H(readonly string strHex) SYSTEM library "PbIdea.dll" alias for "FromHex"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_blob" id="uo_blob">uo_blob</a></div>
<pre><code>
//cn:blob二进制数据操作
//en:blob, Binary data operation

//CRC16  标准
constant int CRC16_NONE        = 0
constant int CRC16_CCITT       = 1
constant int CRC16_CCITT_FALSE = 2
constant int CRC16_XMODEM      = 3
constant int CRC16_X25         = 4
constant int CRC16_MODBUS      = 5
constant int CRC16_IBM         = 6
constant int CRC16_MAXIM       = 7
constant int CRC16_USB         = 8

/*====================================================================
> Modify: 
>--------------------------------------------------------------------
> 作者:	大自在(QQ781770213)		日期: 2022-11-16 18:30:13
>--------------------------------------------------------------------
> uo_blob
>====================================================================*/

private:
/*====================================================================
> 内部使用,Internal use
>====================================================================*/
subroutine blobCreate() system library "PbIdea.dll" alias for "blobCreate"
subroutine blobDestroy() system library "PbIdea.dll" alias for "blobDestroy"

public:
/*====================================================================
> 分配内存大小，Allocated memory size
> parameter:
> size: memory size
>====================================================================*/
subroutine resize(long size) system library "PbIdea.dll" alias for "blobResize"

/*====================================================================
> 清空内存, Clear Memory
>====================================================================*/
subroutine reset() system library "PbIdea.dll" alias for "blobReset"

/*====================================================================
> 引用一个blob的数据, Data referencing a blob
> return: blob data's address in memory
> parameter:
> data: Source Data Source Data Object
> pos,len: From which position and how long to quote. If not specified, all are referenced.
>====================================================================*/
function ulong RefOf(ref blob data) system library "PbIdea.dll" alias for "blobRefOf"
function ulong RefOf(ref uo_blob data)                          system library "PbIdea.dll" alias for "blobRefOf"
function ulong RefOf(ref uo_blob data,long pos)                 system library "PbIdea.dll" alias for "blobRefOf"
function ulong RefOf(ref uo_blob data,long pos,long len) system library "PbIdea.dll" alias for "blobRefOf"

/*====================================================================
> 设置int,long对齐，0小端，1大端，默认小端
> Set int,long alignment, 0 small end, 1 large end, default small end
>====================================================================*/
subroutine SetAlign(int align) system library "PbIdea.dll" alias for "blobSetAlign"

/*====================================================================
> 返回内存大小, Return memory size
>====================================================================*/
function ulong size() system library "PbIdea.dll" alias for "blobSize"

/*====================================================================
> 返回指定blob的内存地址,如果指定 pos，则返回从 pos 位置开始的内存地址
> Returns the memory address of the specified blob. If pos is specified, the memory address starting from the pos location is returned
>====================================================================*/
function ulong ptr() system library "PbIdea.dll" alias for "blobPtr"
function ulong ptr(long pos) system library "PbIdea.dll" alias for "blobPtr"

/*====================================================================
> 以指定值初始化对象, Initializes the object with the specified value
> return: success or not
> parameter:
> data:     source data
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function boolean set(readonly blob data)                                system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly string data)                              system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly string data,boolean utf8)                 system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly int data)                                 system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly uint data)                                system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly int data,boolean asByte)                  system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly uint data,boolean asByte)                 system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly long data)                                system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly ulong data)                               system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly real data)                                system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly double data)                              system library "PbIdea.dll" alias for "blobSet"
function boolean set(readonly decimal data)                             system library "PbIdea.dll" alias for "blobSet"

/*====================================================================
> 从指定位置获取指定类型的数据
> Get data of the specified type from the specified location
> return: success or not
> parameter:
> pos:    Specify start position
> data:   Reference type data returned
> len:    Specify length
> onByte: Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function boolean get(long pos,ref blob data)               system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref blob data,long len)      system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref string data)             system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref int data)                system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref int data,boolean onByte) system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref uint data)               system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref long data)               system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref ulong data)              system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref real data)               system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref double data)             system library "PbIdea.dll" alias for "blobGet"
function boolean get(long pos,ref decimal data)            system library "PbIdea.dll" alias for "blobGet"

/*====================================================================
> 将指定类型数据追加到对象尾部,返回最后添加元素的起始位置
> Append the specified type data to the end of the object, and return the starting position of the last added element
> return: The starting position of the last added element
> parameter:
> data: Appended data
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function long append(readonly blob data) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly string data) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly string data,boolean utf8) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly int data) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly uint data) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly int data,boolean asByte) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly uint data,boolean asByte) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly long data) system library "PbIdea.dll" alias for "blobAppend"
function long append(readonly ulong data) system library "PbIdea.dll" alias for "blobAppend"

/*====================================================================
> 从指定位置删除指定长度数据
> Delete the specified length data from the specified location
> return: The object itself
>====================================================================*/
function uo_blob remove(int pos,int len) system library "PbIdea.dll" alias for "blobRemove"

/*====================================================================
> 从指定位置替换指定长度数据
> Replaces specified length data from specified location
> data: Replaced data
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
subroutine replace(long pos,long len,readonly blob data) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly string data) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly string data,boolean utf8) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly int data) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly uint data) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly int data,boolean asByte) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly uint data,boolean asByte) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly long data) system library "PbIdea.dll" alias for "blobReplace"
subroutine replace(long pos,long len,readonly ulong data) system library "PbIdea.dll" alias for "blobReplace"

/*====================================================================
> 比较指定类型的数据与当前类型的差异性
> Compare the difference between the specified type of data and the current type
> return: If the return value is<0, it means that buf1 is less than buf2. If the return value is>0, it means that buf2 is less than buf1. If the return value=0, it means that buf1 is equal to buf2.
> data: Data waiting to be compared with the current object
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function int compare(long pos,readonly blob data) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly string data) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly string data,boolean utf8) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly int data) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly uint data) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly int data,boolean asByte) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly uint data,boolean asByte) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly long data) system library "PbIdea.dll" alias for "blobCompare"
function int compare(long pos,readonly ulong data) system library "PbIdea.dll" alias for "blobCompare"

/*====================================================================
> 编辑指定位置的字节
> Edit bytes at the specified location
> parameter:
> pos: Specify location
> value: a byte,>=0 and <= 255
> hexChar: a hex byte,for example: "3F"
>====================================================================*/
subroutine edit(long pos,int value) system library "PbIdea.dll" alias for "blobEdit"
subroutine edit(long pos,string hexChar) system library "PbIdea.dll" alias for "blobEdit"

/*====================================================================
> 从指定位置读或写一个字节
> Read or write a byte from the specified location
> parameter:
> pos: Specify location
> hexChar: a hex byte,for example: "3F"
>====================================================================*/
function int ReadByte(long pos) system library "PbIdea.dll" alias for "blobReadByte"
subroutine   WriteByte(long pos,string hexChar) system library "PbIdea.dll" alias for "blobEdit"

/*====================================================================
> 写入数据块到指定位置
> Write the data block to the specified location
> return: success or not
> pos: Specify location
> data: the data
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function boolean Write(long pos,readonly blob data) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly string data) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly string data,boolean utf8) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly int data) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly uint data) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly int data,boolean asByte) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly uint data,boolean asByte) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly long data) system library "PbIdea.dll" alias for "blobWrite"
function boolean Write(long pos,readonly ulong data) system library "PbIdea.dll" alias for "blobWrite"

/*====================================================================
> 从指定位置读取数据
> Read data from the specified location
> return: success or not
> pos: Specify location
> data: Return value of reference type
> utf8:     Whether to automatically convert the string from the current character set to the utf8 character set
> endflag:  alignment, 0 small end, 1 large end, default small end
> asByte:   Whether to treat the current number as a byte type when the data is of type int or uint
>====================================================================*/
function boolean read(long pos,ref blob data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref blob data,long len) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref string data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref int data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref int data,boolean onByte) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref uint data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref long data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref ulong data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref real data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref double data) system library "PbIdea.dll" alias for "blobGet"
function boolean read(long pos,ref decimal data) system library "PbIdea.dll" alias for "blobGet"

/*====================================================================
> 填充字节
> Fill Bytes
> parameter:
> ch: a byte,>=0 and <= 255
> hexChar: a hex byte,for example: "3F"
> pos: Specify location
> len: Specify length
>====================================================================*/
subroutine fill(int ch) system library "PbIdea.dll" alias for "blobFill"
subroutine fill(string hexChar) system library "PbIdea.dll" alias for "blobFill"
subroutine fill(long pos,int ch) system library "PbIdea.dll" alias for "blobFill"
subroutine fill(long pos,string hexChar) system library "PbIdea.dll" alias for "blobFill"
subroutine fill(long pos,long len,int ch) system library "PbIdea.dll" alias for "blobFill"
subroutine fill(long pos,long len,string hexChar) system library "PbIdea.dll" alias for "blobFill"

/*====================================================================
> 从指定位置开始查找数据
> 
>====================================================================*/
function long find(readonly blob data) system library "PbIdea.dll" alias for "blobFind"
function long find(readonly blob data, long startPos) system library "PbIdea.dll" alias for "blobFind"
function long find(readonly uo_blob data) system library "PbIdea.dll" alias for "blobFind"
function long find(readonly uo_blob data, long startPos) system library "PbIdea.dll" alias for "blobFind"
function long find(readonly string hex) system library "PbIdea.dll" alias for "blobFind"
function long find(readonly string hex, long startPos) system library "PbIdea.dll" alias for "blobFind"
/*====================================================================
> 从指定位置复制指定长度数据，此内部会新建一个 uo_blob对象，返回对象需要你 destroy
> Copy the specified length data from the specified location, and a new uo will be created inside_ Blob object, the returned object needs you to destroy
>====================================================================*/
function uo_blob CopyObject(long pos,long len) system library "PbIdea.dll" alias for "blobCopyObject"

/*====================================================================
> 从指定位置复制指定长度数据
> Copy the specified length data from the specified location
>====================================================================*/
function blob    CopyBlob(long pos,long len) system library "PbIdea.dll" alias for "blobCopyBlob"

/*====================================================================
> 转换为指定类型的结果
> Convert to the result of the specified type
> ToBytes return as: [32,-45,22,....]
>====================================================================*/
function blob    ToBlob() system library "PbIdea.dll" alias for "blobToBlob"

/*====================================================================
> 转换为指定类型的结果
> Convert to the result of the specified type
> return as: [32,-45,22,....]
>====================================================================*/
function string  ToBytes() system library "PbIdea.dll" alias for "blobToBytes"

/*====================================================================
> 转换为指定类型的结果
> Convert to the result of the specified type
> return as: "3F553B..."
>====================================================================*/
function string  hex() system library "PbIdea.dll" alias for "blobHex"

/*====================================================================
> 将blob编码为 base64, Encode blob as base64
>====================================================================*/
function string  base64() system library "PbIdea.dll" alias for "blobBase64"

/*====================================================================
> 从 hex 字符串生成blob，即 hex 解码
> Generate blob from hex string, i.e. hex decoding
> return: the object self
>====================================================================*/
function uo_blob FromHex(string hex) system library "PbIdea.dll" alias for "blobFromHex"

/*====================================================================
> 从 base64 字符串生成blob，即 base64 解码
> Generate blob from base64 string, i.e. base64 decoding
> return: the object self
>====================================================================*/
function uo_blob FromBase64(string base64) system library "PbIdea.dll" alias for "blobFromBase64"

/*====================================================================
> 在控制台以十六进制试试显示数据,或者返回格式化十六进制数据，方便调试
> Try to display data in hexadecimal on the console, or return formatted hexadecimal data for debugging
>====================================================================*/
function string dump() system library "PbIdea.dll" alias for "blobDump"
subroutine dump(string title) system library "PbIdea.dll" alias for "blobDump"
subroutine dump(string title,long pos) system library "PbIdea.dll" alias for "blobDump"
subroutine dump(string title,long pos,long len) system library "PbIdea.dll" alias for "blobDump"

/*====================================================================
> 浮点数 ieee754编码, Floating point ieee 754 encoding
> return: the pos in blob buffer
>====================================================================*/
function long    SetIEEE754(decimal num) system library "PbIdea.dll" alias for "blobSetIEEE754"
function long    SetIEEE754(double  num) system library "PbIdea.dll" alias for "blobSetIEEE754"
function long    SetIEEE754(real    num) system library "PbIdea.dll" alias for "blobSetIEEE754"
function long    SetIEEE754(int     num) system library "PbIdea.dll" alias for "blobSetIEEE754"
function long    SetIEEE754(long    num) system library "PbIdea.dll" alias for "blobSetIEEE754"

/*====================================================================
> 浮点数 ieee754编码, Floating point ieee 754 encoding
> return: the float number
> parameter:
> pos: the start positon in the blob buffer
>====================================================================*/
function decimal GetIEEE754()            system library "PbIdea.dll" alias for "blobGetIEEE754"
function decimal GetIEEE754(long pos)    system library "PbIdea.dll" alias for "blobGetIEEE754"

/*====================================================================
> 对指定位置的int和long类型数据进行大小端对换
> Exchange the big end and small end of int and long data at the specified location
>====================================================================*/
subroutine SwapInt(long pos)  system library "PbIdea.dll" alias for "blobSwapInt"
subroutine SwapLong(long pos) system library "PbIdea.dll" alias for "blobSwapLong"

/*====================================================================
> 打开文件,可以直接存取文件内容,默认只读打开。注意：这里是以文件映射的方式打开，对它的读写直接影响到磁盘上的文件内容
> To open a file, you can directly access its contents. By default, it is read-only. Note: This is opened by file mapping, and its reading and writing directly affect the file content on the disk
> return: succcess ot not
> paramter:
> fileName:
> readOnlyOpen : open file by read only
>====================================================================*/
function boolean OpenFile(string fileName)  system library "PbIdea.dll" alias for "blobOpenFile"
function boolean OpenFile(string fileName,boolean ReadOnlyOpen)  system library "PbIdea.dll" alias for "blobOpenFile"

/*====================================================================
> 关闭已打开文件, close the file
>====================================================================*/
subroutine CloseFile()  system library "PbIdea.dll" alias for "blobCloseFile"

/*====================================================================
> 把blob内容另存到文件, Save blob content to a file
> return: success or not
> paramter:
> fileName:
> hex: hex format text, for example "3E1D34"
> addSpace: hex format text, for example "3E 1D 34 "
>====================================================================*/
function boolean SaveFile(string fileName)  system library "PbIdea.dll" alias for "blobWriteFile"
function boolean SaveFile(string fileName,boolean hex)  system library "PbIdea.dll" alias for "blobWriteFile"
function boolean SaveFile(string fileName,boolean hex,boolean addSpace)  system library "PbIdea.dll" alias for "blobWriteFile"
//crc16
function uint crc(int crcType) system library "PbIdea.dll" alias for "blobCrc16"
function uint crc(int crcType, long start, long size) system library "PbIdea.dll" alias for "blobCrc16"
//crc32
function ulong crc32() system library "PbIdea.dll" alias for "blobCrc32"
function ulong crc32(long start, long size) system library "PbIdea.dll" alias for "blobCrc32"
//md5
function string md5() system library "PbIdea.dll" alias for "blobMd5"
function string md5(long start, long size) system library "PbIdea.dll" alias for "blobMd5"

/*====================================================================
> 打印字节数组
>====================================================================*/
subroutine PrintBytes() system library "PbIdea.dll" alias for "blobPrintBytes"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_bson" id="uo_bson">uo_bson</a></div>
<pre><code>
//cn:bson,可以保存二进制数据的json，数据类型更丰富
//en:bson,The json that can store binary data has more data types

private:
subroutine bsonCreate() system library "PbIdea.dll" alias for "bsonCreate"
subroutine bsonDestroy() system library "PbIdea.dll" alias for "bsonDestroy"

public:
//设置一些bson操作的全局选项
//1. SetOption("update","yes") 先检查存在性，存在则更新，否则添加，性能会有所损失。为no时只添加不检查。默认是yes
subroutine SetOption(readonly string name,readonly string value) system library "PbIdea.dll" alias for "bsonSetOption"
//另存为二进制文件
function boolean Save(readonly string fileName) system library "PbIdea.dll" alias for "bsonSave"
//从二进制文件中加载
function boolean Load(readonly string fileName) system library "PbIdea.dll" alias for "bsonLoad"
//从二进制数据中加载
function boolean Load(readonly blob data) system library "PbIdea.dll" alias for "bsonLoad"
//转为二进制文件内容
function blob    ToBlob() system library "PbIdea.dll" alias for "bsonToBlob"
function string  ToBase64() system library "PbIdea.dll" alias for "bsonToBase64"
//转为json内容
function boolean ToJson(uo_json json) system library "PbIdea.dll" alias for "bsonToJson"
//从json读取内容
function boolean FromJson(uo_json json) system library "PbIdea.dll" alias for "bsonFromJson"
//clear
subroutine Clear() system library "PbIdea.dll" alias for "bsonClear"
//设置值
function boolean Set(readonly string key,readonly any value) system library "PbIdea.dll" alias for "bsonSet"
//option参数
/*
1.当value为blob类型时,option指定子类型
   BSON_SUBTYPE_BINARY = 0x00,
   BSON_SUBTYPE_FUNCTION = 0x01,
   BSON_SUBTYPE_BINARY_DEPRECATED = 0x02,
   BSON_SUBTYPE_UUID_DEPRECATED = 0x03,
   BSON_SUBTYPE_UUID = 0x04,
   BSON_SUBTYPE_MD5 = 0x05,
   BSON_SUBTYPE_USER = 0x80,
*/
function boolean Set(readonly string key,readonly any value,int option) system library "PbIdea.dll" alias for "bsonSet"

//取得一个节点值 ，值类型是 any ，根据具体情况赋予特定类型，key 节点关键字， bSuccess 输出参数，表示本次Get行为是否成功
function boolean Get(readonly string key,ref uo_bson  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref uo_json  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref string   val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref int      val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref uint     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref long     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref ulong    val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref longlong val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref double   val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref decimal  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref real     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref boolean  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref blob     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref date     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref datetime val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(readonly string key,ref any val) system library "PbIdea.dll" alias for "bsonGet"//如果你不知道具体类型，可以使用ANY型，然后用classname(value) 判断取得的是什么类型

//设置或获取objectID
function boolean SetObjectID(readonly string key) system library "PbIdea.dll" alias for "bsonSetObjectID"
function boolean GetObjectID(readonly string key,ref string val) system library "PbIdea.dll" alias for "bsonGetObjectID"

//第一种遍历与枚举方法
//开始一个枚举
function boolean BeginIter(uo_bson_iter iter) system library "PbIdea.dll" alias for "bsonBeginIter"
//逐个枚举
function boolean NextIter(uo_bson_iter iter)  system library "PbIdea.dll" alias for "bsonNextIter"
//结束一个枚举
function boolean EndIter(uo_bson_iter iter)   system library "PbIdea.dll" alias for "bsonEndIter"
//取得一个节点值 ，值类型是 any ，根据具体情况赋予特定类型，key 节点关键字， bSuccess 输出参数，表示本次Get行为是否成功
function boolean Get(uo_bson_iter iter,ref uo_bson  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref uo_json  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref string   val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref int      val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref uint     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref long     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref ulong    val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref longlong val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref double   val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref decimal  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref real     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref boolean  val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref blob     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref date     val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref datetime val) system library "PbIdea.dll" alias for "bsonGet"
function boolean Get(uo_bson_iter iter,ref any val) system library "PbIdea.dll" alias for "bsonGet"//如果你不知道具体类型，可以使用ANY型，然后用classname(value) 判断取得的是什么类型

//第二种遍历与枚举方法
function boolean VisitAll(uo_bson_iter iter) system library "PbIdea.dll" alias for "bsonVisitAll"
//flags : 1 只枚举 bson 对象 , 0 枚举所有节点
function boolean VisitAll(uo_bson_iter iter,long flags) system library "PbIdea.dll" alias for "bsonVisitAll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_bson_iter" id="uo_bson_iter">uo_bson_iter</a></div>
<pre><code>
//cn:uo_bson 叠代对象.这是内部使用对象，请不要做任何修改
//en:uo_bson Iterated object. This is an internal object, please do not make any changes
ulong  ptr            //内部使用指针值，PB程序中不可访问
ulong  iter           //当前指针
//以下值可以PB中访问
string key            //键值
int    bson_type      //bson 类型，见以下定义
int    pb_type        //PB对应数据类型
string type_name      //PB对应的类型名称

//visit 填充值
string parentkey      //键值
int    depth          //深度

//结果，根据不同类型而决定
int    datacount //指出几个数据有效
any    data1
any    data2
any    data3


/*
   BSON数据类型，与PB数据类型有对应关系，但有些无法对应.
   BSON_TYPE_EOD        = 0x00,
   BSON_TYPE_DOUBLE     = 0x01,
   BSON_TYPE_UTF8       = 0x02,
   BSON_TYPE_DOCUMENT   = 0x03,
   BSON_TYPE_ARRAY      = 0x04,
   BSON_TYPE_BINARY     = 0x05,
   BSON_TYPE_UNDEFINED  = 0x06,
   BSON_TYPE_OID        = 0x07,
   BSON_TYPE_BOOL       = 0x08,
   BSON_TYPE_DATE_TIME  = 0x09,
   BSON_TYPE_NULL       = 0x0A,
   BSON_TYPE_REGEX      = 0x0B,
   BSON_TYPE_DBPOINTER  = 0x0C,
   BSON_TYPE_CODE       = 0x0D,
   BSON_TYPE_SYMBOL     = 0x0E,
   BSON_TYPE_CODEWSCOPE = 0x0F,
   BSON_TYPE_INT32      = 0x10,
   BSON_TYPE_TIMESTAMP  = 0x11,
   BSON_TYPE_INT64      = 0x12,
   BSON_TYPE_DECIMAL128 = 0x13,
   BSON_TYPE_MAXKEY     = 0x7F,
   BSON_TYPE_MINKEY     = 0xFF,
*/

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_buffer" id="uo_buffer">uo_buffer</a></div>
<pre><code>
//一个缓存区，初始大小为 1024 字符长度

private:
ulong _ptr = 0       //指向实际内存地址
int _char_wide = 0   //每字符宽度，9及以下为1,10及以上为2
long _size  = 0   //默认缓存大小,9及以下长度等于字符串长度,10及以上大小为字符串长度的双倍
long _length = 0  //默认字符串长度

constant int LPTR = 64
constant int DEFAULT_LEN = 1024
constant ulong CP_UTF8 = 65001

FUNCTION ulong LocalAlloc(ulong wFlags,ulong wBytes) LIBRARY "kernel32.dll"
FUNCTION ulong LocalFree(ulong hMem) LIBRARY "kernel32.dll"
FUNCTION ulong LocalReAlloc(ulong hMem,ulong wBytes,ulong wFlags) LIBRARY "kernel32.dll"

Function ulong MemoryCopy(ulong destination,ulong source, ulong srclen) system library "PbIdea.dll" alias for "urilRtlMoveMemory"
Function ulong MemoryCopyBlob(ref blob destination,ulong source, ulong srclen) system library "PbIdea.dll" alias for "urilRtlMoveMemory"
Function ulong MemoryCopyString(ulong destination,ref string source, ulong srclen) system library "PbIdea.dll" alias for "urilRtlMoveMemory"

function blob AllocBlob(long size) system library "pbidea.dll" alias for "sysAllocBlob"
FUNCTION ulong MultiByteToWideChar(ulong CodePage,ulong dwFlags,ulong lpMultiByteStr,ulong cchMultiByte,ulong lpWideCharStr,ulong cchWideChar) LIBRARY "kernel32.dll"
FUNCTION ulong WideCharToMultiByte(ulong CodePage,ulong dwFlags,ulong lpWideCharStr,ulong cchWideChar,ulong lpMultiByteStr,ulong cchMultiByte, ulong lpDefaultChar,ulong lpUsedDefaultChar) LIBRARY "kernel32.dll"

FUNCTION ulong MultiByteToWideCharFromBlob(ulong CodePage,ulong dwFlags,ref blob lpMultiByteStr,ulong cchMultiByte,ulong lpWideCharStr,ulong cchWideChar) LIBRARY "kernel32.dll" alias for "MultiByteToWideChar"
FUNCTION ulong WideCharToMultiByteFromBlob(ulong CodePage,ulong dwFlags,ref blob lpWideCharStr,ulong cchWideChar,ulong lpMultiByteStr,ulong cchMultiByte, ulong lpDefaultChar,ulong lpUsedDefaultChar) LIBRARY "kernel32.dll" alias for "WideCharToMultiByte"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_calculator" id="uo_calculator">uo_calculator</a></div>
<pre><code>
//cn:计算器控件
//en:Calculator Control

private:
subroutine CalcCreate() SYSTEM library "PbIdea.dll" alias for "CalcCreate"
subroutine CalcDestroy() SYSTEM library "PbIdea.dll" alias for "CalcDestroy"
public:
//计算表达式
//直接计算表达式
function double CalcExpression(readonly string expr)  SYSTEM library "PbIdea.dll" alias for "CalcExpression"
function double CalcExpression(readonly string expr,ref boolean success) SYSTEM library "PbIdea.dll" alias for "CalcExpression"
//清除
subroutine CalcClear() SYSTEM library "PbIdea.dll" alias for "CalcClear"
//获取结果
function string CalcGetValue() SYSTEM library "PbIdea.dll" alias for "CalcGetValue"
//获取表达式
function string CalcGetExpr() SYSTEM library "PbIdea.dll" alias for "CalcGetExpr"
//设置表达式，并且计算，返回计算结果
function string CalcSetExpr(string expr) SYSTEM library "PbIdea.dll" alias for "CalcSetExpr"
//设置颜色
subroutine CalcSetSkin(uo_json skin) SYSTEM library "PbIdea.dll" alias for "CalcSetSkin"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_calendar" id="uo_calendar">uo_calendar</a></div>
<pre><code>
//cn:日历控件
//en:Calendar control, suitable for use in China

private:
subroutine Init() system library "PbIdea.dll" alias for "caleInit"

public:
//设置值
subroutine SetValue(datetime value) system library "PbIdea.dll" alias for "caleSetValue"
subroutine SetValue(date value) system library "PbIdea.dll" alias for "caleSetValue"
subroutine SetValue(time value) system library "PbIdea.dll" alias for "caleSetValue"

//获取返回值，类型是 datetime,date,time之一
function any GetValue() system library "PbIdea.dll" alias for "caleGetValue"

//设置 皮肤 
subroutine SetSkin(string json) system library "PbIdea.dll" alias for "caleSetSkin"

//设置内容
subroutine SetContent(date key,string content) system library "PbIdea.dll" alias for "caleSetContent"
subroutine SetContent(datetime key,string content) system library "PbIdea.dll" alias for "caleSetContent"
//获取内容
subroutine GetContent(uo_json content) system library "PbIdea.dll" alias for "caleGetContent"
//设置假日,flag 0或1
subroutine SetHoliday(date key, string showText,int flag) system library "PbIdea.dll" alias for "caleSetHoliday"
subroutine SetHoliday(datetime key, string showText,int flag) system library "PbIdea.dll" alias for "caleSetHoliday"

//设置选项
subroutine SetOption(string key,string value) system library "PbIdea.dll" alias for "caleSetOption"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_camera" id="uo_camera">uo_camera</a></div>
<pre><code>
private:
uo_painter p
string is_icon = '<svg t="1697908660195" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3995" width="200" height="200"><path d="M871 47 183 47c-57 0-104 46-104 104l0 687c0 57 46 104 104 104l687 0c57 0 104-46 104-104L975 151C975 93 928 47 871 47zM527 783c-159 0-288-129-288-288 0-159 129-288 288-288s288 129 288 288C816 654 686 783 527 783z" fill="#01E408" p-id="3996" /><path d="M669 470l-209-159-2-1c-5-4-12-7-20-7-17 0-32 14-32 32l0 322c0 17 14 32 32 32 7 0 14-3 20-7l2-1 209-159 2-2c5-5 9-13 9-22 0-8-3-16-9-22L669 470 669 470z" fill="#01E408" p-id="3997" /></svg>'
long imageid = -1

private:
subroutine videoCreate() system library "pbidea.dll" alias for "videoCreate"
subroutine videoDestroy() system library "pbidea.dll" alias for "videoDestroy"

public:
//取摄像头列表及参数
function int GetCameraList(uo_json json) system library "pbidea.dll" alias for "videoGetCameraList"
//播放视频，port ,iWidth/iHeight分辨率, format格式 YUY2/RGB24/MJPG/H264..., obj指定到某控件上
function boolean Play(int port) system library "pbidea.dll" alias for "videoPlay"
function boolean Play(int port, int iwidth, int iheight) system library "pbidea.dll" alias for "videoPlay"
function boolean Play(int port, int iwidth, int iheight, readonly string format) system library "pbidea.dll" alias for "videoPlay"
//pause
function boolean pause() system library "pbidea.dll" alias for "videoPause"
//stop
function boolean stop() system library "pbidea.dll" alias for "videoStop"
//水平镜像
subroutine mirror(boolean switch) system library "pbidea.dll" alias for "videoMirror"
//垂直镜像
subroutine flip(boolean switch) system library "pbidea.dll" alias for "videoFlip"
//拉伸
subroutine stretch(boolean switch) system library "pbidea.dll" alias for "videoStretch"
//拍照,file JPEG
function boolean capture(readonly string file) system library "pbidea.dll" alias for "videoCapture"
function blob capture() system library "pbidea.dll" alias for "videoCapture"
//x265记录
function boolean StartRecord(readonly string file) system library "pbidea.dll" alias for "videoStartRecord"
subroutine StopRecord() system library "pbidea.dll" alias for "videoStopRecord"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_charset" id="uo_charset">uo_charset</a></div>
<pre><code>
//cn:字符集相关功能
//en:Character set related functions
/*
支持以下字符集互相转换

ANSI_X3.4-1968 ANSI_X3.4-1986 ASCII CP367 IBM367 ISO-IR-6 ISO646-US ISO_646.IRV:1991 US US-ASCII CSASCII
UTF-8
ISO-10646-UCS-2 UCS-2 CSUNICODE
UCS-2BE UNICODE-1-1 UNICODEBIG CSUNICODE11
UCS-2LE UNICODELITTLE
ISO-10646-UCS-4 UCS-4 CSUCS4
UCS-4BE
UCS-4LE
UTF-16
UTF-16BE
UTF-16LE
UTF-32
UTF-32BE
UTF-32LE
UNICODE-1-1-UTF-7 UTF-7 CSUNICODE11UTF7
UCS-2-INTERNAL
UCS-2-SWAPPED
UCS-4-INTERNAL
UCS-4-SWAPPED
C99
JAVA
CP819 IBM819 ISO-8859-1 ISO-IR-100 ISO8859-1 ISO_8859-1 ISO_8859-1:1987 L1 LATIN1 CSISOLATIN1
ISO-8859-2 ISO-IR-101 ISO8859-2 ISO_8859-2 ISO_8859-2:1987 L2 LATIN2 CSISOLATIN2
ISO-8859-3 ISO-IR-109 ISO8859-3 ISO_8859-3 ISO_8859-3:1988 L3 LATIN3 CSISOLATIN3
ISO-8859-4 ISO-IR-110 ISO8859-4 ISO_8859-4 ISO_8859-4:1988 L4 LATIN4 CSISOLATIN4
CYRILLIC ISO-8859-5 ISO-IR-144 ISO8859-5 ISO_8859-5 ISO_8859-5:1988 CSISOLATINCYRILLIC
ARABIC ASMO-708 ECMA-114 ISO-8859-6 ISO-IR-127 ISO8859-6 ISO_8859-6 ISO_8859-6:1987 CSISOLATINARABIC
ECMA-118 ELOT_928 GREEK GREEK8 ISO-8859-7 ISO-IR-126 ISO8859-7 ISO_8859-7 ISO_8859-7:1987 ISO_8859-7:2003 CSISOLATINGREEK
HEBREW ISO-8859-8 ISO-IR-138 ISO8859-8 ISO_8859-8 ISO_8859-8:1988 CSISOLATINHEBREW
ISO-8859-9 ISO-IR-148 ISO8859-9 ISO_8859-9 ISO_8859-9:1989 L5 LATIN5 CSISOLATIN5
ISO-8859-10 ISO-IR-157 ISO8859-10 ISO_8859-10 ISO_8859-10:1992 L6 LATIN6 CSISOLATIN6
ISO-8859-11 ISO8859-11 ISO_8859-11
ISO-8859-13 ISO-IR-179 ISO8859-13 ISO_8859-13 L7 LATIN7
ISO-8859-14 ISO-CELTIC ISO-IR-199 ISO8859-14 ISO_8859-14 ISO_8859-14:1998 L8 LATIN8
ISO-8859-15 ISO-IR-203 ISO8859-15 ISO_8859-15 ISO_8859-15:1998 LATIN-9
ISO-8859-16 ISO-IR-226 ISO8859-16 ISO_8859-16 ISO_8859-16:2001 L10 LATIN10
KOI8-R CSKOI8R
KOI8-U
KOI8-RU
CP1250 MS-EE WINDOWS-1250
CP1251 MS-CYRL WINDOWS-1251
CP1252 MS-ANSI WINDOWS-1252
CP1253 MS-GREEK WINDOWS-1253
CP1254 MS-TURK WINDOWS-1254
CP1255 MS-HEBR WINDOWS-1255
CP1256 MS-ARAB WINDOWS-1256
CP1257 WINBALTRIM WINDOWS-1257
CP1258 WINDOWS-1258
850 CP850 IBM850 CSPC850MULTILINGUAL
862 CP862 IBM862 CSPC862LATINHEBREW
866 CP866 IBM866 CSIBM866
CP1131
MAC MACINTOSH MACROMAN CSMACINTOSH
MACCENTRALEUROPE
MACICELAND
MACCROATIAN
MACROMANIA
MACCYRILLIC
MACUKRAINE
MACGREEK
MACTURKISH
MACHEBREW
MACARABIC
MACTHAI
HP-ROMAN8 R8 ROMAN8 CSHPROMAN8
NEXTSTEP
ARMSCII-8
GEORGIAN-ACADEMY
GEORGIAN-PS
KOI8-T
CP154 CYRILLIC-ASIAN PT154 PTCP154 CSPTCP154
KZ-1048 RK1048 STRK1048-2002 CSKZ1048
MULELAO-1
CP1133 IBM-CP1133
ISO-IR-166 TIS-620 TIS620 TIS620-0 TIS620.2529-1 TIS620.2533-0 TIS620.2533-1
CP874 WINDOWS-874
VISCII VISCII1.1-1 CSVISCII
TCVN TCVN-5712 TCVN5712-1 TCVN5712-1:1993
ISO-IR-14 ISO646-JP JIS_C6220-1969-RO JP CSISO14JISC6220RO
JISX0201-1976 JIS_X0201 X0201 CSHALFWIDTHKATAKANA
ISO-IR-87 JIS0208 JIS_C6226-1983 JIS_X0208 JIS_X0208-1983 JIS_X0208-1990 X0208 CSISO87JISX0208
ISO-IR-159 JIS_X0212 JIS_X0212-1990 JIS_X0212.1990-0 X0212 CSISO159JISX02121990
CN GB_1988-80 ISO-IR-57 ISO646-CN CSISO57GB1988
CHINESE GB_2312-80 ISO-IR-58 CSISO58GB231280
CN-GB-ISOIR165 ISO-IR-165
ISO-IR-149 KOREAN KSC_5601 KS_C_5601-1987 KS_C_5601-1989 CSKSC56011987
EUC-JP EUCJP EXTENDED_UNIX_CODE_PACKED_FORMAT_FOR_JAPANESE CSEUCPKDFMTJAPANESE
MS_KANJI SHIFT-JIS SHIFT_JIS SJIS CSSHIFTJIS
CP932
ISO-2022-JP CSISO2022JP
ISO-2022-JP-1
ISO-2022-JP-2 CSISO2022JP2
CN-GB EUC-CN EUCCN GB2312 CSGB2312
GBK
CP936 MS936 WINDOWS-936
GB18030
ISO-2022-CN CSISO2022CN
ISO-2022-CN-EXT
HZ HZ-GB-2312
EUC-TW EUCTW CSEUCTW
BIG-5 BIG-FIVE BIG5 BIGFIVE CN-BIG5 CSBIG5
CP950
BIG5-HKSCS:1999
BIG5-HKSCS:2001
BIG5-HKSCS:2004
BIG5-HKSCS BIG5-HKSCS:2008 BIG5HKSCS
EUC-KR EUCKR CSEUCKR
CP949 UHC
CP1361 JOHAB
ISO-2022-KR CSISO2022KR
CP856
CP922
CP943
CP1046
CP1124
CP1129
CP1161 IBM-1161 IBM1161 CSIBM1161
CP1162 IBM-1162 IBM1162 CSIBM1162
CP1163 IBM-1163 IBM1163 CSIBM1163
DEC-KANJI
DEC-HANYU
437 CP437 IBM437 CSPC8CODEPAGE437
CP737
CP775 IBM775 CSPC775BALTIC
852 CP852 IBM852 CSPCP852
CP853
855 CP855 IBM855 CSIBM855
857 CP857 IBM857 CSIBM857
CP858
860 CP860 IBM860 CSIBM860
861 CP-IS CP861 IBM861 CSIBM861
863 CP863 IBM863 CSIBM863
CP864 IBM864 CSIBM864
865 CP865 IBM865 CSIBM865
869 CP-GR CP869 IBM869 CSIBM869
CP1125
EUC-JIS-2004 EUC-JISX0213
SHIFT_JIS-2004 SHIFT_JISX0213
ISO-2022-JP-2004 ISO-2022-JP-3
BIG5-2003
ISO-IR-230 TDS565
ATARI ATARIST
RISCOS-LATIN1
*/

subroutine InitCharset() system library "PbIdea.dll" alias for "InitCharset"
subroutine UnInitCharset() system library "PbIdea.dll" alias for "UnInitCharset"

//指定使用 GB18030字符集
subroutine SetGB18030(boolean enable) system library "PbIdea.dll" alias for "SetGB18030"

//指定编码转换时的默认字符集
function boolean SetCodePage(long code_page) system library "PbIdea.dll" alias for "SetCodePage"

//判断是不是Utf8字符串
function boolean IsUtf8Text(blob data) system library "PbIdea.dll" alias for "IsUtf8Text"
//判断是不是Utf16(unicode,PB10以上默认)字符串
function boolean IsUtf16Text(blob data) system library "PbIdea.dll" alias for "IsUtf16Text"

//判断是否包含某字符串
function boolean HaveAnsiText(readonly blob data,readonly string text) system library "PbIdea.dll" alias for "HaveAnsiText"
function boolean HaveUtf8Text(readonly blob data,readonly string text) system library "PbIdea.dll" alias for "HaveUtf8Text"
function boolean HaveUtf16Text(readonly blob data,readonly string text) system library "PbIdea.dll" alias for "HaveUtf16Text"

//系统字符集
function uo_json GetCharsetList() system library "PbIdea.dll" alias for "GetCharsetList"
//返回unicode码对应的字符
function string GetCharByUnicode(long unicode) system library "PbIdea.dll" alias for "fontGetCharByUnicode"

//字符集转换
//blob srcData 源数据，如果是字符串，由 blob(字符串)
//string fromCharset,string toCharset ,从一个字符集到另一个字符集，可以取值
//gb18030 , utf-8 , utf-16 , utf-16le , utf-16be ,  更多转换功能项，可以 iconv -l 察看
function blob CharsetConvert(blob srcData,readonly string fromCharset,readonly string toCharset) system library "PbIdea.dll" alias for "CharsetConvert"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_compress" id="uo_compress">uo_compress</a></div>
<pre><code>
//zlib、gzip、7zip

//zlib压缩、解压缩, compressType: 0:deflate,1:zlib,2:gzip,默认1
function blob zCompress(readonly blob data,int nLevel) system library "PbIdea.dll" alias for "zCompress"
function blob zCompress(readonly blob data,int nLevel,int compressType) system library "PbIdea.dll" alias for "zCompress"
function blob zUncompress(readonly blob data) system library "PbIdea.dll" alias for "zUncompress"
function blob zUncompress(readonly blob data,int compressType) system library "PbIdea.dll" alias for "zUncompress"
//gzip 压缩、解压缩
function blob gzcompress(readonly blob data) system library "PbIdea.dll" alias for "gzcompress"
function blob gzuncompress(readonly blob data) system library "PbIdea.dll" alias for "gzuncompress"


//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//
function boolean SevenZipAddFile(readonly string filesOrDires, readonly string str7zFile) system library "PbIdea.dll" alias for "SevenZipAddFile"
function boolean SevenZipAExtract(readonly string str7zFile,readonly string outDires) system library "PbIdea.dll" alias for "SevenZipAExtract"

//生成一个 zip entry
function blob CompressEntry(readonly string fileName,blob data) system library "PbIdea.dll" alias for "zipCompressEntry"
//解压一个 zip entry
function blob DecompressEntry(blob data,ref string fileName) system library "PbIdea.dll" alias for "zipDecompressEntry"

//Snappy 是一个 C++ 的用来压缩和解压缩的开发包。其目标不是最大限度压缩或者兼容其他压缩格式，而是旨在提供高速压缩速度和合理的压缩率。
//Snappy 比 zlib 更快，但文件相对要大 20% 到 100%。在 64位模式的 Core i7 处理器上，可达每秒 250~500兆的压缩速度。
//压缩
function blob snappyCompress(blob data) system library "PbIdea.dll" alias for "snappyCompress"
function blob snappyCompress(blob data, ref boolean success) system library "PbIdea.dll" alias for "snappyCompress"
//解压
function blob snappyUncompress(blob data) system library "PbIdea.dll" alias for "snappyUncompress"
function blob snappyUncompress(blob data, ref boolean success) system library "PbIdea.dll" alias for "snappyUncompress"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_config" id="uo_config">uo_config</a></div>
<pre><code>
//cn:配置文件管理，可使用json格式替代ini格式,同时支持对象序列化与反序列化
//en:Configuration file management, which can use json format instead of ini format, and supports object serialization and deserialization

//当带 key 调用 open 函数时，会自动对值进行加密、解密
public:
boolean OnlyString = false //是否只抓取字符串字段,text,title等
string  EventName = "on_data_change" //反序列化后触发事件名称
string  dwcolumns = ""  //datawindow包含哪些列,不设置就是包含所有列，设置后只包含指定列
//boolean overwrite = false //如果属性已经存在，是否覆盖重写
private:
string _filename //配置文件名
uo_json _json    //配置文件
string _key = "" //加密字符串用的key
uo_crypto _c
boolean _crypto = false //是否加密解密,根据_key长度来
string _iv = "0123456701234567"

//读对象的所有属性值
function int ReadObjectProperty(powerobject obj,ref string names[],ref any values[],ref string flags[]) system library "PbIdea.dll" alias for "ReadObjectProperty"
//设置对象属性值
function boolean WriteObjectProperty(powerobject obj,readonly string name,readonly any value,readonly string flag) system library "PbIdea.dll" alias for "WriteObjectProperty"
//取类型名称
function string GetClassnameByFlag(readonly string flag) system library "PbIdea.dll" alias for "GetClassnameByFlag"
//对象反序列化后，调用对象的指定事件进行触发刷新。是否触发事件，由WriteObjectProperty时变更数决定，没变更则不触发
subroutine InvokeChangeEvent(powerobject obj,readonly string sEventName) system library "PbIdea.dll" alias for "InvokeChangeEvent"
//读取datawindow json信息,readonly string columns 包含哪些列，如果为“”，则所有列
function string ReadDatawindowInfo(datawindow dw,uo_json js) system library "PbIdea.dll" alias for "ReadDatawindowInfo"
function string ReadDatawindowInfo(datawindow dw,uo_json js,readonly string columns) system library "PbIdea.dll" alias for "ReadDatawindowInfo"
//将数据写入datawindow
function string WriteDatawindowInfo(datawindow dw,uo_json js) system library "PbIdea.dll" alias for "WriteDatawindowInfo"
//取对象的祖先类名称
function string GetSystemTypeName(powerobject obj) system library "PbIdea.dll" alias for "GetSystemTypeName"
//取上层容器对象
function powerobject GetNestObject(powerobject obj) system library "PbIdea.dll" alias for "GetNestObject"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_cover" id="uo_cover">uo_cover</a></div>
<pre><code>
//cover window

private:
function boolean CreateCoverWindow() system library "pbidea.dll" alias for "CreateCoverWindow"
subroutine DestroyCoverWindow() system library "pbidea.dll" alias for "DestroyCoverWindow"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_crypto" id="uo_crypto">uo_crypto</a></div>
<pre><code>
//cn:openssl库加解密、编码等,基于密码学的算法库
//en:Openssl library encryption, decryption, coding, etc., algorithm library based on cryptography
//CRC16  标准
constant int CRC16_NONE        = 0
constant int CRC16_CCITT       = 1
constant int CRC16_CCITT_FALSE = 2
constant int CRC16_XMODEM      = 3
constant int CRC16_X25         = 4
constant int CRC16_MODBUS      = 5
constant int CRC16_IBM         = 6
constant int CRC16_MAXIM       = 7
constant int CRC16_USB         = 8

//加密对齐方式
constant int PADDING_PKCS5     = 1
constant int PADDING_PKCS7     = 1
constant int PADDING_ISO7816_4 = 2
constant int PADDING_ANSI923   = 3
constant int PADDING_ISO10126  = 4
constant int PADDING_ZERO      = 5

//国密SM2编码方式
constant int SM2_C1C3C2        = 1
constant int SM2_C1C2C3        = 2
constant int SM2_C1C3C2_ASN1   = 3
constant int SM2_C1C2C3_ASN1   = 4
constant int SM2_ASN1          = 5

/*
加密方式列表,crypto参数的 algo 参数可选以下字符串
des_ecb
des_ede
des_ede3
des_ede_ecb
des_ede3_ecb
des_cfb64
des_cfb1
des_cfb8
des_ede_cfb64
des_ede3_cfb64
des_ede3_cfb1
des_ede3_cfb8
des_ofb
des_ede_ofb
des_ede3_ofb
des_cbc
des_ede_cbc
des_ede3_cbc
desx_cbc
des_ede3_wrap
rc4
rc4_40
rc4_hmac_md5
idea_ecb
idea_cfb64
idea_ofb
idea_cbc
rc2_ecb
rc2_cbc
rc2_40_cbc
rc2_64_cbc
rc2_cfb64
rc2_ofb
bf_ecb
bf_cbc
bf_cfb64
bf_ofb
cast5_ecb
cast5_cbc
cast5_cfb64
cast5_ofb
rc5_32_12_16_cbc
rc5_32_12_16_ecb
rc5_32_12_16_cfb64
rc5_32_12_16_ofb
aes_128_ecb
aes_128_cbc
aes_128_cfb1
aes_128_cfb8
aes_128_cfb128
aes_128_ofb
aes_128_ctr
aes_128_ccm
aes_128_gcm
aes_128_xts
aes_128_wrap
aes_128_wrap_pad
aes_128_ocb
aes_192_ecb
aes_192_cbc
aes_192_cfb1
aes_192_cfb8
aes_192_cfb128
aes_192_ofb
aes_192_ctr
aes_192_ccm
aes_192_gcm
aes_192_wrap
aes_192_wrap_pad
aes_192_ocb
aes_256_ecb
aes_256_cbc
aes_256_cfb1
aes_256_cfb8
aes_256_cfb128
aes_256_ofb
aes_256_ctr
aes_256_ccm
aes_256_gcm
aes_256_xts
aes_256_wrap
aes_256_wrap_pad
aes_256_ocb
aes_128_cbc_hmac_sha1
aes_256_cbc_hmac_sha1
aes_128_cbc_hmac_sha256
aes_256_cbc_hmac_sha256
aria_128_ecb
aria_128_cbc
aria_128_cfb1
aria_128_cfb8
aria_128_cfb128
aria_128_ctr
aria_128_ofb
aria_128_gcm
aria_128_ccm
aria_192_ecb
aria_192_cbc
aria_192_cfb1
aria_192_cfb8
aria_192_cfb128
aria_192_ctr
aria_192_ofb
aria_192_gcm
aria_192_ccm
aria_256_ecb
aria_256_cbc
aria_256_cfb1
aria_256_cfb8
aria_256_cfb128
aria_256_ctr
aria_256_ofb
aria_256_gcm
aria_256_ccm
camellia_128_ecb
camellia_128_cbc
camellia_128_cfb1
camellia_128_cfb8
camellia_128_cfb128
camellia_128_ofb
camellia_128_ctr
camellia_192_ecb
camellia_192_cbc
camellia_192_cfb1
camellia_192_cfb8
camellia_192_cfb128
camellia_192_ofb
camellia_192_ctr
camellia_256_ecb
camellia_256_cbc
camellia_256_cfb1
camellia_256_cfb8
camellia_256_cfb128
camellia_256_ofb
camellia_256_ctr
chacha20
chacha20_poly1305
seed_ecb
seed_cbc
seed_cfb128
seed_ofb
sm4_ecb
sm4_cbc
sm4_cfb128
sm4_ofb
sm4_ctr
*/

//RSA,加密解密
function blob EncryptByPublicKey(readonly string strPublicKey,readonly blob text) system library "PbIdea.dll" alias for "EncryptByPublicKey"
function blob EncryptByPublicKey(readonly string strPublicKey,readonly blob text,readonly string pwd) system library "PbIdea.dll" alias for "EncryptByPublicKey"
function blob EncryptByPublicKey(readonly string strPublicKey,readonly blob text,readonly string pwd,int padding) system library "PbIdea.dll" alias for "EncryptByPublicKey"
function blob DecryptByPublicKey(readonly string strPublicKey,readonly blob text) system library "PbIdea.dll" alias for "DecryptByPublicKey"
function blob EncryptByPrivateKey(readonly string strPrivateKey,readonly blob text) system library "PbIdea.dll" alias for "EncryptByPrivateKey"
function blob DecryptByPrivateKey(readonly string strPrivateKey,readonly blob text) system library "PbIdea.dll" alias for "DecryptByPrivateKey"

//生成RSA密钥对
function boolean GenerateRSAKey(readonly string publicFile,readonly string privateFile) system library "PbIdea.dll" alias for "GenerateRSAKey" //keylen : 1024 或 2048
function boolean GenerateRSAKey(readonly string publicFile,readonly string privateFile,int keylen) system library "PbIdea.dll" alias for "GenerateRSAKey" //keylen : 1024 或 2048
function boolean GenerateRSAKey(readonly string publicFile,readonly string privateFile,int keylen,readonly string pkcs) system library "PbIdea.dll" alias for "GenerateRSAKey" //keylen : 1024 或 2048
function string AlignKey(readonly string key,boolean opensslKey,boolean privateKey) system library "PbIdea.dll" alias for "AlignKey"
function string AlignKey(readonly string key) system library "PbIdea.dll" alias for "AlignKey"

//生成SM2密钥对
function boolean GenerateSM2Key(ref string publicKey,ref string privateKey) system library "PbIdea.dll" alias for "GenerateSM2Key"
function blob SM2Encrypt(readonly string strPublicKey,readonly blob text,readonly string method) system library "PbIdea.dll" alias for "SM2Encrypt"
function blob SM2Encrypt(readonly string strPublicKey,readonly blob text,readonly string method,int encode) system library "PbIdea.dll" alias for "SM2Encrypt"
function blob SM2Decrypt(readonly string strPrivateKey,readonly blob cipher,readonly string method) system library "PbIdea.dll" alias for "SM2Decrypt"
function blob SM2Decrypt(readonly string strPrivateKey,readonly blob cipher,readonly string method,int encode) system library "PbIdea.dll" alias for "SM2Decrypt"
function string SignWithSM2(readonly string strPrivateKey,readonly blob text,readonly string method) system library "PbIdea.dll" alias for "SignWithSM2"
function string SignWithSM2(readonly string strPrivateKey,readonly blob text,readonly string method,readonly string id) system library "PbIdea.dll" alias for "SignWithSM2"
function boolean VerifyWithSM2(readonly string strPublicKey,readonly blob text,readonly string sign,readonly string method) system library "PbIdea.dll" alias for "VerifyWithSM2"
function boolean VerifyWithSM2(readonly string strPublicKey,readonly blob text,readonly string sign,readonly string method,readonly string id) system library "PbIdea.dll" alias for "VerifyWithSM2"

//SignWithRSA,method可取值:sha1,sha224,sha256,sha384,sha512,md4,md5,md5_sha1
function string SignWithRSA(readonly string privateKey,readonly string text,readonly string method) system library "PbIdea.dll" alias for "SignWithRSA"
function string SignWithRSA(readonly string privateKey,readonly string text,readonly string method,boolean utf8) system library "PbIdea.dll" alias for "SignWithRSA"
function string SignWithRSA(readonly string pkcs12,readonly string text,readonly string method,boolean utf8,readonly string password) system library "PbIdea.dll" alias for "SignWithRSA"
function boolean SignWithRSAVerify(readonly string publicKey,readonly string text,readonly string sign,readonly string method) system library "PbIdea.dll" alias for "SignWithRSAVerify"
function boolean SignWithRSAVerify(readonly string publicKey,readonly string text,readonly string sign,readonly string method,boolean utf8) system library "PbIdea.dll" alias for "SignWithRSAVerify"

//base64
function string Base64(readonly blob data) system library "PbIdea.dll" alias for "Base64Encode"
function string Base64Encode(readonly blob data) system library "PbIdea.dll" alias for "Base64Encode"
function string Base64Encode(readonly blob data,boolean urlsafe) system library "PbIdea.dll" alias for "Base64Encode"
function blob Base64Decode(readonly string strBase64) system library "PbIdea.dll" alias for "Base64Decode"
function blob Base64Decode(readonly string strBase64,boolean urlsafe) system library "PbIdea.dll" alias for "Base64Decode"
//字符串长度有限制
function string Base64EncodeFile(readonly string file) system library "PbIdea.dll" alias for "Base64EncodeFile"
//超长字符串，可以直接指定文件名，将内容写入文件,返回编码长度
function long Base64EncodeFile(readonly string file,readonly string toBase64File) system library "PbIdea.dll" alias for "Base64EncodeFile"
function blob Base64DecodeFile(readonly string file) system library "PbIdea.dll" alias for "Base64DecodeFile"

//md5
function string MD5(readonly string data) system library "PbIdea.dll" alias for "MD5String"
function string MD5(readonly blob data) system library "PbIdea.dll" alias for "MD5Blob"
function string MD5String(readonly blob data) system library "PbIdea.dll" alias for "MD5String"
function string MD5Blob(readonly blob data) system library "PbIdea.dll" alias for "MD5Blob"
//默认是文件中的文本进行md5编码
function string MD5File(readonly string strFile) system library "PbIdea.dll" alias for "MD5File" 
//可以让 isText 为 false ，则进行二进制编码
function string MD5File(readonly string strFile,boolean isText) system library "PbIdea.dll" alias for "MD5File" 

//sha
function string Sha1(readonly blob data) system library "PbIdea.dll" alias for "Sha1"
function string Sha224(readonly blob data) system library "PbIdea.dll" alias for "Sha224"
function string Sha256(readonly blob data) system library "PbIdea.dll" alias for "Sha256"
function string Sha384(readonly blob data) system library "PbIdea.dll" alias for "Sha384"
function string Sha512(readonly blob data) system library "PbIdea.dll" alias for "Sha512"

//时间戳转换
FUNCTION datetime FromTimeStamp(longlong nTime) system library "PbIdea.dll" alias for "FromTimeStamp"
FUNCTION datetime FromTimeStamp(longlong nTime, boolean bmsec) system library "PbIdea.dll" alias for "FromTimeStamp"
FUNCTION datetime FromTimeStamp(longlong nTime,ref int year,ref int month,ref int day,ref int hour,ref int minute,ref int sec) system library "PbIdea.dll" alias for "FromTimeStamp"
FUNCTION datetime FromTimeStamp(longlong nTime,ref int year,ref int month,ref int day,ref int hour,ref int minute,ref int sec,ref int msec) system library "PbIdea.dll" alias for "FromTimeStamp"
FUNCTION longlong ToTimeStamp(int year,int month,int day,int hour,int minute,int sec) system library "PbIdea.dll"  alias for "ToTimeStamp"
FUNCTION longlong ToTimeStamp(int year,int month,int day,int hour,int minute,int sec,int msec) system library "PbIdea.dll"  alias for "ToTimeStamp"
FUNCTION longlong ToTimeStamp(datetime dt,boolean bmsec) system library "PbIdea.dll"  alias for "ToTimeStamp"
FUNCTION longlong ToTimeStamp(boolean bmsec) system library "PbIdea.dll"  alias for "ToTimeStamp"

//URL编码转换,toUtf8 是否先转utf8编码，toLower 结果是小写或大写, 空格编码成 +, w3c->false: ' '->%20
function string URLEncode(readonly string url,boolean toUtf8) system library "PbIdea.dll"  alias for "URLEncode"
function string URLEncode(readonly string url,boolean toUtf8,boolean toLower) system library "PbIdea.dll"  alias for "URLEncode"
function string URLEncode(readonly string url,boolean toUtf8,boolean toLower, boolean onlyChineseWord) system library "PbIdea.dll"  alias for "URLEncode"
function string URLEncode(readonly string url,boolean toUtf8,boolean toLower, boolean onlyChineseWord, boolean w3c) system library "PbIdea.dll"  alias for "URLEncode"
//url解码
function string URLDecode(readonly string url,boolean fromUtf8) system library "PbIdea.dll"  alias for "URLDecode"

//BLOB <-> HEX 转换
function string BlobToHex(readonly blob data,boolean bAddSpace) system library "PbIdea.dll"  alias for "BlobToHex"
function blob HexToBlob(readonly string hex) system library "PbIdea.dll"  alias for "HexToBlob"

//base64 <-> hex 转换
function string Base64ToHex(readonly string base64,ref boolean success) system library "PbIdea.dll"  alias for "Base64ToHex"
function string HexToBase64(readonly string hex,ref boolean success) system library "PbIdea.dll"  alias for "HexToBase64"

//unicode 编码、解码,即 \u0041 这样的格式
function string UnicodeEncode(readonly string str) system library "PbIdea.dll"  alias for "UnicodeEncode"
function string UnicodeEncode(readonly string str,boolean encodeAnsi) system library "PbIdea.dll"  alias for "UnicodeEncode"
function string UnicodeEncode(readonly string str,boolean encodeAnsi,boolean capital) system library "PbIdea.dll"  alias for "UnicodeEncode"
function string UnicodeDecode(readonly string str) system library "PbIdea.dll"  alias for "UnicodeDecode"
function blob UnicodeDecodeBlob(readonly string str) system library "PbIdea.dll"  alias for "UnicodeDecodeBlob"

//HMAC
function blob HMACEncode(readonly string algo,readonly string key,readonly blob data) system library "PbIdea.dll"  alias for "HMACEncode"
function blob HMACEncode(readonly string algo,readonly blob key,readonly blob data) system library "PbIdea.dll"  alias for "HMACEncode"

//CRC
function string Crc32(readonly blob data) system library "PbIdea.dll" alias for "Crc32"
function string Crc16(readonly blob data,int crcType) system library "PbIdea.dll" alias for "Crc16"
function string Crc8(readonly blob data) system library "PbIdea.dll" alias for "Crc8"

//Adler32
function string Adler32(readonly blob data) system library "PbIdea.dll" alias for "Adler32"

//bcc
function string Bcc(readonly blob data) system library "PbIdea.dll" alias for "Bcc"

//guid
function string GetGUID() system library "PbIdea.dll" alias for "GetGUID"
function string GetGUID(boolean hasSign) system library "PbIdea.dll" alias for "GetGUID"
function string GetUUID() system library "PbIdea.dll" alias for "GetUUID"
function string GetUUID(boolean hasSign) system library "PbIdea.dll" alias for "GetUUID"

//雪花算法取唯一ID
function string SnowFlake(long seed) system library "PbIdea.dll" alias for "SnowFlake"
function string SnowFlake() system library "PbIdea.dll" alias for "SnowFlake"

//加密函数
//取随机长度的KEY
function string GetRandKey(int keylen) system library "PbIdea.dll" alias for "GetRandKey"
//参数说明：
//data   : 待加密数据，或已加密数据
//key    : 加密关键字
//method : 1加密 0解密
//algo   : 指定加密方式,见instance variable 说明
//vec    : 向量值，用于对数据进行变化，无向量时此参数传""
//padding: 对齐方式,见instance variable 说明
function blob Crypto(readonly blob data,readonly string key,int method,readonly string algo) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly string key,int method,readonly string algo,readonly string vec) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly string key,int method,readonly string algo,readonly string vec,int padding) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly string key,int method,readonly string algo,readonly blob vec) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly string key,int method,readonly string algo,readonly blob vec,int padding) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly blob key,int method,readonly string algo) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly blob key,int method,readonly string algo,readonly string vec) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly blob key,int method,readonly string algo,readonly string vec,int padding) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly blob key,int method,readonly string algo,readonly blob vec) system library "PbIdea.dll" alias for "Crypto"
function blob Crypto(readonly blob data,readonly blob key,int method,readonly string algo,readonly blob vec,int padding) system library "PbIdea.dll" alias for "Crypto"

//aes 128 加密解密，上面 Crypto 函数的简化版本，用Crypto 可以实现同样的功能
//参数： algotype:ecb cbc ...,string data:会转为utf8
function blob aes_encrypt(string algotype,string key,string iv,int padding,blob   data) system library "PbIdea.dll" alias for "cryptoAES_encrypt"
function blob aes_encrypt(string algotype,string key,string iv,int padding,string data) system library "PbIdea.dll" alias for "cryptoAES_encrypt"
function blob aes_encrypt(string algotype,blob key,string iv,int padding,blob   data) system library "PbIdea.dll" alias for "cryptoAES_encrypt"
function blob aes_encrypt(string algotype,blob key,string iv,int padding,string data) system library "PbIdea.dll" alias for "cryptoAES_encrypt"
function blob aes_decrypt(string algotype,string key,string iv,int padding,blob   data) system library "PbIdea.dll" alias for "cryptoAES_decrypt"
function blob aes_decrypt(string algotype,string key,string iv,int padding,string base64str) system library "PbIdea.dll" alias for "cryptoAES_decrypt"
function blob aes_decrypt(string algotype,blob key,string iv,int padding,blob   data) system library "PbIdea.dll" alias for "cryptoAES_decrypt"
function blob aes_decrypt(string algotype,blob key,string iv,int padding,string base64str) system library "PbIdea.dll" alias for "cryptoAES_decrypt"

//hash
function blob Hash(readonly blob data,readonly string algo)system library "PbIdea.dll" alias for "Hash"

//SM 2/3/4 函数 for PB
function blob gm_sm4(readonly blob data, readonly blob key, boolean decrypto) system library "PbIdea.dll" alias for "GM_sm4ecbEx"
function blob gm_sm4(readonly blob data, readonly string key, boolean decrypto) system library "PbIdea.dll" alias for "GM_sm4ecbEx"
function blob gm_sm2sign(readonly blob userID,readonly blob priKey,readonly blob pubKey, readonly blob src) system library "PbIdea.dll" alias for "GM_sm2signEx"
function blob gm_sm2sign(readonly blob userID,readonly blob priKey,readonly blob pubKey, readonly blob src,boolean asn1) system library "PbIdea.dll" alias for "GM_sm2signEx"
//method填"nowith"，不进行hash
function blob gm_sm2sign(readonly blob userID,readonly blob priKey,readonly blob pubKey, readonly blob src,boolean asn1, readonly string method) system library "PbIdea.dll" alias for "GM_sm2signEx"
function boolean gm_sm2verify(readonly blob userID,readonly blob pubKey, readonly blob src,readonly blob sign) system library "PbIdea.dll" alias for "GM_sm2verifyEx"
//method填"nowith"，不进行hash
function boolean gm_sm2verify(readonly blob userID,readonly blob pubKey, readonly blob src,readonly blob sign, readonly string method) system library "PbIdea.dll" alias for "GM_sm2verifyEx"
function blob gm_sm3(readonly blob data) system library "PbIdea.dll" alias for "GM_sm3Ex"
function boolean GM_createKey(ref blob priKey,ref blob pubKey) system library "PbIdea.dll" alias for "GM_createKey"
function blob gm_sm2encrypt(readonly blob pubKey, readonly blob data,int sm2_encode) system library "PbIdea.dll" alias for "GM_sm2encrypt"
function blob gm_sm2decrypt(readonly blob priKey, readonly blob data,int sm2_encode) system library "PbIdea.dll" alias for "GM_sm2decrypt"

//BLob转字节序列，同JAVA
function string BlobToByte(readonly blob data)system library "PbIdea.dll" alias for "BlobToByte"
function blob ByteToBlob(readonly string bytes)system library "PbIdea.dll" alias for "ByteToBlob"

//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//内蒙财政预算管理一体化系统与单位会计核算系统接口
function blob YSYTHEncrypto(readonly blob data,readonly string publicKey,int level) system library "PbIdea.dll" alias for "javaYSYTHEncrypto"
function blob YSYTHDecrypto(readonly blob data,readonly string privateKey,ref int level) system library "PbIdea.dll" alias for "javaYSYTHDecrypto"

function long YSYTHEncrypto(readonly blob data,long datalen, long level,readonly string pubKey,ref string base64buf,int base64len) library "PbIdea.dll" alias for "_javaYSYTHEncrypto"
function long YSYTHDecrypto(readonly string base64, readonly string priKey, ref blob buffer, long bufferlen, ref long level) library "PbIdea.dll" alias for "_javaYSYTHDecrypto"

/*
标准DLL接口
PB9,ansi版本
function long YSYTHEncrypto(blob data,long datalen, long level,string pubKey,ref string base64buf,int base64len) library "PbIdea.dll" alias for "javaYSYTHEncrypto"
function long YSYTHDecrypto(string base64, string priKey, ref blob buffer, long bufferlen, ref long level) library "PbIdea.dll" alias for "javaYSYTHDecrypto"

PB10,unicode版本
function long YSYTHEncrypto(blob data,long datalen, long level,string pubKey,ref string base64buf,int base64len) library "PbIdea.dll" alias for "javaYSYTHEncrypto"
function long YSYTHDecrypto(string base64, string priKey, ref blob buffer, long bufferlen, ref long level) library "PbIdea.dll" alias for "avaYSYTHDecrypto"
*/

//阿里csb签名方法
function string CsbSignature(uo_json jsonData) system library "PbIdea.dll" alias for "CsbSignature"
/*
标准版：function long csb_signature(string jsonIn,ref string jsonOut,int jsonOutLen) library "PbIdea.dll" alias for "csb_signature"
*/

//从 x509 证书里读公钥
function string ReadPublicKey(readonly string cerFile,readonly string password,ref string startTime,ref string endTime) system library "PbIdea.dll" alias for "cerReadPublicKey"
/*
string ls_pub,ls_time1,ls_time2
ls_pub = crypto.ReadPublicKey("../demores/cert/sm2.cer","",ls_time1,ls_time2)
messagebox("",ls_pub + "~r~n" + ls_time1 + "-" + ls_time2)
*/

//随机字符串
function string random() system library "pbidea.dll" alias for "getRandom"
function string random(blob seed) system library "pbidea.dll" alias for "getRandom"
function string random(blob seed,int bit_count) system library "pbidea.dll" alias for "getRandom"
function string random(blob seed,int bit_count,readonly string md) system library "pbidea.dll" alias for "getRandom"

//加解密文件头
function boolean CryptoFileHeader(readonly string fileName, readonly string key) system library "pbidea.dll" alias for "CryptoFileHeader"
function boolean DecryptFileHeader(readonly string fileName, readonly string key) system library "pbidea.dll" alias for "DecryptFileHeader"
function boolean IsFileHeaderCrypted(readonly string fileName) system library "pbidea.dll" alias for "IsFileHeaderCrypted"
function boolean IsFileHeaderCrypted(readonly string fileName, readonly string key) system library "pbidea.dll" alias for "IsFileHeaderCrypted"

//PKCS7sign , algo: sha1, sha256 ect..., pfx私钥证书可以存数据库，直接取出来用blob方式传入, 或编码成 base64字符串，使用前解码，传入blob
function string PKCS7sign(blob data, readonly string pfx, readonly string password, readonly string algo) system library "pbidea.dll" alias for "PKCS7sign"
function string PKCS7sign(blob data, readonly string pfx, readonly string password, readonly string algo, boolean multiLine) system library "pbidea.dll" alias for "PKCS7sign"
function string PKCS7sign(blob data, readonly blob pfx, readonly string password, readonly string algo) system library "pbidea.dll" alias for "PKCS7sign"
function string PKCS7sign(blob data, readonly blob pfx, readonly string password, readonly string algo, boolean multiLine) system library "pbidea.dll" alias for "PKCS7sign"
//PKCS7verify, cert可以是文件，也可以直接是CERTIFICATE字符串
function boolean PKCS7verify(blob data, readonly string cert, readonly string sign) system library "pbidea.dll" alias for "PKCS7verify"

//pkcs7信封加密
function string PKCS7encrypt(blob data, readonly string cert, readonly string algo) system library "pbidea.dll" alias for "PKCS7encrypt"
//pkcs7信封解密
//function blob PKCS7decrypt(blob data, readonly string pfx, readonly string password) system library "pbidea.dll" alias for "PKCS7decrypt"
function blob PKCS7decrypt(readonly string base64data, readonly string pfx, readonly string password) system library "pbidea.dll" alias for "PKCS7decrypt"
function blob PKCS7decrypt(readonly string base64data, blob pfx, readonly string password) system library "pbidea.dll" alias for "PKCS7decrypt"
function blob PKCS7decrypt(readonly blob cipherdata, readonly string pfx, readonly string password) system library "pbidea.dll" alias for "PKCS7decrypt"
function blob PKCS7decrypt(readonly blob cipherdata, blob pfx, readonly string password) system library "pbidea.dll" alias for "PKCS7decrypt"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_csharp" id="uo_csharp">uo_csharp</a></div>
<pre><code>
string msg = ""

//加载 C# DLL
function boolean Load(readonly string dllname) system library "pbidea.dll" alias for "csLoad"
//释放 C# DLL
subroutine UnLoad() system library "pbidea.dll" alias for "csUnLoad"

//取对象接口信息json
function boolean GetInterface(ref string json) system library "pbidea.dll" alias for "csGetInterface"

//创建对象，注意大小写
function uo_csharp_object CreateObject(readonly string _namespace, readonly string _class) system library "pbidea.dll" alias for "csCreateObject"

//销毁对象
subroutine DestroyObject(uo_csharp_object obj) system library "pbidea.dll" alias for "csDestroyObject"

//调用static函数
function boolean Invoke(readonly string _namespace, readonly string _class, readonly string method, ...) system library "pbidea.dll" alias for "csInvokeStatic"

//调用函数后取得返回值
function boolean GetReturn(ref string value) system library "pbidea.dll" alias for "csGetReturn"
function boolean GetReturn(ref long value) system library "pbidea.dll" alias for "csGetReturn"
function boolean GetReturn(ref int value) system library "pbidea.dll" alias for "csGetReturn"

//设置属性值
function boolean SetProperty(readonly string _namespace, readonly string _class, readonly string name, readonly string val) system library "pbidea.dll" alias for "csSetPropertyStatic"
//取属性值
function boolean GetProperty(readonly string _namespace, readonly string _class, readonly string name, ref string val) system library "pbidea.dll" alias for "csGetPropertyStatic"
function boolean GetProperty(readonly string _namespace, readonly string _class, readonly string name, ref long val) system library "pbidea.dll" alias for "csGetPropertyStatic"

//设置字段值
function boolean SetField(readonly string _namespace, readonly string _class, readonly string name, readonly string val) system library "pbidea.dll" alias for "csSetFieldStatic"
//取字段值
function boolean GetField(readonly string _namespace, readonly string _class, readonly string name, ref string val) system library "pbidea.dll" alias for "csGetFieldStatic"
function boolean GetField(readonly string _namespace, readonly string _class, readonly string name, ref long val) system library "pbidea.dll" alias for "csGetFieldStatic"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_csharp_object" id="uo_csharp_object">uo_csharp_object</a></div>
<pre><code>
string msg = ""

//销毁对象
subroutine DestroyObject() system library "pbidea.dll" alias for "csDestroyObject"

//创建对象后，调用函数
function boolean Invoke(readonly string method, ...) system library "pbidea.dll" alias for "csInvoke"

//调用函数后取得返回值
function boolean GetReturn(ref string value) system library "pbidea.dll" alias for "csGetReturn"
function boolean GetReturn(ref long value) system library "pbidea.dll" alias for "csGetReturn"
function boolean GetReturn(ref int value) system library "pbidea.dll" alias for "csGetReturn"

//设置属性值
function boolean SetProperty(readonly string name, readonly any val) system library "pbidea.dll" alias for "csSetProperty"
//取属性值
function boolean GetProperty(readonly string name, ref string val) system library "pbidea.dll" alias for "csGetProperty"
function boolean GetProperty(readonly string name, ref long val) system library "pbidea.dll" alias for "csGetProperty"

//设置字段值
function boolean SetField(readonly string name, readonly any val) system library "pbidea.dll" alias for "csSetField"
//取字段值
function boolean GetField(readonly string name, ref string val) system library "pbidea.dll" alias for "csGetField"
function boolean GetField(readonly string name, ref long val) system library "pbidea.dll" alias for "csGetField"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_curl" id="uo_curl">uo_curl</a></div>
<pre><code>
//cn:基于curl库的 httpclient
//en:Http client based on curl library
uo_response response  //响应结果

//静态变量，require 函数的第一个参数 nHttpType 
constant int HttpGet      = 1
constant int HttpPost     = 2
constant int HttpPut      = 3
constant int HttpPatch    = 4
constant int HttpDelete   = 5
constant int HttpCopy     = 6
constant int HttpHead     = 7
constant int HttpOptions  = 8
constant int HttpLink     = 9
constant int HttpUplink   = 10
constant int HttpPurge    = 11
constant int HttpLock     = 12
constant int HttpUnlock   = 13
constant int HttpPropfind = 14
constant int HttpView     = 15

//代理类别
constant int ProxyHttp    = 0
constant int ProxyHttp1_0 = 1
constant int ProxyHttps   = 2
constant int ProxySocks4  = 3
constant int ProxySocks5  = 4
constant int ProxySocks5a = 5
constant int ProxySocks4a = 6
constant int ProxySocks5_hostname = 7

//私有函数,初始化和销毁对象,对象内部使用
private:
//创建HttpClient对象
function ulong curlCreate() system library "PbIdea.dll" alias for "curlCreate"
//销毁HttpClient对象
subroutine curlDestroy() system library "PbIdea.dll" alias for "curlDestroy"

public:
subroutine SetUtf8(boolean defaultUtf8) system library "PbIdea.dll" alias for "curlSetUtf8"
//设置 http Header
subroutine SetHeader(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "curlSetHeader"
subroutine SetHeader(readonly uo_map headers) system library "PbIdea.dll" alias for "curlSetHeader"

subroutine Clear() system library "PbIdea.dll" alias for "curlClear"

//设置超时，单位:ms
subroutine SetTimeout(ulong nTimeout) system library "PbIdea.dll" alias for "curlSetTimeout"
//设置下载速度，单位:字节/秒, 默认 30/30,30秒30字节，即断开
subroutine SetSpeed(int seconds, int bytes) system library "PbIdea.dll" alias for "curlSetSpeed"

//设置调用地址和方法
subroutine SetUrl(readonly string url,readonly string method) system library "PbIdea.dll" alias for "curlSetUrl"
subroutine SetUrl(readonly string url,int method) system library "PbIdea.dll" alias for "curlSetUrl"

//设置代理 
subroutine SetProxy(string ip,int port)  system library "PbIdea.dll" alias for "curlSetProxy"
subroutine SetProxy(string ip,int port,int proxyType)  system library "PbIdea.dll" alias for "curlSetProxy"

//打开或关闭调试模式
subroutine SetDebug(boolean debugMode,string outputFile) system library "PbIdea.dll" alias for "curlSetDebug"

//设置参数
subroutine SetParam(readonly uo_map params) system library "PbIdea.dll" alias for "curlSetParam"
subroutine SetParam(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "curlSetParam"
subroutine SetParam(readonly string strKey,readonly string strValue,boolean urlencode) system library "PbIdea.dll" alias for "curlSetParam"

//FORM
subroutine SetForm(readonly string strKey,readonly string strValue               ) system library "PbIdea.dll" alias for "curlSetForm"
subroutine SetForm(readonly string strKey,readonly string strFile, boolean IsFile) system library "PbIdea.dll" alias for "curlSetForm"
subroutine SetForm(readonly string strKey,readonly string strFile, boolean IsFile,string contentType) system library "PbIdea.dll" alias for "curlSetForm"
subroutine SetForm(readonly string strKey,readonly blob data                     ) system library "PbIdea.dll" alias for "curlSetForm"

//将请求下载到指定文件
subroutine SetDownloadFile(readonly string fileName) system library "PbIdea.dll" alias for "curlSetDownloadFile"
//设置上传文件
subroutine SetUploadFile(readonly string fileName) system library "PbIdea.dll" alias for "curlSetUploadFile"

subroutine SetUserAgent(readonly string strUserAgent) system library "PbIdea.dll" alias for "curlSetUserAgent"

//basic auth
subroutine SetBasicAuth(string username,string password) system library "PbIdea.dll" alias for "curlSetBasicAuth"
//JWT验证
subroutine SetJWTAuth(string token) system library "PbIdea.dll" alias for "curlSetJWTAuth"

//设置证书和私钥信息, type: PEM DER  P12
subroutine SetCertInfo(string ca_cert_file,string client_cert_file,string client_cert_type) system library "PbIdea.dll" alias for "curlSetCertInfo"
subroutine SetPrivateKeyInfo(string private_key,string private_key_passwd,string private_key_type) system library "PbIdea.dll" alias for "curlSetPrivateKeyInfo"
subroutine SetCert(readonly string cert,readonly string keytype, readonly  string password) system library "PbIdea.dll" alias for "curlSetCert"

//set cookie file
subroutine SetCookieFile(string cookiefile) system library "PbIdea.dll" alias for "curlSetCookieFile"

//用于多任务异步，唯一标识一个任务
subroutine SetTaskID(string id) system library "PbIdea.dll" alias for "curlSetTaskID"
function string GetTaskID() system library "PbIdea.dll" alias for "curlGetTaskID"

//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"
//设置"Accept-Encoding", "gzip, deflate, br"， 同时对上传数据自动进行压缩
subroutine SetCompress(boolean compress) system library "PbIdea.dll" alias for "curlSetCompress"

//设置发送内容
subroutine SetBody(uo_json data) system library "PbIdea.dll" alias for "curlSetBody"
subroutine SetBody(blob    data) system library "PbIdea.dll" alias for "curlSetBody"
subroutine SetBody(string  data) system library "PbIdea.dll" alias for "curlSetBody"

/*
//参数说明：
//返回值说明：
函数返回 boolean 类型，表明本次调用是否成功完成。当网络有故障，或者其他原因导致调用失败，会返回 false，否则返回true。但此返回不表示接口是否正确处理相应请求.
*/  

//HTTP request,通过 GET ,POST ,PUT 等动作发送数据，并取得返回结果
function boolean request(            ) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(uo_json data) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(blob    data) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(string  data) system library "PbIdea.dll" alias for "curlRequest"

function boolean request(int nHttpType,readonly string strUrl             ) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(int nHttpType,readonly string strUrl,uo_json data) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(int nHttpType,readonly string strUrl,blob    data) system library "PbIdea.dll" alias for "curlRequest"
function boolean request(int nHttpType,readonly string strUrl,string  data) system library "PbIdea.dll" alias for "curlRequest"

//某些应用给 response 成员变量改名后，需要调用此函数
function boolean SetResponseName(string responseName) system library "PbIdea.dll" alias for "SetResponseName"
//是否重定向
subroutine SetForward(boolean redirect) system library "PbIdea.dll" alias for "curlSetForward"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_curl_async" id="uo_curl_async">uo_curl_async</a></div>
<pre><code>
//cn:基于curl库的异步 httpclient
//en:Asynchronous http client based on curl library

private:
//一组可以同时在线程里运行
uo_curl curls[] 


public:

private:
subroutine RequestAsyncWait() system library "PbIdea.dll" alias for "curlRequestAsyncWait"
subroutine curlRequestAsyncDestroy() system library "PbIdea.dll" alias for "curlRequestAsyncDestroy"

public:
//异步调用
function boolean RequestAsync(readonly uo_curl curltasks[]) system library "PbIdea.dll" alias for "curlRequestAsync"

//是否正在任务执行中
function boolean IsBusy() system library "PbIdea.dll" alias for "curlRequestAsyncBusy"

//清除资源
subroutine Clear() system library "PbIdea.dll" alias for "curlRequestAsyncClear"

//RequestAsync 后添加任务
function boolean StartTask(readonly uo_curl curl) system library "PbIdea.dll" alias for "curlRequestAsyncStartTask"

//取消下载，waitForFinish 是否等当前正在下载的内容完成，默认为 true
subroutine Cancel() system library "PbIdea.dll" alias for "curlRequestAsyncCancel"
subroutine Cancel(boolean waitForFinish) system library "PbIdea.dll" alias for "curlRequestAsyncCancel"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_datawindowex" id="uo_datawindowex">uo_datawindowex</a></div>
<pre><code>
//cn:datawindow的增强功能
//en:Enhancements to datawindow

//导入电子表格数据
Function long  ImportExcelSheet(datawindow dw,string szFile,int nSheet,int nSkipBegin,int nSkipEnd) system library "PbIdea.dll" alias for "ImportExcelSheet"
Function long  ImportExcelSheet(datawindow dw,string szFile,int nSheet,int nSkipBegin,int nSkipEnd,readonly uo_map mapField) system library "PbIdea.dll" alias for "ImportExcelSheet"
Function long  ImportExcelSheet(datastore  ds,string szFile,int nSheet,int nSkipBegin,int nSkipEnd) system library "PbIdea.dll" alias for "ImportExcelSheet"
Function long  ImportExcelSheet(datastore  ds,string szFile,int nSheet,int nSkipBegin,int nSkipEnd,readonly uo_map mapField) system library "PbIdea.dll" alias for "ImportExcelSheet"

//导出到电子表格
Function long ExportExcelSheet(datawindow dw,string szFile) system library "PbIdea.dll" alias for "ExportExcelSheet"
Function long ExportExcelSheet(datawindow dw,string szFile,boolean bNotExportHideCol) system library "PbIdea.dll" alias for "ExportExcelSheet"
Function long ExportExcelSheet(datawindow dw,string szFile,boolean bNotExportHideCol,boolean bDisplayValue) system library "PbIdea.dll" alias for "ExportExcelSheet"
//0 ID , 1 X
Function long ExportExcelSheet(datawindow dw,string szFile,boolean bNotExportHideCol,boolean bDisplayValue,int sortByIDorX) system library "PbIdea.dll" alias for "ExportExcelSheet"
Function long ExportExcelSheet(datastore  ds,string szFile) system library "PbIdea.dll" alias for "ExportExcelSheet"
Function long ExportExcelSheet(datastore  ds,string szFile,boolean bNotExportHideCol) system library "PbIdea.dll" alias for "ExportExcelSheet"
Function long ExportExcelSheet(datastore  ds,string szFile,boolean bNotExportHideCol,boolean bDisplayValue) system library "PbIdea.dll" alias for "ExportExcelSheet"
//0 ID , 1 X
Function long ExportExcelSheet(datastore ds,string szFile,boolean bNotExportHideCol,boolean bDisplayValue,int sortByIDorX) system library "PbIdea.dll" alias for "ExportExcelSheet"

//导出
Function long ExportExcel(datawindow dw,string szFile) system library "PbIdea.dll" alias for "ExportExcelOriginal"

//导入文本或者文本数据
function long dwImportString(datawindow dw,int startCol,int stopEnd,int dwStartCol,string str ) system library "PbIdea.dll" alias for "dwImportString"
function long dwImportFile  (datawindow dw,int startCol,int stopEnd,int dwStartCol,string file) system library "PbIdea.dll" alias for "dwImportFile"
function long dwImportFile  (datawindow dw,int startCol,int stopEnd,int dwStartCol,string file,boolean removeNull,boolean autoTrunc) system library "PbIdea.dll" alias for "dwImportFile"

//从dw里的 graph 控件读取出图片数据
function blob GrabPicture(datawindow dw, readonly string graphName) system library "PbIdea.dll" alias for "GrabPicture"
function blob GrabPicture(datastore  ds, readonly string graphName) system library "PbIdea.dll" alias for "GrabPicture"

//将DW打印到图片,格式BMP
function blob PrintDatawindowToBmp(datawindow dw, uo_json metadata) system library "PbIdea.dll" alias for "PrintDatawindowToBmp"
//是否把BMP格式转成PDF,如果是，则返回 pdf 内容
function blob PrintDatawindowToBmp(datawindow dw, uo_json metadata, boolean toPDF) system library "PbIdea.dll" alias for "PrintDatawindowToBmp"

//设置DW垂直居中
function boolean  VertCenter(datawindow dw) system library "PbIdea.dll" alias for "dwVCenter"

//取DW内容宽度
function int GetWidth(datawindow dw) system library "PbIdea.dll" alias for "dwGetWidth"

//电子表格转json , sheet: 1 2 3 4 ....
//json 支持选项定义： js.set("/option/mode", 3) js.set("/option/prefix", "A")， "/option/skipBegin" "/option/skipEnd" 参数同ImportExcelSheet参数
Function long  ExcelSheetToJson(string szFile, int sheet, uo_json json) system library "PbIdea.dll" alias for "ExcelSheetToJson"

//取sheet名称列表
function int ExcelSheetInfo(string szFile, uo_json json) system library "PbIdea.dll" alias for "ExcelSheetInfo"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_datetime" id="uo_datetime">uo_datetime</a></div>
<pre><code>
//date and time

/*
https://c-cpp.com/cpp/chrono/duration/formatter.html
下列格式说明符可用：

转换
说明符	解释
%%	写字面的 % 字符。
%n	写换行符。
%t	写水平制表符。
日之时间
%H
%OH	按十进制数字写时（ 24 小时时钟）。若结果为单个数位，则前附 0 。
修饰的命令 %OH 写本地环境的替用表示。

%I
%OI	按十进制数字写时（ 12 小时时钟）。若结果为单个数位，则前附 0 。
修饰的命令 %OI 写本地环境的替用表示。

%M
%OM	按十进制数字写分。若结果为单个数位，则前附 0 。
修饰的命令 %OM 写本地环境的替用表示。

%S
%OS	按十进制数字写秒。若结果为单个数位，则前附 0 。
若输入的精度不能准确地以秒表示，则格式为 fixed 格式且精度匹配输入精度的十进制浮点数（或若不能在 18 位小数内转换到浮点数十进制秒，则为到微秒精度）。用作小数点的字符按照本地环境本地化。

修饰的命令 %OS 写本地环境的替用表示。

%p	写与 12 小时时钟相关的 AM/PM 设计的本地环境版本。
%R	等价于 "%H:%M" 。
%T	等价于 "%H:%M:%S" 。
%r	写本地环境的 12 小时时钟时间。
%X
%EX	写本地环境的时间表示。
修饰的命令 %EX 写本地环境的替用时间表示。

下列说明符得到辨识，但会导致抛出 std::format_error ：

转换
说明符	解释
年
%C
%EC	写年除以 100 向下取整除的结果。若结果为单个十进制位，则前附 0 。
修饰的命令 %EC 写本地环境的替用世纪表示。

%y
%Oy
%Ey	写年的末二位十进制数。若结果为单个数位，则前附 0 。
修饰的命令 %Oy 写本地环境的替用表示。

修饰的命令 %Ey 写距 %EC 的偏移（仅年）的本地环境替用表示。

%Y
%EY	按十进制数写年。若结果少于四位，则左填充 0 到四位。
修饰的命令 %EY 写本地环境的替用完整年表示。

月
%b
%h	写本地环境的缩写月名。
%B	写本地环境的完整月名。
%m
%Om	按十进制数写月份（一月为 01 ）。若结果为单个数位，则前附 0 。
修饰的命令 %Om 写本地环境的替用表示。

日
%d
%Od	按十进制数写月之日。若结果为单个十进制位，则前附 0 。
修饰的命令 %Od 写本地环境的替用表示。

%e
%Oe	按十进制数写月之日。若结果为单个十进制位，则前附空格。
修饰的命令 %Oe 写本地环境的替用表示。

星期之日
%a	写本地环境的缩写星期名。
%A	写本地环境的完整星期名。
%u
%Ou	按十进制数写 ISO 星期之日（ 1-7 ），其中星期一为 1 。
修饰的命令 %Ou 写本地环境的替用表示。

%w
%Ow	写星期之日为十进制数（ 0-6 ），其中星期日为 0 。
修饰的命令 %Ow 写本地环境的替用表示。

基于 ISO 8601 星期的年
ISO 8601 星期始于星期一而年的第一星期必须满足下列要求：

包含 1 月 4 日
包含该年的首个星期四
%g	写基于 ISO 8601 星期的年的后二位十进制数。若结果为单个数位，则前附 0 。
%G	按十进制数写基于 ISO 8601 星期的年。若结果少于四位，则左填充 0 到四位。
%V
%OV	按十进制数年的 ISO 8601 星期。若结果为单个数位，则前附 0 。
修饰的命令 %OV 写本地环境的替用表示。

年之星期/日
%j	按十进制数写年的日（ 1 月 1 日为 001 ）。若结果少于三位，则左填充 0 到三位。
%U
%OU	按十进制数写年的星期数。该年的首个星期日为 01 星期的首日。同年中之前的日在 00 星期中。若结果为单个数位，则前附 0 。
修饰的命令 %OU 写本地环境的替用表示。

%W
%OW	按十进制数写年的星期数。该年的首个星期一为 01 星期的首日。同年中之前的日在 00 星期中。若结果为单个数位，则前附 0 。
修饰的命令 %OW 写本地环境的替用表示。

日期
%D	等价于 "%m/%d/%y" 。
%F	等价于 "%Y-%m-%d" 。
%x
%Ex	写本地环境的日期表示。
修饰的命令 %Ex 产生本地环境的替用日期表示。

杂项
%c
%Ec	写本地环境的日期与时间表示。
修饰的命令 %Ec 写本地环境的替用日期与时间表示。

%z
%Ez
%Oz	以 ISO 8601 格式写自 UTC 的偏移。例如 -0430 表示 UTC 后 4 小时 30 分。若偏移为 0 ，则使用 +0000 。
修饰的命令 %Ez 与 %Oz 在时与分间插入 : （例如 -04:30 ）。

%Z	写时区缩写。
*/

//日期时间处理, date time
private:
subroutine dtCreate() system library "pbidea.dll" alias for "dtCreate"
subroutine dtDestroy() system library "pbidea.dll" alias for "dtDestroy"

public:
//判断有效，check isvalid
function boolean ok() system library "pbidea.dll" alias for "dtOK"
//取现在时间, get now datetime
function datetime now() system library "pbidea.dll" alias for "dtNow"

/*
截断日期,unit: 
"y": year, "m": month, "d": day, "h": hour, "M": minute
example: "2023/05/18 12:2:4"
truncate("h")->"2023/05/18 12:0:0"
truncate("d")->"2023/05/18 0:0:0"
truncate("m")->"2023/05/01 0:0:0"
truncate("y")->"2023/01/01 0:0:0"
*/
function uo_datetime truncate(readonly string unit) system library "pbidea.dll" alias for "dtTruncate"

/*
增加或减少相应值, increase or decrease the corresponding value
example: "2023/05/18 12:2:4"
add("y", 2)  ->  "2025/05/18 12:2:4"
add("m", 20) -> "2025/01/18 12:2:4"
add("d", 2)  -> "2023/01/20 12:2:4"
*/
function uo_datetime add(readonly string unit, long value) system library "pbidea.dll" alias for "dtAdd"

/*
不同日期之间的时间差， difference between two dates
example: this:"2023/05/18 12:2:4"， other:"2022/05/18 12:2:4"
diff("y", other) -> 1
diff("m", other) -> 12
diff("d", other) -> 365
*/
function long diff(readonly string unit, uo_datetime other) system library "pbidea.dll" alias for "dtDiff"

//get timestamp
function longlong timestamp(boolean millsecond) system library "pbidea.dll" alias for "dtTimestamp"

//格式化日期，format datetime
function string format(readonly string fmt) system library "pbidea.dll" alias for "dtFormat"

//设置初始值, set init value
function datetime Set(longlong timestamp, boolean millsecond) system library "pbidea.dll" alias for "dtSet"
function datetime Set(date vdate) system library "pbidea.dll" alias for "dtSet"
function datetime Set(time vtime) system library "pbidea.dll" alias for "dtSet"
function datetime Set(datetime vdatetime) system library "pbidea.dll" alias for "dtSet"
//设置初始值, set init value, example:set("2023/05/18 12:2:4")
function datetime Set(readonly string as_datetime) system library "pbidea.dll" alias for "dtSet"
//设置初始值, set init value, example:set("2023/05/18 12:2:4", "%F %T")
function datetime Set(readonly string as_datetime, readonly string strFormat) system library "pbidea.dll" alias for "dtSet"

//get pb type value
function datetime datetime() system library "pbidea.dll" alias for "dtDatetime"
function date date() system library "pbidea.dll" alias for "dtDate"
function time time() system library "pbidea.dll" alias for "dtTime"
function int year() system library "pbidea.dll" alias for "dtYear"
function int month() system library "pbidea.dll" alias for "dtMonth"
function int day() system library "pbidea.dll" alias for "dtDay"
//days in year
function int yday() system library "pbidea.dll" alias for "dtYDay"
function int hour() system library "pbidea.dll" alias for "dtHour"
function int minute() system library "pbidea.dll" alias for "dtMinute"
function int second() system library "pbidea.dll" alias for "dtSecond"
//millisecond
function int msecond() system library "pbidea.dll" alias for "dtMillsecond"
function int week() system library "pbidea.dll" alias for "dtWeek"
//return format info
subroutine info(uo_json json) system library "pbidea.dll" alias for "dtInfo"

//当前月最后一天,last day in month
function uo_datetime MLastDay() system library "pbidea.dll" alias for "dtMLastDay"

/*
设置时区,设置一次全局有效，偶尔使用后要记得改回来，set time zone,
example: 
SetGMT("GMT-8") china
SetGMT("GMT-0") UTC
SetGMT("GMT+10") 
*/
function boolean SetGMT(readonly string gmt) system library "pbidea.dll" alias for "dtSetGMT"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dbf" id="uo_dbf">uo_dbf</a></div>
<pre><code>
//cn:dbf数据表读取和生成
//en:Dbf data table reading and generation

//uo_json 字段字义为一个数组，每个子项分别是 name,type(C D N 型),length,decimal
function boolean CreateDBF(readonly string dbfName, uo_json fields) system library "PbIdea.dll" alias for "dbfCreateDBF"
//关闭数据库
subroutine CloseDBF() system library "PbIdea.dll" alias for "dbfCloseDBF"
//追加一行 ,实际数据不会写进DBF,除非执行 CommitRecord,fillSpace 默认为false
function boolean AppendRecord() system library "PbIdea.dll" alias for "dbfAppendRecord"
function boolean AppendRecord(boolean fillSpace) system library "PbIdea.dll" alias for "dbfAppendRecord"
//对空行设置字段值
function boolean SetField(int field,readonly string value) system library "PbIdea.dll" alias for "dbfSetField"
function boolean SetField(readonly string field,readonly string value) system library "PbIdea.dll" alias for "dbfSetField"
//提交追加行
function long CommitRecord() system library "PbIdea.dll" alias for "dbfCommitRecord"
//dbf 导出为 json
function boolean dbf2json(readonly string dbfname,ref uo_json js,boolean lineno) system library "PbIdea.dll" alias for "dbf2json"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dib" id="uo_dib">uo_dib</a></div>
<pre><code>
//dib 图像数据处理,方便图片复制、剪切、转换、缩放等

//打开图像文件
function boolean open(readonly string file) system library "pbidea.dll" alias for "dibOpen"
function boolean open(readonly string file, int width, int height) system library "pbidea.dll" alias for "dibOpen"
//打开图像数据
function boolean open(readonly blob   data) system library "pbidea.dll" alias for "dibOpen"
function boolean open(readonly blob   data, int width, int height) system library "pbidea.dll" alias for "dibOpen"
//判断是否打开状态
function boolean IsOpen() system library "pbidea.dll" alias for "dibIsOpen"
//关闭，销毁数据，释放资源
subroutine close() system library "pbidea.dll" alias for "dibClose"
//创建一个空白图
function boolean create(long width, long height, int bits) system library "pbidea.dll" alias for "dibCreate"
function boolean create(long width, long height, int bits, long clrBack) system library "pbidea.dll" alias for "dibCreate"
function boolean create(long width, long height, int bits, long clrBack, int alpha) system library "pbidea.dll" alias for "dibCreate"
//以指定背景清除图片，是32位，指定透明生效 , alpha取值范围 : 0-255 ，0全透明，255全不透明
subroutine clear(long backcolor) system library "pbidea.dll" alias for "dibClear"
subroutine clear(long backcolor, int alpha) system library "pbidea.dll" alias for "dibClear"
//写blob入文件
function boolean WriteFile(readonly blob data, readonly string file) system library "pbidea.dll" alias for "dibWriteFile"
//取不同格式图片文件数据
function blob bmp()  system library "pbidea.dll" alias for "dibBmp"
//当图片是32位时，指定透明为指定颜色
function blob bmp(long backcolor)  system library "pbidea.dll" alias for "dibBmp"
function blob jpg()  system library "pbidea.dll" alias for "dibJpg"
function blob jpeg() system library "pbidea.dll" alias for "dibJpg"
//压缩质量，默认为75
function blob jpeg(int quality) system library "pbidea.dll" alias for "dibJpg"
function blob png()  system library "pbidea.dll" alias for "dibPng"
//图片相关信息
function ulong ptr()  system library "pbidea.dll" alias for "dibPtr"
function long size()  system library "pbidea.dll" alias for "dibSize"
function long width()  system library "pbidea.dll" alias for "dibWidth"
function long height()  system library "pbidea.dll" alias for "dibHeight"
function long bitcount()  system library "pbidea.dll" alias for "dibBitcount"
function long stride()  system library "pbidea.dll" alias for "dibStride"
//上下换位
subroutine flip() system library "pbidea.dll" alias for "dibFlip"
//左右换位
subroutine mirror() system library "pbidea.dll" alias for "dibMirror"
//R与B像素互换, RGB - BGR
subroutine SwitchRB() system library "pbidea.dll" alias for "dibSwitchRB"
//颜色取反
subroutine inverse() system library "pbidea.dll" alias for "dibInverse"
//二值化
function uo_dib otsu() system library "pbidea.dll" alias for "dibotsu"
//局部复制
function uo_dib copy(long x, long y, long width, long height) system library "pbidea.dll" alias for "dibCopy"
//取绘制使用的 hdc hbitmap
function ulong hdc() system library "pbidea.dll" alias for "dibHDC"
function ulong hbitmap() system library "pbidea.dll" alias for "dibHBitmap"
//绘制
function boolean paint(ulong hdc, int x, int y) system library "pbidea.dll" alias for "dibPaint"
function boolean paint(ulong hdc, int x, int y, int width, int height) system library "pbidea.dll" alias for "dibPaint"
//抓图
function boolean grab(ulong hwnd) system library "pbidea.dll" alias for "dibGrab"
//抓 dw ，使用了特殊方法，与直接抓屏有区别
function boolean grab(datawindow dw) system library "pbidea.dll" alias for "dibGrab"
//生成8位(256色灰度)图
function uo_dib gray() system library "pbidea.dll" alias for "dibGray"
//转换位数,例如  1 8 16 24 32, 当前是 32位时，param 要指定背景颜色
function uo_dib convert(int toBitCount) system library "pbidea.dll" alias for "dibConvert"
function uo_dib convert(int toBitCount, long param) system library "pbidea.dll" alias for "dibConvert"
//缩放, scale是整小数的比例，1.0为原大小. 仅支持 32/24/8/1位
function uo_dib zoom(int newwidth, int newheight) system library "pbidea.dll" alias for "dibZoom"
function uo_dib zoom(double scale ) system library "pbidea.dll" alias for "dibZoom"
//设置某点像素值, 24/32位有效
subroutine pixel(int x, int y, ulong clr) system library "pbidea.dll" alias for "dibPixel"
//取某点像素值, 24/32位有效
function ulong pixel(int x, int y) system library "pbidea.dll" alias for "dibPixel"
//画线
subroutine line(int x1, int y1, int x2, int y2, ulong clr) system library "pbidea.dll" alias for "dibLine"
subroutine line(int x1, int y1, int x2, int y2, ulong clr, int style) system library "pbidea.dll" alias for "dibLine"
//文本
subroutine DrawText(int x1, int y1, int x2, int y2, readonly string text) system library "pbidea.dll" alias for "dibText"
//设置字体 , 设置用完后，记得 ReleaseFont
function ulong SetFont(readonly string fontFace, int fontSize, boolean bold, boolean italic) system library "pbidea.dll" alias for "dibSetFont"
//释放字体
subroutine ReleaseFont(ulong fontID) system library "pbidea.dll" alias for "dibReleaseFont"
//画图
subroutine DrawImage(readonly string svg, int x, int y, int width, int height) system library "pbidea.dll" alias for "dibDrawImage"
subroutine DrawImage(uo_dib dib,          int x, int y, int width, int height) system library "pbidea.dll" alias for "dibDrawImage"
subroutine DrawImage(readonly blob data,  int x, int y, int width, int height) system library "pbidea.dll" alias for "dibDrawImage"
//另存为 .ico 文件,来源必须是 png,wmf,svg，32位，有透明
function boolean SaveIcon(readonly string iconFile) system library "pbidea.dll" alias for "dibSaveIcon"
//替换颜色
subroutine Replace(long clrFrom, ulong clrTo, double offset) system library "pbidea.dll" alias for "dibReplace"
//如果是32位透明图，去掉透明部分，可以缩小体量
function uo_dib clip(ref boolean succ) system library "pbidea.dll" alias for "dibClip"
//获取颜色总数
function long ColorCount() system library "pbidea.dll" alias for "dibGetColorCount"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dicom" id="uo_dicom">uo_dicom</a></div>
<pre><code>
//dicom

function boolean Open(readonly string file) system library "pbidea.dll" alias for "dcmOpen"
subroutine Close() system library "pbidea.dll" alias for "dcmClose"
function boolean ReadInfo(uo_json json) system library "pbidea.dll" alias for "dcmReadInfo"
function int GetFrameCount() system library "pbidea.dll" alias for "dcmGetFrameCount"
function uo_dib GetFrameImage(int frame) system library "pbidea.dll" alias for "dcmGetFrameImage"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dir" id="uo_dir">uo_dir</a></div>
<pre><code>
//目录操作

constant int FILE_TIME_CREATE = 1
constant int FILE_TIME_ACCESS = 2
constant int FILE_TIME_WRITE  = 3

//返回指定文件或目录所在驱动器
function string driver(readonly string fileOrDir) system library "pbidea.dll" alias for "dirDriver"
//返回当前目录, 同 GetCurrentDirectory
function string cd() system library "pbidea.dll" alias for "dirCD"
//改变当前目录，同 ChangeDirectory
function boolean cd(readonly string dir) system library "pbidea.dll" alias for "dirCD"
//建立目录，支持多级
function boolean md(readonly string dir) system library "pbidea.dll" alias for "dirMD"
//删除目录及目录下文件，支持多级
function boolean rd(readonly string dir) system library "pbidea.dll" alias for "dirRD"
//移动文件
function boolean mv(readonly string srcFile, readonly string dstFile) system library "pbidea.dll" alias for "dirMV"
//取指定目录下的文件列表
function int files(readonly string dir, readonly string filter, ref string files[]) system library "pbidea.dll" alias for "dirFiles"
//取当前目录下的文件列表
function int files(readonly string filter, ref string files[]) system library "pbidea.dll" alias for "dirFiles"
//取指定目录下的目录列表
function int dirs(readonly string dir, ref string dirs[]) system library "pbidea.dll" alias for "dirDirs"
//取当前目录下的目录列表
function int dirs(ref string dirs[]) system library "pbidea.dll" alias for "dirDirs"
//删除指定文件
function boolean del(readonly string file) system library "pbidea.dll" alias for "dirDel"
//判断文件是否存在
function boolean exist(readonly string file) system library "pbidea.dll" alias for "dirExist"
//取文件时间
function datetime GetTime(readonly string file, int timeType) system library "pbidea.dll" alias for "dirGetTime"
//设置文件时间
function boolean SetTime(readonly string file, int timeType, datetime fileTime) system library "pbidea.dll" alias for "dirSetTime"
//设置文件时间,  所有属性
function boolean SetTime(readonly string file, datetime fileTime) system library "pbidea.dll" alias for "dirSetTime"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dir_watcher" id="uo_dir_watcher">uo_dir_watcher</a></div>
<pre><code>
//cn:监控文件目录变化情况,用事件通知应用程序
//en:Monitor file directory changes and notify applications with events
public:
constant int ACT_ADDED    = 1
constant int ACT_REMOVED  = 2
constant int ACT_MODIFIED = 4
constant int ACT_RENAMED  = 8

private:
ulong il_handle = 0

private:
//开始监控
function ulong CreateDirectoryWatcher(readonly string dirName) system library "PbIdea.dll" alias for "CreateDirectoryWatcher"
//停止监控
subroutine DestroyDirectoryWatcher(ulong h)  system library "PbIdea.dll" alias for "DestroyDirectoryWatcher"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dll" id="uo_dll">uo_dll</a></div>
<pre><code>
//cn:调用外部 dll 函数,比PB自带功能更加强大，支持回调和cdecl约定
//en:Calling external dll functions is more powerful than the built-in functions of PB, and supports callback and cdecl conventions

//调用约定
constant int CDECL   = 1
constant int STDCALL = 2

//编码方式
constant int ANSI    = 1
constant int UNICODE = 2

//参数类型
constant int  NO_TYPE       = 0
constant int  INT_TYPE      = 1
constant int  LONG_TYPE     = 2
constant int  FLOAT_TYPE    = 3
constant int  DOUBLE_TYPE   = 4
constant int  DEC_TYPE      = 5
constant int  STRING_TYPE   = 6
constant int  BOOL_TYPE     = 7
constant int  ANY_TYPE      = 8
constant int  UINT_TYPE     = 9
constant int  ULONG_TYPE    = 10
constant int  BINARY_TYPE   = 11
constant int  DATE_TYPE     = 12
constant int  TIME_TYPE     = 13
constant int  DATETIME_TYPE = 14
constant int  LONGLONG_TYPE = 20

//取函数列表
function int LoadFunctionList(readonly string dllName,ref string funcNameList[]) system library "pbidea.dll" alias for "funcLoadFunctionList"
function int LoadFunctionList(readonly string dllName,ref string funcNameList[],ref string addr[]) system library "pbidea.dll" alias for "funcLoadFunctionList"
//加载DLL函数，mode：1 CDECL 2 STDCALL，默认为2
function boolean LoadFunction(readonly string dllName,readonly string funcName,int mode) system library "pbidea.dll" alias for "funcLoadFunction"
//释放函数
subroutine FreeFunction() system library "pbidea.dll" alias for "funcFreeFunction"
//添加参数,实现时，参数类型要准确
function boolean PushArg(readonly boolean  value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly char     value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly int      value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly uint     value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly long     value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly ulong    value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly longlong value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly real     value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly decimal  value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly double   value) system library "pbidea.dll" alias for "funcPushArg"
//字符编码 charset: 0 默认当前编码，1 转ansi 编码，2 转unicode 编码
function boolean PushArg(readonly string   value) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly string   value, int charset) system library "pbidea.dll" alias for "funcPushArg"
function boolean PushArg(readonly blob     value) system library "pbidea.dll" alias for "funcPushArg"
//添加引用参数，返回分配的内存地址
function ulong   PushRefArg(long bufferSize) system library "pbidea.dll" alias for "funcPushRefArg"
//调用函数
function boolean Invoke(ref boolean  returnValue) system library "pbidea.dll" alias for "funcInvoke"
function boolean Invoke(ref int      returnValue) system library "pbidea.dll" alias for "funcInvoke"
function boolean Invoke(ref long     returnValue) system library "pbidea.dll" alias for "funcInvoke"
function boolean Invoke(ref longlong returnValue) system library "pbidea.dll" alias for "funcInvoke"
function boolean Invoke(ref real     returnValue) system library "pbidea.dll" alias for "funcInvoke"
function boolean Invoke(ref double   returnValue) system library "pbidea.dll" alias for "funcInvoke"

//创建回调,mode：1 CDECL 2 STDCALL，默认为2. returnType 为返回类型。
//返回 标地号，其他相关 callback类函数使用此ID.
function int CreateCallback(int mode,int returnType) system library "pbidea.dll" alias for "funcCreateCallback"
//添加回调参数
function boolean PushCallbackArg(int callback) system library "pbidea.dll" alias for "funcPushCallbackArg"
//给回调添加参数类型,具体 类型参考声明
function boolean PushCallbackArgType(int callback,int argType) system library "pbidea.dll" alias for "funcPushCallbackArgType"
//将回调与事件进行绑定
function boolean BindCallbackEvent(int callback,powerobject obj,readonly string eventname) system library "pbidea.dll" alias for "funcBindCallbackEvent"

//给指定回调敲个钟，让回调线程继续 
//************* 此函数已废弃 *******************
subroutine Duang(int callback) system library "pbidea.dll" alias for "funcDuang"

//分配内存
function ulong AllocMemory(long sizeOfMemory) system library "pbidea.dll" alias for "funcAllocMemory"
//释放内存
subroutine FreeMemory(ulong mem) system library "pbidea.dll" alias for "funcFreeMemory"
//读指定大小的内存块
function blob ReadMemory(ulong mem, long len) system library "pbidea.dll" alias for "funcReadMemory"
//读内存字符串，自动转码
function string ReadString(ulong mem) system library "pbidea.dll" alias for "funcReadString"
//读 ansi 编码内存字符串，自动转码
function string ReadAnsiString(ulong mem) system library "pbidea.dll" alias for "funcReadAnsiString"
//读 unicode 编码内存字符串,自动转码
function string ReadUnicodeString(ulong mem) system library "pbidea.dll" alias for "funcReadUnicodeString"
//读 utf8 编码内存字符串,自动转码
function string ReadUtf8String(ulong mem) system library "pbidea.dll" alias for "funcReadUtf8String"
//读一个 int 
function int ReadInt(ulong mem) system library "pbidea.dll" alias for "funcReadInt"
//读一个 long
function long ReadLong(ulong mem) system library "pbidea.dll" alias for "funcReadLong"
//复制内存块, 注意，此函数参数可以根据需要，任意改变 !!!
subroutine CopyMemory(ulong dst,ulong src,long size) library "pbidea.dll" alias for "funcCopyMemory"
subroutine CopyMemory(ref blob dst,ulong src,long size) library "pbidea.dll" alias for "funcCopyMemory"
subroutine CopyMemory(ulong dst, ref blob src,long size) library "pbidea.dll" alias for "funcCopyMemory"
subroutine CopyMemory(ref blob dst, ref blob src,long size) library "pbidea.dll" alias for "funcCopyMemory"

//工具函数
//将一个数值转成十六进制，例如 Hex(65,4) 得到 "0041"
function string Hex(ulong val) system library "pbidea.dll" alias for "Hex"
function string Hex(ulong val, int nLen) system library "pbidea.dll" alias for "Hex"
function ulong  HexToDec(readonly string hex) system library "pbidea.dll" alias for "HexToDec"
function string DecToHex(ulong val) system library "pbidea.dll" alias for "DecToHex"
function string DecToHex(longlong val) system library "pbidea.dll" alias for "DecToHex"
//取变量地址，PB无此函数
function ulong AddressOf (ref blob source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref string source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref long source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref ulong source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref int source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref date source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref datetime source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref boolean source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref real source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref decimal source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref longlong source) system library "pbidea.dll" alias for "AddressOf"
function ulong AddressOf (ref character source) system library "pbidea.dll" alias for "AddressOf"
//获取空间大小，类似于C语言的 sizeof 
function int SizeOf (readonly any source) system library "pbidea.dll" alias for "SizeOf"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dns" id="uo_dns">uo_dns</a></div>
<pre><code>
//dns

//get ip from domain
function string GetIp(readonly string domain) system library "pbidea.dll" alias for "dnsGetIpFromDomain"
//get domain  from ip
function string GetDomain(readonly string ip) system library "pbidea.dll" alias for "dnsGetDomainFromIp"
//parse url
function boolean ParseUrl(readonly string url, ref string protocol, ref string host, ref string ip, ref uint port) system library "pbidea.dll" alias for "dnsParseUrl"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_dragfile" id="uo_dragfile">uo_dragfile</a></div>
<pre><code>
//支持文件拖入
//将此控件拖放到某窗口，此窗口就支持文件拖入，具体响应本控件的on_file_drag 事件即可
//一个窗口最多只支持一个拖放控件

subroutine dragCreate() system library "pbidea.dll" alias for "dragCreate"
subroutine dragDestroy() system library "pbidea.dll" alias for "dragDestroy"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_eventlog" id="uo_eventlog">uo_eventlog</a></div>
<pre><code>
//根据日志名称，读取相应日志
/*Windows 日志：
	应用/应用程序/Application
	安全/Security
	安装/Setup
	系统/System
	或其他自定义


"30" 开机
“6005”表示“事件日志服务已启动”电脑开机
“6006”表示“事件日志服务已停止”电脑关机
“6008”表示蓝屏重启的错误事件
“41” 表示非正常关机的， 一般是掉电或者直接按电源键强制关机

*/

/*
关机重启事件
事件ID	描述	Description
30	固件报告了启动指标。	
41	系统在没有彻底关闭的情况下重新启动。	The system has rebooted without cleanly shutting down first.
1074	系统被某个用户或进程正常关闭。	The system has been shutdown properly by a user or process.
1076	紧随事件ID 6008之后，表示在意外重启或关机后第一个拥有关机权限的用户登录到服务器并指定原因。	Follows after Event ID 6008 and means that the first user with shutdown privileges logged on to the server after an unexpected restart or shutdown and specified the cause.
6005	事件日志服务已启动。表示系统启动。	The Event Log service was started. Indicates the system startup.
6006	事件日志服务已停止。表示系统正常关闭。	The Event Log service was stopped. Indicates the proper system shutdown.
6008	上次系统关闭是意外的。	The previous system shutdown was unexpected.
6009	系统启动时检测到的操作系统版本。	The operating system version detected at the system startup.
6013	系统正常运行时间，以秒为单位。	The system uptime in seconds.
7002	客户体验改善计划的用户注销通知。	
*/

//根据日志名称，读取相应日志
/*Windows 日志：
	应用/应用程序/Application
	安全/Security
	安装/Setup
	系统/System
	或其他自定义
*/
function boolean EventLogToJson(readonly string name, uo_json jsLog) system library "pbidea.dll" alias for "elEventLogToJson"
function boolean EventLogToJson(readonly string name, uo_json jsLog, int filter_id) system library "pbidea.dll" alias for "elEventLogToJson"
function boolean EventLogToJson(readonly string name, uo_json jsLog, int filter_ids[]) system library "pbidea.dll" alias for "elEventLogToJson"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_file" id="uo_file">uo_file</a></div>
<pre><code>
//cn:增强的文件操作功能
//en:Enhanced file manipulation

//查找文件列表
function long FindFile(readonly string strDir,readonly string strExt,boolean bSubDir,ref string files[]) system library "PbIdea.dll" alias for "FindFile"

//文件读出来为BLOB，BLOB写入文件
function blob BlobFromFile(readonly string strFileName) system library "PbIdea.dll" alias for "BlobFromFile"
function boolean BlobToFile(readonly blob data,readonly string strFileName) system library "PbIdea.dll" alias for "BlobToFile"

//从文本文件读出来，返回字符串，会自动进行编码转换
function string StringFromTextFile(readonly string strFileName) system library "PbIdea.dll" alias for "StringFromTextFile"
function boolean StringToTextFile(readonly string str, readonly string strFileName,boolean utf8) system library "PbIdea.dll" alias for "StringToTextFile"

//将当前目录添加到PATH环境变量中去，addSubPath参数标记是否将当前目录的子目录也一同添加到PATH环境变量中去
//省略号，表示可选的其他目录，字符型 
subroutine AddAppPathToEnv(boolean addSubPath,...) system library "PbIdea.dll" alias for "AddAppPathToEnv"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//获取剪切板上的文件列表
function string GetClipBoardFileList() system library "PbIdea.dll" alias for "GetClipBoardFileList"
//把文件列表复制到剪切板上
function boolean SetClipBoardFileList(readonly string files[]) system library "PbIdea.dll" alias for "SetClipBoardFileList"

//将一个大文本文件拆分成小文件,文件编码可以是ansi或utf8,2个参数:文件名，拆分的文件大小（单位M），返回拆分的文件个数
function int SplitTextFile(readonly string strTextFile,int nFileSize) system library "PbIdea.dll" alias for "SplitTextFile"

//加密文件
function boolean EncryptoFile(readonly string SrcFile,readonly string DstFile,readonly string key) system library "PbIdea.dll" alias for "EncryptoFile"
function boolean EncryptoFile(readonly string SrcFile,readonly string DstFile,readonly string key,boolean compress) system library "PbIdea.dll" alias for "EncryptoFile"
//解密文件
function boolean DecryptoFile(readonly string SrcFile,readonly string DstFile,readonly string key) system library "PbIdea.dll" alias for "DecryptoFile"
//直接读取加密文件，返回blob
function blob EncryptoFileRead(readonly string SrcFile,readonly string DstFile,readonly string key) system library "PbIdea.dll" alias for "EncryptoFileRead"

//标准拆分函数，可供VB使用
//function long stdSplitTextFile(string lpFile, long sizeM,ulong cb) library "PbIdea.dll" alias for "stdSplitTextFile"

//新增打开和保存文件对话框。声明为全局函数，就可以直接替换掉PB自带原生丑陋的对话框
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename) system library "pbidea.dll" alias for "fileGetFileOpenName"
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename[]) system library "pbidea.dll" alias for "fileGetFileOpenName"
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename ,readonly string extension) system library "pbidea.dll" alias for "fileGetFileOpenName"
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename[] ,readonly string extension) system library "pbidea.dll" alias for "fileGetFileOpenName"
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename ,readonly string extension ,readonly string initdir) system library "pbidea.dll" alias for "fileGetFileOpenName"
function int GetFileOpenName(readonly string title,ref string pathname, ref string filename[] ,readonly string extension ,readonly string initdir) system library "pbidea.dll" alias for "fileGetFileOpenName"

function int GetFileSaveName(readonly string title,ref string pathname, ref string filename) system library "pbidea.dll" alias for "fileGetFileSaveName"
function int GetFileSaveName(readonly string title,ref string pathname, ref string filename[]) system library "pbidea.dll" alias for "fileGetFileSaveName"
function int GetFileSaveName(readonly string title,ref string pathname, ref string filename ,readonly string extension) system library "pbidea.dll" alias for "fileGetFileSaveName"
function int GetFileSaveName(readonly string title,ref string pathname, ref string filename[] ,readonly string extension) system library "pbidea.dll" alias for "fileGetFileSaveName"
function int GetFileSaveName(readonly string title,ref string pathname, ref string filename ,readonly string extension ,readonly string initdir) system library "pbidea.dll" alias for "fileGetFileSaveName"
function int GetFileSaveName(readonly string title,ref string pathname, ref string filename[] ,readonly string extension ,readonly string initdir) system library "pbidea.dll" alias for "fileGetFileSaveName"

//查询哪些文件处于打开状态，以及被哪个进程打开
function long QueryFileLocker(uo_json json) system library "pbidea.dll" alias for "QueryFileLocker" //返回所有
//exeName返回进程，返回值指明其进程号(在任务管理器里可以看见)
function long QueryFileLocker(readonly string fileName, ref string exeName) system library "pbidea.dll" alias for "QueryFileLocker"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_font" id="uo_font">uo_font</a></div>
<pre><code>
//cn:字体管理
//en:Font management

constant int SUBSET  = 0
constant int SUBSET1 = 1
constant int DELTA   = 2

//安装字体，不管是文件，还是字体在PBD资源里，都会自动被安装
function int InstallFont(readonly string fontFile) system library "PbIdea.dll" alias for "fontInstallFont"
//安装字体,blob数据的字体文件
function int InstallFont(readonly blob fontData) system library "PbIdea.dll" alias for "fontInstallFont"
//根据指定文本和指定已安装字体生成子字体
function blob MakeFont(readonly string fontName, readonly string text) system library "PbIdea.dll" alias for "fontMakeFont"
function blob MakeFont(readonly string fontName, readonly string text, int mode) system library "PbIdea.dll" alias for "fontMakeFont"
//根据指定文本和指定字体文件生成子字体
function blob MakeFontByFile(readonly string fontFile, readonly string text) system library "PbIdea.dll" alias for "fontMakeFontByFile"
function blob MakeFontByFile(readonly string fontFile, readonly string text, int mode) system library "PbIdea.dll" alias for "fontMakeFontByFile"
//对由 MakeFont 生成的字体内容进行合并，生成 src 时 allow_embed 必须指定为 true, dst allow_embed 必须指定为false, 返回合并后的字体数据
function blob MergeFont(readonly blob dst, int mode) system library "PbIdea.dll" alias for "fontMergeFont"
function blob MergeFont(readonly blob dst, readonly blob src) system library "PbIdea.dll" alias for "fontMergeFont"
//压缩字体数据，去除空字符
function blob CompressFont(readonly blob font_data) system library "PbIdea.dll" alias for "fontCompressFont"
//获取系统已安装字体列表
function int GetFontList(ref string fontNames[]) system library "PbIdea.dll" alias for "fontGetFontList"
//获取某字体中的所有unicode编码
function long GetCharList(readonly blob fontData, ref long chars[]) system library "PbIdea.dll" alias for "fontGetCharList"
function long GetCharList(readonly blob fontData, ref long chars[], ref string ch[]) system library "PbIdea.dll" alias for "fontGetCharList"
//返回unicode码对应的字符
function string GetCharByUnicode(long unicode) system library "PbIdea.dll" alias for "fontGetCharByUnicode"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_ftp" id="uo_ftp">uo_ftp</a></div>
<pre><code>
//cn:FTP客户端
//en:FTP client

//私有函数,初始化和销毁对象,对象内部使用
private:
//创建ftp对象
function ulong ftpCreate() system library "PbIdea.dll" alias for "ftpCreate"
//销毁ftp对象
subroutine ftpDestroy() system library "PbIdea.dll" alias for "ftpDestroy"

public:
//打开调试输出
subroutine ftpSetDebug(boolean bDebug) system library "PbIdea.dll" alias for "ftpSetDebug"
//连接与断开
function boolean ftpConnect(readonly string host,int port,readonly string username,readonly string passwd) system library "PbIdea.dll" alias for "ftpConnect"
//timeout 毫秒, 1000为一秒, 默认为5000
function boolean ftpConnect(readonly string host,int port,readonly string username,readonly string passwd, long timeout) system library "PbIdea.dll" alias for "ftpConnect"
//断开
subroutine ftpDisconnect() system library "PbIdea.dll" alias for "ftpDisconnect"
//服务端类型 0 未知， 1 UNIX ， 2 WINDOWS
function int ftpSystemType() system library "PbIdea.dll" alias for "ftpSystemType"
//判断连接状态
function boolean ftpIsConnected() system library "PbIdea.dll" alias for "ftpIsConnected"
//进入指定目录
function boolean ftpCD(readonly string dir) system library "PbIdea.dll" alias for "ftpCD"
//进入上级目录
function boolean ftpCDUP() system library "PbIdea.dll" alias for "ftpCDUP"
//显示当前目录文件列表明细
function long ftpDir(ref string files[]) system library "PbIdea.dll" alias for "ftpDir"
//显示当前目录文件列表摘要
function long ftpList(ref string files[]) system library "PbIdea.dll" alias for "ftpList"
//下载文件
function boolean ftpGet(readonly string file) system library "PbIdea.dll" alias for "ftpGet"
function boolean ftpGet(readonly string savefile,readonly string remoteFile) system library "PbIdea.dll" alias for "ftpGet"
function boolean ftpGet(readonly string savefile,readonly string remoteFile,boolean openfile) system library "PbIdea.dll" alias for "ftpGet"
//上传文件
function boolean ftpPut(readonly string file,boolean bProgressEvent) system library "PbIdea.dll" alias for "ftpPut"
function boolean ftpPut(readonly string localfile,readonly string remotefile,boolean bProgressEvent) system library "PbIdea.dll" alias for "ftpPut"
//直接打开FTP服务上的文件，如何进行了修改，会自动同步上传
function boolean ftpShellExecute(string file) system library "PbIdea.dll" alias for "ftpShellExecute"
//删除文件
function boolean ftpDelete(readonly string file) system library "PbIdea.dll" alias for "ftpDelete"
//改名文件
function boolean ftpRename(readonly string oldfile,readonly string newfile) system library "PbIdea.dll" alias for "ftpRename"
//创建目录
function boolean ftpMkdir(readonly string dirName) system library "PbIdea.dll" alias for "ftpMkdir"
//删除目录
function boolean ftpRmDir(readonly string dirName) system library "PbIdea.dll" alias for "ftpRmDir"
//取当前目录
function string ftpGetDir() system library "PbIdea.dll" alias for "ftpGetDir"
//取文件大小
function ulong ftpSize(readonly string file) system library "PbIdea.dll" alias for "ftpSize"
//取文件修改时间
function string ftpDateTime(readonly string file) system library "PbIdea.dll" alias for "ftpDateTime"
//发送FTP命令
function boolean ftpSendCmd(readonly string cmd) system library "PbIdea.dll" alias for "ftpSendCmd"
//UTF8
subroutine ftpUTF8(boolean bUtf8) system library "PbIdea.dll" alias for "ftpUTF8"
//心跳包,每隔n秒发一个心跳，确保不被服务端踢出,seconds为0时关闭心跳
subroutine ftpHeartOpen(int seconds) system library "PbIdea.dll" alias for "ftpHeartOpen"

//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
function string GetFileIcon(readonly string strFile,ulong clrBack) system library "PbIdea.dll" alias for "GetFileIcon"
function int SplitFileInfo(readonly string strFileInfo,ref string fields[]) system library "PbIdea.dll" alias for "SplitFileInfo"

//调试输出,测试使用
function boolean Printf(readonly string strText) system library "PbIdea.dll" alias for "Printf"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_ftp_server" id="uo_ftp_server">uo_ftp_server</a></div>
<pre><code>
//cn:ftp 服务
//en:ftp server

//启动 ftp server
function boolean StartServer(uo_json config) system library "pbidea.dll" alias for "ftpStartServer"
/*
start ftp server, and bind event to powerobject.启动服务，并且绑定对象事件
eventObject: powerobject,example: w_demo or cb_1.parent() or uo_tabpage_ftserver
eventName: event name ,example: ue_ftp
this event define 6 params: 有6个参数:
int           code
string        ip
unsignedinter port
string        user
string        cmd
string        param
*/
function boolean StartServer(uo_json config, powerobject eventObject, string eventName) system library "pbidea.dll" alias for "ftpStartServer"

//停止 ftp server
function boolean StopServer() system library "pbidea.dll" alias for "ftpStopServer"

function boolean AddUser(uo_json users) system library "pbidea.dll" alias for "ftpAddUser"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_hardware" id="uo_hardware">uo_hardware</a></div>
<pre><code>
//cn:硬件有关功能,取硬件特征及其他
//en:Hardware related functions, including hardware features and others

//硬盘序列号
function string GetDiskSerial() system library "PbIdea.dll" alias for "hwDiskSerial"
//CPU序列号
function string GetCPUSerial() system library "PbIdea.dll" alias for "hwCPUSerial"
//IP
function string GetIP(ref string ips[],ref string gateways[]) system library "PbIdea.dll" alias for "hwGetIP"
function string GetIP(ref string ips[],ref string gateways[],ref string macs[]) system library "PbIdea.dll" alias for "hwGetIP"
function string GetIP(ref string ips[],ref string gateways[],ref string macs[],ref string ipv6[]) system library "PbIdea.dll" alias for "hwGetIP"
//公网IP
function string GetInternetIP() system library "PbIdea.dll" alias for "hwGetInternetIP"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_hook" id="uo_hook">uo_hook</a></div>
<pre><code>
//Abandonment

constant int FUNC_MESSAGE         = 1

//返回数据类型
CONSTANT int TYPE_NONE   = 0
CONSTANT int TYPE_INT    = 1
CONSTANT int TYPE_LONG   = 2
CONSTANT int TYPE_FLOAT  = 3
CONSTANT int TYPE_DOUBLE = 4
CONSTANT int TYPE_STRING = 6
CONSTANT int TYPE_BOOL   = 7
CONSTANT int TYPE_UINT   = 9
CONSTANT int TYPE_ULONG  = 10

public:
function boolean StartHook() system library "PbIdea.dll" alias for "hookStartHook"
function boolean StopHook() system library "PbIdea.dll" alias for "hookStopHook"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_htmlrender" id="uo_htmlrender">uo_htmlrender</a></div>
<pre><code>
//cn:基于 html 渲染
//en:Html based rendering

subroutine render(readonly string html_file) system library "pbidea.dll" alias for "htmlRender"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_httpclient" id="uo_httpclient">uo_httpclient</a></div>
<pre><code>
//cn:基于winhttp的http client
//en:Http client based on winhttp
uo_response response  //响应结果

//静态变量，require 函数的第一个参数 nHttpType 
constant int HttpGet      = 1
constant int HttpPost     = 2
constant int HttpPut      = 3
constant int HttpPatch    = 4
constant int HttpDelete   = 5
constant int HttpCopy     = 6
constant int HttpHead     = 7
constant int HttpOptions  = 8
constant int HttpLink     = 9
constant int HttpUplink   = 10
constant int HttpPurge    = 11
constant int HttpLock     = 12
constant int HttpUnlock   = 13
constant int HttpPropfind = 14
constant int HttpView     = 15

//SetOutputMode 输出模式
constant int ModeBuffer   = 1 //默认输出到内存
constant int ModeFile     = 2

//私有函数,初始化和销毁对象,对象内部使用
private:
//创建HttpClient对象
function ulong hcCreate() system library "PbIdea.dll" alias for "hcCreate"
function ulong hcCreate(readonly string responseName) system library "PbIdea.dll" alias for "hcCreate" //responseName 默认是 "uo_response"
//销毁HttpClient对象
subroutine hcDestroy() system library "PbIdea.dll" alias for "hcDestroy"

public:
//下载文件到指定目录,不指定目录时，下载到当前目录的.\download\下面
function boolean DownLoadFile(readonly string strUrl) system library "PbIdea.dll" alias for "DownLoadFile"
function boolean DownLoadFile(readonly string strUrl,readonly string strSavePath) system library "PbIdea.dll" alias for "DownLoadFile"
function boolean DownLoadFile(readonly string strUrl,readonly string strSavePath,boolean bTriggerEvent) system library "PbIdea.dll" alias for "DownLoadFile"

//下载文件到BLOB
function blob DownLoad(readonly string strUrl) system library "PbIdea.dll" alias for "DownLoad"
function blob DownLoad(readonly string strUrl,boolean bTriggerEvent) system library "PbIdea.dll" alias for "DownLoad"

//上传文件
function boolean UploadFile(readonly string strUrl,readonly string filename[],readonly string fieldName,readonly string toPath,boolean callback) system library "PbIdea.dll" alias for "UploadFile"

//设置 http Header
subroutine SetHeader(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "SetHeader"
subroutine SetHeader(readonly uo_map headers) system library "PbIdea.dll" alias for "SetHeader"
subroutine ClearHeader() system library "PbIdea.dll" alias for "ClearHeader"
//添加参数。这些参数会以连接时，自动被添加到URL后面，
//例如SetArgument("test","aaa") ,连接到 http://127.0.0.1时会自动生成 http://127.0.0.1?test=aaa
subroutine SetArgument(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetArgument(readonly string strKey,readonly string strValue,boolean urlencode) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetArgument(readonly string strKey,readonly string strValue,boolean urlencode,boolean toUTF8) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly string strKey,readonly string strValue,boolean urlencode) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly string strKey,readonly string strValue,boolean urlencode,boolean toUTF8) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly uo_map params) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly uo_map params,boolean urlencode) system library "PbIdea.dll" alias for "SetArgument"
subroutine SetParam(readonly uo_map params,boolean urlencode,boolean toUTF8) system library "PbIdea.dll" alias for "SetArgument"

subroutine ClearArgument() system library "PbIdea.dll" alias for "ClearArgument"
subroutine SetUserAgent(readonly string strUserAgent) system library "PbIdea.dll" alias for "SetUserAgent"

//FORM
subroutine SetForm(readonly string strKey,readonly string strValue) system library "PbIdea.dll" alias for "SetForm"
subroutine SetForm(readonly string strKey,readonly string strValue,readonly string strContentType) system library "PbIdea.dll" alias for "SetForm"
subroutine SetForm(readonly string strKey,readonly string strFile,boolean IsFile) system library "PbIdea.dll" alias for "SetForm"
subroutine SetForm(readonly string strKey,readonly string strFile,boolean IsFile,readonly string strContentType) system library "PbIdea.dll" alias for "SetForm"
subroutine SetForm(readonly string strKey,readonly blob data) system library "PbIdea.dll" alias for "SetForm"
subroutine SetForm(readonly string strKey,readonly blob data,readonly string strContentType) system library "PbIdea.dll" alias for "SetForm"

//basic auth
subroutine SetBasicAuth(string username,string password) system library "PbIdea.dll" alias for "SetBasicAuth"
//JWT验证
subroutine SetJWTAuth(string token) system library "PbIdea.dll" alias for "SetJWTAuth"

//设置代理 
subroutine SetProxy(string ip,int port)  system library "PbIdea.dll" alias for "SetProxy"

//设置超时，单位:ms
subroutine SetTimeout(ulong nTimeout) system library "PbIdea.dll" alias for "SetTimeout"
subroutine SetTimeout(ulong nConnTimeout,ulong nSendTimeout,ulong nRecvTimeout) system library "PbIdea.dll" alias for "SetTimeout"

//设置输出目标，默认是输出到内存 blob, mode : 1:默认到内存 2:默认输出到文件,param 指定为文件名
subroutine SetOutputMode(int mode                      ) system library "PbIdea.dll" alias for "SetOutputMode"
subroutine SetOutputMode(int mode,readonly string param) system library "PbIdea.dll" alias for "SetOutputMode"

//HTTP Send方法,通过 GET ,POST ,PUT 等动作发送数据，并取得返回结果
function blob Request(int nHttpType,readonly string strUrl             ) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,boolean triggerEvent) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,readonly blob data   ) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,string data ,boolean bToUTF8) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,uo_json data) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,datawindow dw) system library "PbIdea.dll" alias for "Request"
function blob Request(int nHttpType,readonly string strUrl,datastore  ds) system library "PbIdea.dll" alias for "Request"

//取得上一次方法的 response header
function string GetResponseHeader() system library "PbIdea.dll" alias for "GetResponseHeader"
function string GetHeaderValue(readonly string strKey) system library "PbIdea.dll" alias for "GetHeaderValue"

//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"

//blob(通常是utf8)转json
function uo_json BlobToJson(readonly blob utf8Data) system library "PbIdea.dll" alias for "BlobToJson"

//将字符串按分隔符分成字符串，保存在数组里
function boolean SplitString(readonly string str,readonly string delim,ref string arr[]) system library "PbIdea.dll" alias for "SplitString"


//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//默认使用utf8字符集
subroutine SetUtf8(boolean utf8) system library "PbIdea.dll" alias for "hcSetUtf8"
//设置"Accept-Encoding", "gzip, deflate, br"， 同时对上传数据自动进行压缩
subroutine SetCompress(boolean compress) system library "PbIdea.dll" alias for "hcSetCompress"

//某些应用给 response 成员变量改名后，需要调用此函数
function boolean SetResponseName(string responseName) system library "PbIdea.dll" alias for "SetResponseName"

//设置客户端证书
subroutine SetCert(readonly string cert_file,readonly string password) system library "PbIdea.dll" alias for "hcSetCert"
subroutine SetCert(readonly blob cert_content,readonly string password) system library "PbIdea.dll" alias for "hcSetCert"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_i18n" id="uo_i18n">uo_i18n</a></div>
<pre><code>
//cn:国际化多语种支持
//en:International multilingual support

string path = ""
string language = "" //语言标志

private:

private:
subroutine i18nCreate() system library "pbidea.dll" alias for "i18nCreate"
subroutine i18nDestroy() system library "pbidea.dll" alias for "i18nDestroy"
public:

//通知所有的对象，语言改变了
subroutine NotifyChange(readonly string sEventName,readonly string param) system library "pbidea.dll" alias for "globalNotifyChange"

//设置全局翻译字典,int mode 模式 1，字典放在每个对象节点下面，2 字典放在全局节点下来。
subroutine SetTranslation(int mode,readonly string trFile) system library "pbidea.dll" alias for "SetTranslation"

//应用退出的时候，清理一下内存
subroutine Clear() system library "pbidea.dll" alias for "i18nClear"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_image" id="uo_image">uo_image</a></div>
<pre><code>
//cn:图片处理和显示控件
//en:Picture processing and display controls

//条码类型定义,详见 https://www.zint.org.uk/manual/chapter/6/1
CONSTANT int BARCODE_CODE11      = 1 //主要用于电信。该符号可以对由数字 0-9 和破折号 (-) 组成的任何长度字符串进行编码。默认添加两个模 11 校验位。要仅添加一个校验位，请设置 option_2 = 1 或 --vers=1。要不添加校验位，请设置 option_2 = 2 或 --vers=2。
CONSTANT int BARCODE_C25MATRIX   = 2 //也称为 Code 2 of 5 Matrix 这是一种用于工业应用和照片开发的自检代码。标准代码 2 of 5 将编码任何长度的数字输入（数字 0-9）。默认不添加校验位。要添加校验位，请设置 option_2 = 1 或 --vers=1。要添加校验位但不在人类可读文本中显示，请设置 option_2 = 2 或 --vers=2。
CONSTANT int BARCODE_C25INTER    = 3
CONSTANT int BARCODE_C25IATA     = 4 //国际航空运输署用于航空运输行业的行李处理，此自检代码将对任何长度的数字输入（数字 0-9）进行编码。默认不添加校验位。要添加校验位，请设置 option_2 = 1 或 --vers=1。要添加校验位但不在人类可读文本中显示，请设置 option_2 = 2 或 --vers=2。
CONSTANT int BARCODE_C25LOGIC    = 6 //默认情况下，数据逻辑不包括校验位，并且可以对任何长度的数字输入（数字 0-9）进行编码。要添加校验位，请设置 option_2 = 1 或 --vers=1。要添加校验位但不在人类可读文本中显示，请设置 option_2 = 2 或 --vers=2。
CONSTANT int BARCODE_C25IND      = 7 //这种自检符号系统对成对的数字进行编码，因此只能对偶数个数字 (0-9) 进行编码。如果输入奇数位数，Zint 会添加前导零。默认不添加校验位。要添加校验位，请设置 option_2 = 1 或 --vers=1。要添加校验位但不在人类可读文本中显示，请设置 option_2 = 2 或 --vers=2。
CONSTANT int BARCODE_CODE39      = 8 //标准代码 39 由 Intermec 于 1974 年开发。输入数据可以是任意长度，可以包括字符 0-9、AZ、破折号 (-)、句号 (.)、空格、星号 (*)、美元 ($)、斜线 (/)、加号 (+)和百分比 (%)。该标准不需要校验位，但如果需要，可以通过设置option_2 = 1或使用--ver=1来添加模 43 校验位。
CONSTANT int BARCODE_EXCODE39    = 9 //也称为 Code 39e 和 Code39+，此符号系统扩展了标准 Code 39 以提供对完整 ASCII 字符集的支持。该标准不需要校验位，但如果需要，可以通过设置option_2 = 1或使用--ver=1来添加模 43 校验位。
CONSTANT int BARCODE_EANX        = 13 //EAN 系统用于整个欧洲的零售业，包括 EAN-2 和 EAN-5 附加代码、EAN-8 和 EAN-13 的标准，它们分别编码 2、5、7 或 12 位数字。Zint 将根据输入数据的长度决定使用哪种符号系统。此外，与 UPC 符号一样，可以使用 + 符号添加 EAN-2 和 EAN-5 附加符号。所有的 EAN 符号都包含由 Zint 添加的校验位。
CONSTANT int BARCODE_EANX_CHK    = 14 //如果您正在编码 EAN-8 或 EAN-13 符号并且您的数据已经包含校验位，那么您可以使用符号系统 BARCODE_EANX_CHK (14)，它接受 8 位或 13 位数字输入并在编码前验证校验位。您可以通过将 --addongap= (option_2) 设置为 7（默认）和 12 之间的值，以 X 维度的倍数调整主符号和附加组件之间的间隙。
CONSTANT int BARCODE_EAN128      = 16 //Code 128 的变体，也称为 UCC/EAN-128，该符号体系由 GS1 通用规范定义。应用程序标识符 (AI) 应使用 [方括号] 符号输入。这些将被转换为（圆括号）为人类可读的文本。这将允许在要编码的数据字符串中使用圆括号。应以适当的长度输入固定长度数据以进行正确编码。GS1-128 不支持扩展 ASCII 字符。不会生成 GTIN 数据 (AI 01) 的校验位，需要将其包含在输入数据中。以下是有效 GS1-128 输入的示例：
CONSTANT int BARCODE_CODABAR     = 18 //也称为 NW-7、Monarch、ABC Codabar、USD-4、Ames Code 和 Code 27，此符号系统由 Monarch Marketing Systems 于 1972 年开发，用于零售目的。美国血液委员会于 1977 年采用 Codabar 作为血液识别的标准符号体系。Codabar 可以编码以字母 AD 开头和结尾的任何长度字符串，在这些字母之间包含数字 0-9、破折号 (-)、美元 ($)、冒号 (:)、斜线 (/)、句号 (.) 或加号 (+)。不生成校验位。
CONSTANT int BARCODE_CODE128     = 20 //Code 128 是最普遍的一维条码符号之一，由 Computer Identics 于 1981 年开发。此符号体系支持完整的 ASCII 文本，并使用三模式系统将数据压缩为更小的符号。Zint 自动在模式之间切换并添加一个模 103 校验位。Code 128 是 Zint 使用的默认条码符号。此外，Zint 支持 Code 128 符号中的 Latin-1（非英语）字符的编码 [1]。Latin-1 字符集显示在附录 A 中。
CONSTANT int BARCODE_DPLEIT      = 21 //
CONSTANT int BARCODE_DPIDENT     = 22 //
CONSTANT int BARCODE_CODE16K     = 23 //Code 16k 使用基于 Code 128 的系统，该系统最多可以在一个块中堆叠 16 行。这提供了 77 个字符或 154 个数字的最大数据容量，并包括两个模 107 校验位。Code 16k 也以与 Code 128 相同的方式支持扩展的 ASCII 字符编码。
CONSTANT int BARCODE_CODE49      = 24 //此选项根据健康行业条码标准的要求向标准 Code 39 符号添加前导“+”字符和尾随模 49 校验位。
CONSTANT int BARCODE_CODE93      = 25 //作为扩展代码 39 的变体，代码 93 也支持完整的 ASCII 文本。Zint 添加了两个校验位。
CONSTANT int BARCODE_FLAT        = 28 //
CONSTANT int BARCODE_RSS14       = 29 //此标准也称为 RSS-14，可对 13 位项目代码进行编码。(01) 的校验位和应用程序标识符是由 Zint 添加的。要生成截断符号，请将符号高度设置为 32 到 13 之间的值。普通 DataBar-14 符号的高度应为 33 或更大。
CONSTANT int BARCODE_RSS_LTD     = 30
CONSTANT int BARCODE_RSS_EXP     = 31
CONSTANT int BARCODE_TELEPEN     = 32
CONSTANT int BARCODE_UPCA        = 34
CONSTANT int BARCODE_UPCE        = 37
CONSTANT int BARCODE_POSTNET     = 40
CONSTANT int BARCODE_MSI_PLESSEY = 47
CONSTANT int BARCODE_FIM         = 49
CONSTANT int BARCODE_LOGMARS     = 50
CONSTANT int BARCODE_PHARMA      = 51
CONSTANT int BARCODE_PZN         = 52
CONSTANT int BARCODE_PHARMA_TWO  = 53
CONSTANT int BARCODE_PDF417      = 55 //PDF417 符号系统广泛用于包裹行业，可以将大量数据编码到一个小空间中。Zint 支持编码高达 925 个码字的 ISO 标准最大符号大小，其中（在纠错级别 0）允许最大数据大小为 1850 个文本字符或 2710 个数字。生成的PDF417符号的宽度可以在命令行中使用--cols 开关后跟一个1到30之间的数字来指定，校验位信息的数量可以通过使用--security 开关后跟一个数字来指定0 到 8 之间，其中用于校验信息的码字数由 2 确定（值 + 1）. 如果使用 API，这些值将分别分配给option_2和option_1 。检查信息的默认级别由被编码的数据量决定。该符号体系默认使用Latin-1 字符编码，但也支持ECI 编码机制。单独的符号 ID 可用于编码健康产业条形码 (HIBC) 数据，该数据将前导“+”字符和模 49 校验位添加到编码数据中。
CONSTANT int BARCODE_PDF417TRUNC = 56 //也称为截断 PDF417。选项与上述 PDF417 相同。
CONSTANT int BARCODE_MAXICODE    = 57 
/*Maxicode 符号系统由 UPS 开发，采用围绕“靶心”取景器图案的六边形网格。此符号系统设计用于识别宗地。Maxicode 符号可以用五种模式之一进行编码。在模式 2 和 3 中，Maxicode 符号由名为主要和次要消息的两部分组成。主要消息由结构化数据字段组成，其中包含有关正在发送的包的各种数据，而次要消息通常由数据结构中的地址数据组成。Zint 所需的主消息格式如下表所示：
人物	意义
1-9	邮政编码数据最多可包含 9 位数字（对于模式 2）或最多 6 个字母数字字符（对于模式 3）。剩余未使用的字符应填充为空格字符 (ASCII 32)。
10-12	符合 ISO 3166 的三位国家代码。
13-15	三位数的服务代码。这取决于您的包裹快递员。
可以使用--primary=开关在命令提示符下设置主要消息。辅助消息使用正常的数据输入方法。例如：
zint -o test.eps -b 57 --primary='999999999840012' -d 'Secondary Message Here'
使用 API 时，主消息必须放在符号->主 字符串中。次要的输入方式与第 5.2 节中描述的相同。When either of these modes is selected Zint will analyse the primary message and select either mode 2 or mode 3 as appropriate.
可以使用--mode = 开关或设置option_1来访问模式 4 到 6 。模式 4 到 6 不需要主要消息。例如：
zint -o test.eps -b 57 --mode=4 -d 'A MaxiCode Message in Mode 4'
模式 6 保留用于维护扫描仪硬件，不应用于对用户数据进行编码。
默认情况下，此符号系统使用 Latin-1 字符编码，但也支持 ECI 编码机制。Maxicode 符号中可以放置的最大文本长度取决于文本中使用的字符类型。
下表给出了最大数据长度示例：

模式	大写字母的最大数据长度	数字的最大数据长度	纠错码字数
2（仅次要）	84	126	50
3（仅次要）	84	126	50
4	93	135	50
5	77	110	66
6	93	135	50
*/
CONSTANT int BARCODE_QRCODE      = 58
/*
此符号系统也称为快速响应代码，由 Denso 开发。使用--secure=选项或设置 option_1可以使用四个级别的纠错，如下表所示。

输入	ECC级别	纠错能力	恢复能力
1	L（默认）	大约 20% 的符号	约 7%
2	米	约 37% 的符号	约 15%
3	问	大约 55% 的符号	约 25%
4	H	大约 65% 的符号	约 30%
可以使用--vers=选项或将option_2设置为所需的二维码版本 (1-40)来设置符号的大小。生成的符号大小如下表所示。

输入	符号大小
1	21 × 21
2	25 × 25
3	29 × 29
4	33 × 33
5	37 × 37
6	41 × 41
7	45 × 45
8	49 × 49
9	53 × 53
10	57 × 57
输入	符号大小
11	61 × 61
12	65 × 65
13	69 × 69
14	73 × 73
15	77 × 77
16	81 × 81
17	85 × 85
18	89 × 89
19	93 × 93
20	97 × 97
输入	符号大小
21	101 × 101
22	105 × 105
23	109 × 109
24	113 × 113
25	117 × 117
26	121 × 121
27	125 × 125
28	129 × 129
29	133 × 133
30	137 × 137
输入	符号大小
31	141 × 141
32	145 × 145
33	149 × 149
34	153 × 153
35	157 × 157
36	161 × 161
37	165 × 165
38	169 × 169
39	173 × 173
40	177 × 177
（第 40 版）二维码符号的最大容量为 7089 个数字、4296 个字母数字字符或 2953 个字节的数据。二维码符号也可用于编码 GS1 数据。默认情况下，二维码符号可以对 Latin-1 集合中的字符和汉字字符进行编码，这些字符是 Shift-JIS 编码方案的成员。此外，二维码支持使用 ECI 机制使用其他字符集。输入通常应以 Unicode (UTF-8) 格式输入，转换为 Shift-JIS 由 Zint 执行。单独的符号 ID 可用于编码健康产业条形码 (HIBC) 数据，该数据将前导“+”字符和模 49 校验位添加到编码数据中。

可以通过使用 --fullmultibyte 开关或将 option_3 设置为 ZINT_FULL_MULTIBYTE 来最大化非 ASCII 数据密度，但在使用前请检查您的条形码阅读器是否支持此功能。
*/
CONSTANT int BARCODE_CODE128B    = 60 //有时阻止 Code 128 使用压缩数字数据的子集模式 C 是有利的。BARCODE_CODE128B 选项（符号系统 60）抑制模式 C 以支持模式 B。
CONSTANT int BARCODE_AUSPOST     = 63
CONSTANT int BARCODE_AUSREPLY    = 66
CONSTANT int BARCODE_AUSROUTE    = 67
CONSTANT int BARCODE_AUSREDIRECT = 68
CONSTANT int BARCODE_ISBNX       = 69
CONSTANT int BARCODE_RM4SCC      = 70
CONSTANT int BARCODE_DATAMATRIX  = 71
CONSTANT int BARCODE_EAN14       = 72
CONSTANT int BARCODE_CODABLOCKF  = 74
CONSTANT int BARCODE_NVE18       = 75
CONSTANT int BARCODE_JAPANPOST   = 76
CONSTANT int BARCODE_KOREAPOST   = 77
CONSTANT int BARCODE_RSS14STACK  = 79
CONSTANT int BARCODE_RSS14STACK_OMNI = 80
CONSTANT int BARCODE_RSS_EXPSTACK = 81
CONSTANT int BARCODE_PLANET      = 82
CONSTANT int BARCODE_MICROPDF417 = 84
CONSTANT int BARCODE_ONECODE     = 85
CONSTANT int BARCODE_PLESSEY     = 86
CONSTANT int BARCODE_TELEPEN_NUM = 87
CONSTANT int BARCODE_ITF14       = 89
CONSTANT int BARCODE_KIX         = 90
CONSTANT int BARCODE_AZTEC       = 92
CONSTANT int BARCODE_DAFT        = 93
CONSTANT int BARCODE_MICROQR     = 97 //用于短消息的 QR 码符号的微型版本。可以选择 ECC 级别作为 QR 码（见上图）。QR 码符号可以对 Latin-1 集合中的字符和汉字字符进行编码，这些字符是 Shift-JIS 编码方案的成员。输入应作为 UTF-8 流输入，转换为 Shift-JIS 由 Zint 自动执行。可以使用--vers=选项或设置option_2来选择首选符号大小， 尽管如果输入数据需要，Zint 使用的实际版本可能会有所不同。下表显示了可能的尺寸：
CONSTANT int BARCODE_HIBC_128    = 98
CONSTANT int BARCODE_HIBC_39     = 99
CONSTANT int BARCODE_HIBC_DM     = 102
CONSTANT int BARCODE_HIBC_QR     = 104
CONSTANT int BARCODE_HIBC_PDF    = 106
CONSTANT int BARCODE_HIBC_MICPDF = 108
CONSTANT int BARCODE_HIBC_BLOCKF = 110
CONSTANT int BARCODE_HIBC_AZTEC  = 112
CONSTANT int BARCODE_AZRUNE      = 128
CONSTANT int BARCODE_CODE32      = 129
CONSTANT int BARCODE_EANX_CC     = 130
CONSTANT int BARCODE_EAN128_CC   = 131
CONSTANT int BARCODE_RSS14_CC    = 132
CONSTANT int BARCODE_RSS_LTD_CC  = 133
CONSTANT int BARCODE_RSS_EXP_CC  = 134
CONSTANT int BARCODE_UPCA_CC     = 135
CONSTANT int BARCODE_UPCE_CC     = 136
CONSTANT int BARCODE_RSS14STACK_CC = 137
CONSTANT int BARCODE_RSS14_OMNI_CC = 138
CONSTANT int BARCODE_RSS_EXPSTACK_CC = 139
CONSTANT int BARCODE_CHANNEL     = 140
CONSTANT int BARCODE_CODEONE     = 141
CONSTANT int BARCODE_GRIDMATRIX  = 142

//条码库选项详见 https://www.zint.org.uk/manual/chapter/5
/*
到目前为止，我们的应用程序并不是很有用，除非我们计划只制作 Code 128 符号并且我们不介意它们只保存到 out.png。当然，与 CLI 程序一样，这些选项也可以更改。这样做的方法是在创建和编码阶段之间更改zint_symbol结构的内容。该zint_symbol结构由以下变量：
条码参数说明：
bind      选项，添加绑定条
hidetext  选项，不显示文字
show_hrt  选项，删除人类可读文本
bold      选项，使用粗体文本
box       选项，在符号周围加一个方框
cymk      选项，在EPS符号中使用cmyk颜色
dotty     选项，多蒂用点代替方块来表示矩阵符号
dmre      选项，允许数据矩阵矩形扩展
esc       选项，处理输入数据中的转义字符
gs1       选项，将输入视为与gs1兼容的数据
small     选项，在图像中使用小文本
square    选项，平方力数据矩阵符号为平方
whitespace_width 整数	水平空白宽度。
whitespace_height 整数	垂直空白高度。
border_width 整数	边框宽度。
symbology或
type   =  n ,条码类型数(默认为20 (“Code128”))
bg     =  ffffff,指定背景色，十六进制方式，6个字符长， ,默认白色
fg     =  000000,指定前景色，十六进制方式，6个字符长， ,默认黑色
align  = left / right ，文本居左，居右，默认居中
border = n, 边框的宽度
cols   = n, 设置符号中的数据列数
rows   = n, 设置符号中的数据行数
dotsize = n ,点在dotty模式下的数量设置半径
eci     = n, 设置原始数据的eci模式
filetype = PNG/EPS/SVG/PNG/EPS/GIF/TXT，设置输出文件类型
height   = n ,设置高度
mode     = n,设置编码模式(Maxicode/组合)
output  = out.png ,文件发送输出到文件。(缺省为out.png)
primary = STRING Set结构化主消息(Maxicode/Composite)
secure  = NUMBER ,Set error correct level
scale   = n,缩放比例,默认为1
rotate  = 0/90/180/270,旋转角度,(PNG/BMP/PCX)
vers    = n,设置符号版本(二维码/Han Xin)
whitesp = n,维数倍数下空格的数量设置宽度
test = ""
option_1 = n
option_2 = n
option_3 = n
*/

boolean OriginalSize = false //以原图大小显示

//打开新图片,可以是文件名，可以是base64编码的文本内容，也可以是blob数据
function boolean Open(readonly string fileNameorBase64) system library "PbIdea.dll" alias for "imageOpen"
function boolean Open(readonly string fileNameorBase64,int paintMode) system library "PbIdea.dll" alias for "imageOpen"
function boolean Open(readonly blob imageData) system library "PbIdea.dll" alias for "imageOpen"
function boolean Open(readonly blob imageData,int paintMode) system library "PbIdea.dll" alias for "imageOpen"
//打开图片文件，内容是二维码
function boolean OpenQrCode(readonly string codeText, int nVersion, int nLevel,ulong clr, ulong clrBack, readonly string LogoPng) system library "PbIdea.dll" alias for "imageOpenQrCode"
function boolean OpenQrCode(readonly string codeText, int nVersion, int nLevel,ulong clr, ulong clrBack, readonly string LogoPng,boolean useUTF8/*默认*/) system library "PbIdea.dll" alias for "imageOpenQrCode"
function boolean OpenQrCode(readonly string codeText, int nVersion, int nLevel,ulong clr, ulong clrBack, readonly string LogoPng,boolean useUTF8/*默认*/,int width_height) system library "PbIdea.dll" alias for "imageOpenQrCode"
//打开图片文件，内容是条码
function boolean OpenBarCode(readonly string codeText,string barType, int nHeight,double scale,readonly string options) system library "PbIdea.dll" alias for "imageOpenBarCode"
/*
json.Set("text", text)
json.Set("type", "DATAMATRIX")
json.Set("height", nHeight)
json.Set("scale", 1.0)
json.Set("fontsize", 10);
*/
function boolean OpenBarCode(uo_json jsDefine) system library "PbIdea.dll" alias for "imageOpenBarCode"

//设置datawindow显示条码/二维码表达式.expressName 表达式字段名称，columnName 显示值字段名称，jsonOption选项参数集，具体参考DEMO
subroutine SetDatawindowCoder(datawindow dw,string expressName,string columnName,uo_json jsonOption) system library "PbIdea.dll" alias for "imageSetDatawindowCoder"

subroutine Close() system library "PbIdea.dll" alias for "imageClose"
subroutine Paint(powerobject obj) system library "PbIdea.dll" alias for "imagePaint"
//mode 1 拉伸 , mode 2 ，固定比例
subroutine Paint(powerobject obj,int nMode) system library "PbIdea.dll" alias for "imagePaint"
subroutine Paint(powerobject obj,int nMode,int nX,int nY,int nWidth,int nHeight) system library "PbIdea.dll" alias for "imagePaint"
//把本图自动绘制到哪个窗口上去
//subroutine SetPainter(powerobject obj) system library "PbIdea.dll" alias for "imageSetPainter"
//使某个颜色变成透明
subroutine SetMaskColor(ulong colorMask) system library "PbIdea.dll" alias for "imageSetMaskColor"
//透明度 1-255
subroutine SetAlpha(int nAlpha) system library "PbIdea.dll" alias for "imageSetAlpha"
//填充透明部分的颜色，对于png图转其他格式时填透明部分背景有用
subroutine SetAlphaColor(ulong color) system library "PbIdea.dll" alias for "imageSetAlphaColor"
//另存，格式转换
function boolean Save(readonly string fileName) system library "PbIdea.dll" alias for "imageSave"
function boolean Save(readonly string imageFormat,ref blob image) system library "PbIdea.dll" alias for "imageSave"

//旋转角度,nAngle 0-360 角度
//默认为0,nAngle 为实际角度; 为1时： nAngle: 1 2 3 分别对应0 90 180 270 固定角度
function boolean Rotate(int nAngle) system library "PbIdea.dll" alias for "imageRotate"
function boolean Rotate(int nAngle,int method) system library "PbIdea.dll" alias for "imageRotate"
//垂直翻转
function boolean Flip() system library "PbIdea.dll" alias for "imageFlip"
//水平镜像
function boolean Mirror() system library "PbIdea.dll" alias for "imageMirror"
//缩放,按固定尺寸,注意，缩放一定要用变量定义，直接使用数字作为参数，会默认为double类型
function boolean Zoom(int nWidth,int nHeight) system library "PbIdea.dll" alias for "imageZoom"
//缩放,按比例
function boolean Zoom(double xZoom,double yZoom) system library "PbIdea.dll" alias for "imageZoom"
//ms 毫秒 , mode 模式 , step 步调
subroutine SetAnimate(int nMs,int nMode,int nStep) system library "PbIdea.dll" alias for "imageSetAnimate"
//初始化 userobject 对象，使其可以响应 pbm_paint 消息
subroutine InitUserObject(ulong hwnd) system library "PbIdea.dll" alias for "imageInitUserObject"
//设置大小,作为不可视对象时使用
function boolean SetSize(int w,int h) system library "PbIdea.dll" alias for "imageSetSize"
//获取大小
function boolean GetSize(ref int w,ref int h) system library "PbIdea.dll" alias for "imageGetSize"
//设置背景颜色
//clrDst 新颜色，默认是背景色 clrSrc指定原来颜色，quotient是色差范围，默认是10,0是完全相同
subroutine ReplaceColor(ulong clrDst) system library "PbIdea.dll" alias for "imageReplaceColor"
subroutine ReplaceColor(ulong clrDst,ulong clrSrc) system library "PbIdea.dll" alias for "imageReplaceColor"
subroutine ReplaceColor(ulong clrDst,ulong clrSrc,double quotient) system library "PbIdea.dll" alias for "imageReplaceColor"
subroutine ReplaceColor(ulong clrDst,double quotient) system library "PbIdea.dll" alias for "imageReplaceColor"
//指定颜色变成透明
subroutine TransParentColor(ulong clrSrc,double quotient) system library "PbIdea.dll" alias for "imageTransParentColor"

//text 文本内容，error_level容错级别0-3,version 1-40 越大容纳字符越多,icon为图标
/*
使用 uo_json 指定参数时，可以更加丰富,file和text为必输参数，其他均为可选参数
uo_json j
j = create uo_json
//文本内容
j.set("text","二维码测试文本")
//容错级别 0-3 ,有图标时建议设置为3
j.set("error_level",3)
//版本号 1-40
j.set("version",18)
//边框宽度
j.set("border",8)
//边框与二维码之间的空隙
j.set("space",4)
//颜色
j.set("color",0)
//底色
j.set("bgcolor",rgb(255,255,255))
//指定图片尺寸，小于8时按照默认生成
j.set("size",196)
//指定icon图标
j.set("icon","../demores/images/logo.png")
//指定icon图标是否缩放
j.set("icon_zoom",true)
//另存为图片名称,支持bmp jpg png gif webp 格式默认为bmp
j.set("file","tmp/test256.bmp")
//存为.bmp格式时,指定bmp颜色 1位 黑白，256(8位) 灰度，其他全彩
j.set("bmp",8)
*/
function boolean MakeQrcode(readonly string fileName,readonly string text0) system library "PbIdea.dll" alias for "MakeQrcode"
function boolean MakeQrcode(readonly string fileName,readonly string text0,int error_level) system library "PbIdea.dll" alias for "MakeQrcode"
function boolean MakeQrcode(readonly string fileName,readonly string text0,int error_level,int version) system library "PbIdea.dll" alias for "MakeQrcode"
function boolean MakeQrcode(uo_json json) system library "PbIdea.dll" alias for "MakeQrcode"

//解码条码或者二维码
function boolean DecodeSymbol(readonly string fileName, uo_json result) system library "PbIdea.dll" alias for "imageDecodeSymbol"
function boolean DecodeSymbol(readonly blob imageData, uo_json result) system library "PbIdea.dll" alias for "imageDecodeSymbol"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_imageview" id="uo_imageview">uo_imageview</a></div>
<pre><code>
//image view

public:
INDIRECT string fileName {iOpen(*value), GetFileName()}
INDIRECT int angle{SetRotate(*value), GetRotate()}
INDIRECT double zoom{SetZoom(*value), GetZoom()}

private:
//内部私有函数
subroutine iviewCreate() system library "pbidea.dll" alias for "iviewCreate"
subroutine iviewDestroy() system library "pbidea.dll" alias for "iviewDestroy"

public:
//open by file name
function boolean iOpen(readonly string fileNameORurl) system library "pbidea.dll" alias for "iviewOpen"
function boolean iOpen(readonly string url, readonly string proxyIP,long proxyPort) system library "pbidea.dll" alias for "iviewOpen"
//open by blob data
function boolean iOpen(readonly blob data) system library "pbidea.dll" alias for "iviewOpen"
//open by file name
function boolean iOpen(readonly string fileNameORurl, uo_json prop) system library "pbidea.dll" alias for "iviewOpen"
function boolean iOpen(readonly string url, readonly string proxyIP,long proxyPort, uo_json prop) system library "pbidea.dll" alias for "iviewOpen"
//open by blob data
function boolean iOpen(readonly blob data, uo_json prop) system library "pbidea.dll" alias for "iviewOpen"
//open by file name
function boolean iAdd(readonly string fileNameORurl) system library "pbidea.dll" alias for "iviewAdd"
function boolean iAdd(readonly string url, readonly string proxyIP,long proxyPort) system library "pbidea.dll" alias for "iviewAdd"
//open by blob data
function boolean iAdd(readonly blob data) system library "pbidea.dll" alias for "iviewAdd"
//open by file name
function boolean iAdd(readonly string fileNameORurl, uo_json prop) system library "pbidea.dll" alias for "iviewAdd"
function boolean iAdd(readonly string url, readonly string proxyIP,long proxyPort, uo_json prop) system library "pbidea.dll" alias for "iviewAdd"
//open by blob data
function boolean iAdd(readonly blob data, uo_json prop) system library "pbidea.dll" alias for "iviewAdd"
//close
subroutine Close() system library "pbidea.dll" alias for "iviewClose"
//return file name
function string GetFileName() system library "pbidea.dll" alias for "iviewGetFileName"
//option
subroutine SetOption(uo_json jsOption) system library "pbidea.dll" alias for "iviewSetOption"

//zoom , scale: 
subroutine SetZoom(double scale) system library "pbidea.dll" alias for "iviewSetZoom"
function double GetZoom() system library "pbidea.dll" alias for "iviewGetZoom"

//flip , flip_type: 0: left-right, 1: up-down
subroutine Flip(int flip_type) system library "pbidea.dll" alias for "iviewFlip"
//rotate, angle: -360 - 360
subroutine SetRotate(int iAngle) system library "pbidea.dll" alias for "iviewSetRotate"
function int GetRotate() system library "pbidea.dll" alias for "iviewGetRotate"

//print
function boolean Print() system library "pbidea.dll" alias for "iviewPrint"
//refresh
subroutine Refresh() system library "pbidea.dll" alias for "iviewRefresh"
//dibs, 获取设备无关位图
function uo_dib dibs() system library "pbidea.dll" alias for "iviewDibs"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_instance" id="uo_instance">uo_instance</a></div>
<pre><code>
//单实例判断

private:
subroutine intanceCreate() system library "pbidea.dll" alias for "intanceCreate"
subroutine intanceDestroy() system library "pbidea.dll" alias for "intanceDestroy"
public:
//判断是否已经有实例在运行
function boolean GetInstance() system library "pbidea.dll" alias for "intanceGetInstance"
function boolean GetInstance(readonly string userName) system library "pbidea.dll" alias for "intanceGetInstance"
//关闭实例标志
subroutine CloseInstance() system library "pbidea.dll" alias for "intanceGetInstance"
subroutine CloseInstance(readonly string userName) system library "pbidea.dll" alias for "intanceCloseInstance"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_json" id="uo_json">uo_json</a></div>
<pre><code>
//cn:json,最好的工具之一
//en:json,One of the best tools

CONSTANT int STATUS_NOTMODIFIED = 0
CONSTANT int STATUS_MODIFIED    = 1
CONSTANT int STATUS_NEW         = 2
CONSTANT int STATUS_NEWMODIFIED = 3

CONSTANT int SetBlob  = 1 // Set 时指定为BLOB，直接进行BASE64编码
CONSTANT int SetBytes = 2 // Set 时指定为字节序

//定义访问属性
/*
public:
INDIRECT string text {_SetText(*value),_GetText()}
INDIRECT string filename {_SetFileName(*value),_GetFileName()}
INDIRECT string value {_SetValue(*value,*value),_GetValue()}
private:
string is_pri_filename
*/

//初始化和销毁对象，对象内部使用
private:
//创建JSON对象
function ulong jsonCreate() system library "PbIdea.dll" alias for "jsonCreate"
//销毁JSON对象
subroutine jsonDestroy() system library "PbIdea.dll" alias for "jsonDestroy"

public:
//用JSON字符串或blob构造JSON对象
function boolean Parse(readonly string strJson) system library "PbIdea.dll" alias for "Parse"
function boolean Parse(readonly blob blobJson) system library "PbIdea.dll" alias for "Parse"
function boolean Parse(readonly string strJson,boolean removeEscape) system library "PbIdea.dll" alias for "Parse"
function boolean Parse(readonly blob blobJson,boolean removeEscape) system library "PbIdea.dll" alias for "Parse"
function boolean Parse(readonly string strJson,boolean removeEscape, boolean NumAsString) system library "PbIdea.dll" alias for "Parse"
function boolean Parse(readonly blob blobJson,boolean removeEscape, boolean NumAsString) system library "PbIdea.dll" alias for "Parse"
//用JSON文件构造JSON对象
function boolean ParseFile(readonly string strJson) system library "PbIdea.dll" alias for "ParseFile"
function boolean ParseFile(readonly string strJson,boolean removeEscape) system library "PbIdea.dll" alias for "ParseFile"
function boolean ParseFile(readonly string strJson,boolean removeEscape, boolean NumAsString) system library "PbIdea.dll" alias for "ParseFile"
//将JSON对象写到文件
//后2个参数，参考 ToString()
//nCharset: 0 utf8(默认),1 ansi , 2 unicode
function boolean WriteJsonFile(readonly string strFile,boolean bFormat,boolean bEncodeChinese) system library "PbIdea.dll" alias for "WriteJsonFile"
function boolean WriteJsonFile(readonly string strFile,boolean bFormat,boolean bEncodeChinese,int nCharset) system library "PbIdea.dll" alias for "WriteJsonFile"
//将JSON对象转成字符串,与Prase相反
//参数bFormat : 将JSON对象转成字符串,与Prase相反。带有层次格式
//参数bEncodeChinese,是否将汉字转换为\u4e00这样的unicode格式
//本函数声明时，可以动态使用参数，即可以，声明为 ToString(),ToString(boolean bFormat),ToString(boolean bFormat,boolean bEncodeChinese),如果省略参数，默认为 false
function string  ToString() system library "PbIdea.dll" alias for "ToString"
function string  ToString(boolean bFormat) system library "PbIdea.dll" alias for "ToString"
function string  ToString(boolean bFormat,boolean bEncodeChinese) system library "PbIdea.dll" alias for "ToString"
function string  ToString(boolean bFormat,boolean bEncodeChinese,boolean bCrLn) system library "PbIdea.dll" alias for "ToString" //即将~n 转成 ~r~n，方便显示
function string  ToString(boolean bFormat,boolean bEncodeChinese,boolean bCrLn,int Numberofdecimalplaces) system library "PbIdea.dll" alias for "ToString" //即将~n 转成 ~r~n，方便显示
//转成文本，默认以tab分隔
function string  ToText() system library "PbIdea.dll" alias for "ToText"
function string  ToText(boolean header,readonly string fieldflag,readonly string lineflag) system library "PbIdea.dll" alias for "ToText"
//转成UTF8编码的字符串
function blob  ToUTF8() system library "PbIdea.dll" alias for "jsonToUTF8"
function blob  ToUTF8(boolean bFormat) system library "PbIdea.dll" alias for "jsonToUTF8"
function blob  ToUTF8(boolean bFormat,boolean bEncodeChinese) system library "PbIdea.dll" alias for "jsonToUTF8"
function blob  ToUTF8(boolean bFormat,boolean bEncodeChinese,boolean bCrLn) system library "PbIdea.dll" alias for "jsonToUTF8" //即将~n 转成 ~r~n，方便显示
function blob  ToUTF8(boolean bFormat,boolean bEncodeChinese,boolean bCrLn,int Numberofdecimalplaces) system library "PbIdea.dll" alias for "jsonToUTF8" //即将~n 转成 ~r~n，方便显示

//取得一个节点值 ，值类型是 any ，根据具体情况赋予特定类型，strKey 节点关键字， bSuccess 输出参数，表示本次Get行为是否成功
function boolean Get(readonly string strKey,ref uo_json val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref string  val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref int     val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref uint    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref long    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref ulong   val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref longlong val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref double  val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref decimal val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref real    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref boolean val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref blob    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref uo_json val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref string  val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref int     val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref uint    val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref long    val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref ulong   val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref longlong val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref double  val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref decimal val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref real    val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref boolean val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref blob    val[]) system library "PbIdea.dll" alias for "Get"
function boolean Get(readonly string strKey,ref any val) system library "PbIdea.dll" alias for "Get"//如果你不知道具体类型，可以使用ANY型，然后用classname(value) 判断取得的是什么类型

//根据索引号获取对象成员
function boolean Get(long nIndex,ref string strKey,ref any val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref string strKey,ref any val,ref string strType) system library "PbIdea.dll" alias for "Get"

//取得一个数组值 ，值类型是 any ，根据具体情况赋予特定类型，nIndex 是索引号,介于 1 和ArrCount()之间 ， bSuccess 输出参数，表示本次Get行为是否成功
function boolean Get(long nIndex,ref uo_json val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref string  val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref int     val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref uint    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref long    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref ulong   val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref longlong val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref double  val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref decimal val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref real    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref boolean val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref blob    val) system library "PbIdea.dll" alias for "Get"
function boolean Get(long nIndex,ref any val) system library "PbIdea.dll" alias for "Get" //如果你不知道具体类型，可以使用ANY型，然后用classname(value) 判断取得的是什么类型
//增加一个节点
function boolean Set(readonly string strKey,uo_json val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,string  val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,int     val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,uint    val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,long    val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,ulong   val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,longlong val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,double  val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,decimal val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,real    val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,boolean val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,blob    val[]) system library "PbIdea.dll" alias for "Set"
function boolean Set(readonly string strKey,readonly any val) system library "PbIdea.dll" alias for "Set" //json节点
function boolean Set(readonly string strKey,readonly any val, int SetType) system library "PbIdea.dll" alias for "Set" //json节点

//增加一个数组项
function boolean Set(readonly any val) system library "PbIdea.dll" alias for "Set" //用于数组
//替换一个节点内容
function boolean Replace(readonly string strKey,any val) system library "PbIdea.dll" alias for "Replace"
//替换一个数组项内容
function boolean Replace(int    nIndex,any val) system library "PbIdea.dll" alias for "Replace"
//删除一个节点
function boolean Remove(readonly string strKey) system library "PbIdea.dll" alias for "Remove"
//删除一个数组项内容
function boolean Remove(int    nIndex) system library "PbIdea.dll" alias for "Remove"
//取数组项个数
function long     ArrCount() system library "PbIdea.dll" alias for "ArrCount"
function long     ArrCount(readonly string strKey) system library "PbIdea.dll" alias for "ArrCount"
//JSON对象是否为空
function boolean IsEmpty() system library "PbIdea.dll" alias for "IsEmpty"
function boolean IsEmpty(readonly string strKey) system library "PbIdea.dll" alias for "IsEmpty"
//某节点是否为空
function boolean IsNull(readonly string strKey) system library "PbIdea.dll" alias for "IsNull"
//某数组项是否为空
function boolean IsNull(int nIndex) system library "PbIdea.dll" alias for "IsNull"
//清空
subroutine Clear() system library "PbIdea.dll" alias for "Clear"
//取JSON对象节点数
function long    GetItemCount() system library "PbIdea.dll" alias for "GetItemCount"
function long    GetItemCount(readonly string strKey) system library "PbIdea.dll" alias for "GetItemCount"
//取得JSON对象所有节点的关键字列表,列表放在数组里,由 "关键字,节点数据类型" 组成每个数组项
function long    GetKeys(ref string keys[]) system library "PbIdea.dll" alias for "GetKeys"
function long    GetKeys(ref string keys[],ref string types[]) system library "PbIdea.dll" alias for "GetKeys"
//取得当前json的类型
function string  GetType() system library "PbIdea.dll" alias for "GetType"
function string  GetType(readonly string keys) system library "PbIdea.dll" alias for "GetType"
//xml 转 json
function boolean JsonFromXML(readonly string xml) system library "PbIdea.dll" alias for "JsonFromXML"
function boolean JsonFromXML(readonly string xml, boolean flagAttrName) system library "PbIdea.dll" alias for "JsonFromXML"
function boolean JsonFromXML(uo_xml xml) system library "PbIdea.dll" alias for "JsonFromXML"
function boolean JsonFromXML(uo_xml xml, boolean flagAttrName) system library "PbIdea.dll" alias for "JsonFromXML"
//structure to json
function boolean JsonFromStructure(readonly any struct) system library "PbIdea.dll" alias for "jsonFromStructure"
//map 转 json
function boolean JsonFromMap(readonly uo_map map) system library "PbIdea.dll" alias for "JsonFromMap"
//将JSON导入数据窗口或 datastore，返回导入条数
function long    dwImportJson(datawindow dw                                               ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datawindow dw, readonly string jsonFileOrPath               ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datawindow dw, uo_json jsmap                                ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datawindow dw, readonly string jsonFileOrPath ,uo_json jsmap) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datastore  ds                                               ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datastore  ds, readonly string jsonFileOrPath               ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datastore  ds, uo_json jsmap                                ) system library "PbIdea.dll" alias for "dwImportJson"
function long    dwImportJson(datastore  ds, readonly string jsonFileOrPath, uo_json jsmap) system library "PbIdea.dll" alias for "dwImportJson"

//按照字段顺序插入数据
function long    dwImportJson2(datawindow dw) system library "PbIdea.dll" alias for "dwImportJson2"
function long    dwImportJson2(datastore  ds) system library "PbIdea.dll" alias for "dwImportJson2"
//将datawindow/datastore 数据生成JSON，返回生成条数,status : 0:NotModified! , 1:DataModified! ,2:New!,3:NewModified!	
//参数jsonFile为直接生成到文件
//***注意，dwExportJson 第一个参数必须是 dw/ds，后面3个参数，可以任意组合，自己声明吧
function long    dwExportJson(datawindow dw) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw ,readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds ,readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw , int status) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds , int status) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw , int status ,readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds , int status ,readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
//只导出listColumns指定的所有列数以外的列,默认是排除列，bExclude 为false时指定导出列
function long    dwExportJson(datawindow dw,readonly string listColumns[]) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds,readonly string listColumns[]) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw,readonly string listColumns[],boolean bExclude) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds,readonly string listColumns[],boolean bExclude) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw,readonly string listColumns[],readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds,readonly string listColumns[],readonly string jsonFile) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datawindow dw,readonly string listColumns[],readonly string jsonFile,boolean bExclude) system library "PbIdea.dll" alias for "dwExportJson"
function long    dwExportJson(datastore  ds,readonly string listColumns[],readonly string jsonFile,boolean bExclude) system library "PbIdea.dll" alias for "dwExportJson"

function long    dwExportJsonForUpdate(datawindow  dw) system library "PbIdea.dll" alias for "dwExportJsonForUpdate"
function long    dwExportJsonForUpdate(datastore   ds) system library "PbIdea.dll" alias for "dwExportJsonForUpdate"
function long    dwExportJsonForUpdate(datawindow  dw, DWBuffer dwbuffer ) system library "PbIdea.dll" alias for "dwExportJsonForUpdate"
function long    dwExportJsonForUpdate(datastore   ds, DWBuffer dwbuffer ) system library "PbIdea.dll" alias for "dwExportJsonForUpdate"

//
/*
//此函数放在 dw/ds 的继承类中使用
//使用方法，在dw/ds 的继承类中 Local External Function 里面声明此函数，然后直接就可以 dw_1.ImportJson("data.json")
function long    ImportJson(datastore  ds,string jsonFile) system library "PbIdea.dll" alias for "ImportJson"

//将datawindow/datastore 数据生成JSON，返回生成条数,status : 0:NotModified! , 1:DataModified! ,2:New!,3:NewModified!	
//参数jsonFile为直接生成到文件
//3个参数，可以任意组合，自己声明吧
//使用方法，在dw/ds 的继承类中 Local External Function 里面声明此函数，然后直接就可以 dw_1.ExportJson("data.json")
function long    ExportJson(string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(int status) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(int status ,string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
//只导出listColumns指定的所有列数
function long    ExportJson(string listColumns[]) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(string listColumns[],string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
*/

//json对象内容深拷贝
function boolean CopyFrom(uo_json jsonFrom) system library "PbIdea.dll" alias for "jsonCopyFrom"
function boolean CopyTo(uo_json jsonTo) system library "PbIdea.dll" alias for "jsonCopyTo"

//失败时获取错误信息
function string GetError() system library "PbIdea.dll" alias for "GetError"
//一个给 dw/ds 追加空行的函数，比 InsertRow 效率高得多,行数越多，效率越高
function long dwAppendRows(datawindow dw,long nRows) system library "PbIdea.dll" alias for "dwAppendRows"
function long dwAppendRows(datastore  ds,long nRows) system library "PbIdea.dll" alias for "dwAppendRows"

//内部数据转换函数
function ulong CreateJsonContext() system library "PbIdea.dll" alias for "CreateJsonContext"
subroutine DestroyJsonContext(ulong ulContext) system library "PbIdea.dll" alias for "DestroyJsonContext"
subroutine SetJsonContext(ulong ulContext) system library "PbIdea.dll" alias for "SetJsonContext"

//全局选项，目前支持
//rowid,true/false , 是否导出行号，默认为 true
//displaydata,true/false , 是否导出显示值,为false时只导出原始值，默认为 true
//valueasstring , true/false,是否所有DW、DS值都作为字符串导出，默认为 false
//NullToQuotation,true/false,字符型字段为NULL时，导出数据为""，不导出为NULL
//KeyAsTag , true/false , DW导出时，列名默认都是小写。此时是否使用 tag 值作为key
//resetStatus , true/false ,DW导入时，是否把DW的状态置为未修改状态 ，默认 false
//precision, 默认为2，数字转字符串时保留小数位数
//true, 逻辑型转成字符串时对应值, 默认为 "true"
//false, 逻辑型转成字符串时对应值 , 默认为 "false"
subroutine SetOption(readonly string strOption,readonly any val) system library "PbIdea.dll" alias for "SetOption"

//根据二维表，生成父子结构json.这个一般是特殊用途
function uo_json JsonTableToTree(readonly string idName,readonly string pidName,readonly string childName,readonly string initPIDValue) system library "PbIdea.dll" alias for "JsonTableToTree"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//设置为一个空的数组或者对象
subroutine SetArray() system library "PbIdea.dll" alias for "SetArray"
subroutine SetObject() system library "PbIdea.dll" alias for "SetObject"

//json内部排序,ignoreNull 排序时忽略空值，默认为TRUE
subroutine Sort() system library "PbIdea.dll" alias for "jsonSort"
subroutine Sort(boolean ignoreNull) system library "PbIdea.dll" alias for "jsonSort"

//把空值清除掉
subroutine ClearEmptyValue() system library "PbIdea.dll" alias for "jsonClearEmptyValue"

function boolean IsArray() system library "PbIdea.dll" alias for "jsonIsArray"
function boolean IsObject() system library "PbIdea.dll" alias for "jsonIsObject"

function string  GetString(readonly string key) system library "PbIdea.dll" alias for "jsonGetString"
function string  GetString(readonly string key,readonly string defaultValue) system library "PbIdea.dll" alias for "jsonGetString"
function double  GetDouble(readonly string key) system library "PbIdea.dll" alias for "jsonGetDouble"
function long    GetLong(readonly string key) system library "PbIdea.dll" alias for "jsonGetLong"
function longlong  GetLongLong(readonly string key) system library "PbIdea.dll" alias for "jsonGetLongLong"

//解析datawindow语法为json格式
function boolean DatawindowSyntax(datawindow dw) system library "PbIdea.dll" alias for "DatawindowSyntax"
function boolean DatawindowSyntax(datastore  ds) system library "PbIdea.dll" alias for "DatawindowSyntax"

//解析 oracle tns 文件或字符串,tns参数可以是字符串，也可以是tnsnames.ora文件名
function boolean ParseTNS(readonly string tns) system library "PbIdea.dll" alias for "ParseTNS"

//内部使用
subroutine SetDebug(boolean debug) system library "PbIdea.dll" alias for "jsonSetDebug"

//使用指定连接符连接成字符串
function string Join(readonly string ch) system library "PbIdea.dll" alias for "jsonJoin"
function string Join(readonly string ch, boolean ignoreNull) system library "PbIdea.dll" alias for "jsonJoin"

//返回句柄
function ulong GetHandle() system library "PbIdea.dll" alias for "jsonGetHandle"
//读取ini ,形成 json格式
function boolean ReadINI(readonly string iniFile) system library "PbIdea.dll" alias for "jsonReadINI"
//把json格式写成 ini 文件
function boolean WriteINI(readonly string iniFile) system library "PbIdea.dll" alias for "jsonWriteINI"

//msgpack 转换
function blob json2msgpack() system library "PbIdea.dll" alias for "jsonToMsgpack"
function boolean msgpack2json(blob msgpack) system library "PbIdea.dll" alias for "jsonFromMsgpack"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_json_s" id="uo_json_s">uo_json_s</a></div>
<pre><code>
//cn:json标准库函数
//en:Json standard library functions
ulong hJson

private:
function ulong CreateJson() library "PbIdea.dll" alias for "stdjsonCreate"
subroutine DestroyJson(ulong jsonHandle) library "PbIdea.dll" alias for "stdjsonDestroy"
function boolean Parse(ulong jsonHandle,string json) library "PbIdea.dll" alias for "stdjsonParse"
function boolean ParseFile(ulong jsonHandle,string jsonFile) library "PbIdea.dll" alias for "stdParseFile"
function boolean WriteFile(ulong jsonHandle,string jsonFile,boolean bFormat) library "PbIdea.dll" alias for "stdjsonWriteFile"
function ulong   GetStringLen(ulong jsonHandle,boolean bFormat, boolean bCrLn) library "PbIdea.dll" alias for "stdjsonGetStringLen"
function ulong   GetString(ulong jsonHandle,boolean bFormat, boolean bCrLn,ref string lpBuffer,ulong nBufferLen) library "PbIdea.dll" alias for "stdjsonGetString"
function boolean SetUTF8(ulong jsonHandle,ref blob buffer,int bufferLen) library "PbIdea.dll" Alias for "stdjsonSetUTF8"
function long    GetUTF8(ulong jsonHandle,ref blob buffer,int bufferLen) library "PbIdea.dll" Alias for "stdjsonGetUTF8"
Function boolean Clear(ulong jsonHandle) library "PbIdea.dll" Alias for "stdjsonClear"
Function boolean GetError (ulong jsonHandle, ref String strError) library "PbIdea.dll" Alias for "stdjsonGetError"
Subroutine       SetObject  (ulong jsonHandle) library "PbIdea.dll" Alias for "stdjsonSetObject"
Subroutine       SetArray (ulong jsonHandle) library "PbIdea.dll" Alias for "stdjsonSetArray"

//webservice 里要这样声明
//对象
function boolean SetNull   (ulong jsonHandle,string key) library "PbIdea.dll" alias for "stdjsonSetNull"
function boolean SetString (ulong jsonHandle,string key,string value) library "PbIdea.dll" alias for "stdjsonSetString"
function boolean SetInt    (ulong jsonHandle,string key,int value) library "PbIdea.dll" alias for "stdjsonSetInt"
function boolean SetLong   (ulong jsonHandle,string key,long value) library "PbIdea.dll" alias for "stdjsonSetLong"
function boolean SetDouble (ulong jsonHandle,string key,double value) library "PbIdea.dll" alias for "stdjsonSetDouble"
function boolean SetBoolean(ulong jsonHandle,string key,boolean value) library "PbIdea.dll" alias for "stdjsonSetBoolean"
function boolean SetJson   (ulong jsonHandle,string key,ulong hSubJson) library "PbIdea.dll" alias for "stdjsonSetJson"
function boolean SetBytes  (ulong jsonHandle,string key,string fileName) library "PbIdea.dll" alias for "stdjsonSetBytes"

//数组
function boolean SetStringArray (ulong jsonHandle,string value) library "PbIdea.dll" alias for "stdjsonSetStringArray"
function boolean SetIntArray    (ulong jsonHandle,int value) library "PbIdea.dll" alias for "stdjsonSetIntArray"
function boolean SetLongArray   (ulong jsonHandle,long value) library "PbIdea.dll" alias for "stdjsonSetLongArray"
function boolean SetDoubleArray (ulong jsonHandle,double value) library "PbIdea.dll" alias for "stdjsonSetDoubleArray"
function boolean SetBooleanArray(ulong jsonHandle,boolean value) library "PbIdea.dll" alias for "stdjsonSetBooleanArray"
function boolean SetJsonArray   (ulong jsonHandle,ulong hSubJson) library "PbIdea.dll" alias for "stdjsonSetJsonArray"

//
function long     GetStringValue(ulong jsonHandle, string key,ref string buffer,int bufferLen) library "PbIdea.dll" Alias for "stdjsonGetStringValue"
function long     GetLongValue(ulong jsonHandle, string key) library "PbIdea.dll" Alias for "stdjsonGetLongValue"
function longlong GetLongLongValue(ulong jsonHandle, string key) library "PbIdea.dll" Alias for "stdjsonGetLongLongValue"
function double   GetDoubleValue(ulong jsonHandle, string key) library "PbIdea.dll" Alias for "stdjsonGetDoubleValue"
function boolean  GetBooleanValue(ulong jsonHandle, string key) library "PbIdea.dll" Alias for "stdjsonGetBooleanValue"
function ulong    GetJsonValue(ulong jsonHandle, string key) library "PbIdea.dll" Alias for "stdjsonGetJsonValue"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_jwt" id="uo_jwt">uo_jwt</a></div>
<pre><code>
//cn:在网络应用环境间传递声明而执行的一种基于JSON的开放标准
//en:An open standard based on JSON that is implemented by transferring statements between network application environments

uo_json _payload
string  _secret = "" //密钥
string  result  = "" //字符串结果,3段 base64 组成 

//Authorization: Bearer <token>


</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_kafka_consumer" id="uo_kafka_consumer">uo_kafka_consumer</a></div>
<pre><code>
//cn:kafka 消费者
//en:kafka consumer

private:
subroutine ConsumerCreate() system library "PbIdea.dll" alias for "kafkaConsumerCreate"
subroutine ConsumerDestroy() system library "PbIdea.dll" alias for "kafkaConsumerDestroy"

public:
subroutine ConsumerReadConfig(readonly string section,readonly string configFile) system library "PbIdea.dll" alias for "kafkaConsumerReadConfig"
subroutine ConsumerConnect(readonly string brokers,long timeoutms) system library "PbIdea.dll" alias for "kafkaConsumerConnect"
subroutine ConsumerDisconnect() system library "PbIdea.dll" alias for "kafkaConsumerDisconnect"
subroutine ConsumerConfigSet(readonly string key,readonly string value) system library "PbIdea.dll" alias for "kafkaConsumerConfigSet"
function string ConsumerConfigGet(readonly string key) system library "PbIdea.dll" alias for "kafkaConsumerConfigGet"
function string ConsumerGetError() system library "PbIdea.dll" alias for "kafkaConsumerGetError"
function int ConsumerSubscribe(readonly string topic) system library "PbIdea.dll" alias for "kafkaConsumerSubscribe"
subroutine ConsumerUnsubscribe() system library "PbIdea.dll" alias for "kafkaConsumerUnsubscribe"
function boolean ConsumerPoll(long timeout) system library "PbIdea.dll" alias for "kafkaConsumerPoll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_kafka_producer" id="uo_kafka_producer">uo_kafka_producer</a></div>
<pre><code>
//cn:kafka生产者
//en:kafka producer

private:
subroutine ProducerCreate() system library "PbIdea.dll" alias for "kafkaProducerCreate"
subroutine ProducerDestroy() system library "PbIdea.dll" alias for "kafkaProducerDestroy"

public:
subroutine ProducerReadConfig(readonly string section,readonly string configFile) system library "PbIdea.dll" alias for "kafkaProducerReadConfig"
subroutine ProducerConnect(readonly string brokers,long timeoutms) system library "PbIdea.dll" alias for "kafkaProducerConnect"
subroutine ProducerDisconnect() system library "PbIdea.dll" alias for "kafkaProducerDisconnect"
subroutine ProducerConfigSet(readonly string key,readonly string value) system library "PbIdea.dll" alias for "kafkaProducerConfigSet"
function string ProducerConfigGet(readonly string key) system library "PbIdea.dll" alias for "kafkaProducerConfigGet"
function int ProducerSend(readonly string topic,readonly string text) system library "PbIdea.dll" alias for "kafkaProducerSend"
function int ProducerSend(readonly string topic,readonly blob data) system library "PbIdea.dll" alias for "kafkaProducerSend"
function string ProducerGetError() system library "PbIdea.dll" alias for "kafkaProducerGetError"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_kv" id="uo_kv">uo_kv</a></div>
<pre><code>
//key=value database

//键值对本地缓存数据库
private:
subroutine kvCreate() system library "pbidea.dll" alias for "kvCreate"
subroutine kvDestroy() system library "pbidea.dll" alias for "kvDestroy"

public:
//打开数据库，密码为空时不加密. 支持多线程访问。在主线程打开后，其他线程以同名访问时，实际不会重复打开，而是使用它的引用
function boolean Open(readonly string dbName,readonly string password) system library "pbidea.dll" alias for "kvOpen"
//关闭数据库
subroutine Close() system library "pbidea.dll" alias for "kvClose"
//销毁数据库
subroutine DeleteDB() system library "pbidea.dll" alias for "kvDeleteDB"
subroutine DeleteDB(readonly string dbName) system library "pbidea.dll" alias for "kvDeleteDB"
//设置键值对
function boolean Set(readonly string key,readonly any value) system library "pbidea.dll" alias for "kvSet"
//取值
function boolean Get(readonly string key,ref string value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref int value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref long value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref blob value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref double value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref decimal value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref date value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref time value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref datetime value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref real value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref longlong value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(readonly string key,ref any value) system library "pbidea.dll" alias for "kvGet"
function boolean Get(ref uo_json json) system library "pbidea.dll" alias for "kvGet"
//取键列表
function long GetKeyList(ref string keys[]) system library "pbidea.dll" alias for "kvGetKeyList"
//删除指定key
function boolean Remove(readonly string key) system library "pbidea.dll" alias for "kvRemove"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_logfile" id="uo_logfile">uo_logfile</a></div>
<pre><code>
//cn:记录日志,废弃对象，建议使用 uo_logger
//en:Log, abandoned object, recommended uo_logger

//打开日志文件
function boolean OpenFile(readonly string logFile) system library "PbIdea.dll" alias for "OpenLogFile"
subroutine CloseFile() system library "PbIdea.dll" alias for "CloseLogFile"
subroutine Write(readonly string strFormat,...) system library "PbIdea.dll" alias for "WriteLogFile"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_logger" id="uo_logger">uo_logger</a></div>
<pre><code>
//cn:记录日志,支持按大小回滚
//en:Log, support rollback by size

private:
//内置使用，不开放
subroutine loggerCreate() system library "PbIdea.dll" alias for "loggerCreate"
subroutine loggerDestroy() system library "PbIdea.dll" alias for "loggerDestroy"
public:
//打开日志文件
function boolean open(readonly string logFile) system library "PbIdea.dll" alias for "loggerOpen"
//打开日期型日志
function boolean open(readonly string logFile, boolean daily) system library "PbIdea.dll" alias for "loggerOpen"
//打开日志文件,支持设置回滚，当文件达到指定大小时，会滚到下一个文件
function boolean open(readonly string logFile,long max_file_size,int max_file_count) system library "PbIdea.dll" alias for "loggerOpen"
//关闭
subroutine close() system library "PbIdea.dll" alias for "loggerClose"
//日志写入
function boolean info(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerInfo"
function boolean warn(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerWarn"
function boolean error(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerError"
function boolean trace(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerTrace"
function boolean debug(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerDebug"
function boolean critical(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerCritical"

//数据从内存刷新进文件
subroutine Flush() system library "PbIdea.dll" alias for "loggerFlush"

//兼容老对象 uo_logfile 函数用法
function boolean OpenFile(readonly string logFile) system library "PbIdea.dll" alias for "loggerOpen"
function boolean OpenFile(readonly string logFile,long max_file_size,int max_file_count) system library "PbIdea.dll" alias for "loggerOpen"
subroutine CloseFile() system library "PbIdea.dll" alias for "loggerClose"
function boolean Write(readonly string strFormat,...) system library "PbIdea.dll" alias for "loggerInfo"

//utf8
subroutine SetUtf8(boolean utf8) system library "PbIdea.dll" alias for "loggerSetUtf8"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_lua" id="uo_lua">uo_lua</a></div>
<pre><code>
//cn:嵌入式 lua 脚本语言(测试)
//en:Embedded lua scripting language (test)

private:
subroutine luaCreate() system library "PbIdea.dll" alias for "luaCreate"
subroutine luaDestroy() system library "PbIdea.dll" alias for "luaDestroy"
public:
function string run(string code) system library "PbIdea.dll" alias for "luaRun"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_mail" id="uo_mail">uo_mail</a></div>
<pre><code>
//cn:email发送和接收
//en:send/recv email

//发送邮件
function boolean SendMail(readonly string url,readonly string userName,readonly string password,readonly string strFrom,readonly string strFromName,readonly string strTo,readonly string subject,readonly string body,readonly string attachment) system library "PbIdea.dll" alias for "SendMail"
/*
js.set("url", sle_url.text)
js.set("user",sle_username.text)
js.set("password",sle_password.text)
js.set("from",sle_from.text)
js.set("fromname", sle_fromname.text)
js.set("to",sle_to.text)
js.set("/cc/0/mail","") //抄送
js.set("/cc/0/name","") //抄送
js.set("/cc/1/mail","") //抄送
js.set("/cc/1/name","") //抄送
js.set("/bcc/0/mail","") //密送
js.set("/bcc/0/name","") //密送
js.set("/bcc/1/mail","") //密送
js.set("/bcc/1/name","") //密送
js.set("subject", sle_subject.text)
js.set("body",mle_body.text)
js.set("file",sle_attachment.text)
js.set("debug", true)//打开或关闭调试
js.set("debug", false)
*/
function boolean SendMail(uo_json js) system library "PbIdea.dll" alias for "SendMail"
//接收邮件列表
function boolean RecvMail(readonly string url,readonly string userName,readonly string password,ref string uidl[]) system library "PbIdea.dll" alias for "RecvMail"
//接收邮件内容
function uo_json RecvMail(readonly string url,readonly string userName,readonly string password,readonly string uidl) system library "PbIdea.dll" alias for "RecvMail"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_map" id="uo_map">uo_map</a></div>
<pre><code>
//cn:map容器，键值对，自动排序
//en:Map container, key value pair, automatic sorting

private:
function ulong mapCreate() system library "PbIdea.dll" alias for "mapCreate"
subroutine mapDestroy() system library "PbIdea.dll" alias for "mapDestroy"
public:
//取成员个数
function long Size() system library "PbIdea.dll" alias for "mapSize"
//设置一对键值
function long Set(readonly any key,readonly any value) system library "PbIdea.dll" alias for "mapSet"
//根据key移除一个值
function boolean Remove(readonly any key) system library "PbIdea.dll" alias for "mapRemove"
//取一个值,或一组值
function any Get(readonly any key) system library "PbIdea.dll" alias for "mapGet"
function boolean Get(readonly any key,ref any value) system library "PbIdea.dll" alias for "mapGet"
function boolean Get(readonly any key,ref string value) system library "PbIdea.dll" alias for "mapGet"
function boolean Get(readonly any key,ref long value) system library "PbIdea.dll" alias for "mapGet"
//取所有的key列表
function long Keys(ref string keyList[]) system library "PbIdea.dll" alias for "mapGetKeys"
function long Keys(ref string keyList[],boolean softByNum) system library "PbIdea.dll" alias for "mapGetKeys"
//取值列表
function long Values(ref any valueList[]) system library "PbIdea.dll" alias for "mapGetValues"
function long Values(ref any valueList[],string keyFilter) system library "PbIdea.dll" alias for "mapGetValues"
//删除所有成员
subroutine Clear() system library "PbIdea.dll" alias for "mapClear"
//删除空值或无值成员
subroutine Clear(boolean onlyNullValue) system library "PbIdea.dll" alias for "mapClear"
//根据key判断是否存在某成员
function boolean Exist(readonly any key) system library "PbIdea.dll" alias for "mapExist"
//将成员连成一个字符串
function string Join(readonly string strSplit) system library "PbIdea.dll" alias for "mapJoin"
function string Join(readonly string strSplit,boolean equalSign) system library "PbIdea.dll" alias for "mapJoin"
function string Join(readonly string strSplit,boolean equalSign,boolean ignorenull) system library "PbIdea.dll" alias for "mapJoin"
//根据一个字符串，生成map对象。字符串形如：2=222&a=this is a&json=07333434&w_demo=0638C234&xiaohong=0732F6F8&xiaomin=0732F768
function long FromString(readonly string str,readonly string strSplit) system library "PbIdea.dll" alias for "mapFromString"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//返回句柄
function ulong GetHandle() system library "PbIdea.dll" alias for "mapGetHandle"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_menuex" id="uo_menuex">uo_menuex</a></div>
<pre><code>
//menu

//弹出菜单,JSON结构同 menu.json, style
function string PopupMenu(powerobject obj, uo_json jsonMenu) system library "PbIdea.dll" alias for "menuPopupMenu"
function string PopupMenu(powerobject obj, uo_json jsonMenu, int style) system library "PbIdea.dll" alias for "menuPopupMenu"

//设置窗口菜单, window.open, jsonMenu 接收菜单信息, 以便修改后更新
function string AttachMenu(window win, int style) system library "PbIdea.dll" alias for "menuAttachMenu"
function string AttachMenu(window win, int style, uo_json jsonMenu) system library "PbIdea.dll" alias for "menuAttachMenu"
function string AttachMenu(window win, int style, uo_json jsonMenu, userobject menubar) system library "PbIdea.dll" alias for "menuAttachMenu"
//撤销窗口菜单, window.close
subroutine DettachMenu(window win) system library "PbIdea.dll" alias for "menuDettachMenu"
//更新菜单
subroutine UpdateMenu(window win, uo_json jsonMenu) system library "PbIdea.dll" alias for "menuUpdateMenu"
//取控件的坐标位置， postype: 0 左上角， 1 右上角， 3 右下角，其余：左下角
subroutine GetPos(powerobject obj, int postype, ref int x, ref int y) system library "PbIdea.dll" alias for "menuGetPos"
//检索菜单信息，并生成 json
function boolean RetrieveMenu(menu m, uo_json jsonMenu) system library "PbIdea.dll" alias for "menuRetrieveMenu"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_messagebox_options" id="uo_messagebox_options">uo_messagebox_options</a></div>
<pre><code>
//messagebox options
long color_focus_back = -1
long color_focus_text = -1


private:
string options_file = "msgbox_ops.json"

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_messagewidget" id="uo_messagewidget">uo_messagewidget</a></div>
<pre><code>
//cn:消息显示控件
//en:Message display control

//设置风格,例如：
/*
uo_json json
json = create uo_json
json.set("enable",true) //歙消息框有效
json.set("delay",10) //延时30秒自动关闭，如果为0，则不延时，需要手工关闭
json.set("width",480)
json.set("fontname","黑体")
json.set("fontsize",12)
json.set("type",1)  //为0，右下角向上，为1右上角向下

//一组图标颜色
json.set("/color/0",RGB(250,200,180))
json.set("/color/1",RGB(180,250,200))
json.set("/color/2",RGB(250,180,200))
json.set("/color/3",RGB(200,250,180))
json.set("/color/4",RGB(180,200,250))
json.set("/color/5",RGB(200,180,250))
xxxx.setMessageBox(json)
destroy json
*/
subroutine SetMessageBox(uo_json json) system library "pbidea.dll" alias for "msgwidgetSetMessageBox"
//关闭当前对象
subroutine widgetClose() system library "pbidea.dll" alias for "msgwidgetClose"
//添加显示项
/*
uo_json json
json = create uo_json
json.set("title","this is title")
json.set("text","this is text")
json.set("id","id号") //一个唯一的ID号，如果设置了ID，关闭或点击时，会触 发相应事件
json.Set("backcolor", RGB(60, 60, 60));
json.set("delay",10) //延时30秒自动关闭，如果为0，则不延时，需要手工关闭
json.set("fontname","黑体")
json.set("fontsize",12)
xxxx.AddWidget(json)
destroy json
*/
subroutine AddWidget(uo_json json) system library "pbidea.dll" alias for "msgwidgetAddWidget"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_modbus_tcp" id="uo_modbus_tcp">uo_modbus_tcp</a></div>
<pre><code>
//modbus tcp

private:
subroutine mbusCreate() system library "pbidea.dll" alias for "mbusCreate"
subroutine mbusDestroy() system library "pbidea.dll" alias for "mbusDestroy"

public:
//连接到从机
function boolean open(readonly string host,int port) system library "pbidea.dll" alias for "mbusOpen"
//关闭连接
subroutine close() system library "pbidea.dll" alias for "mbusClose"
//设置 slave id
subroutine SetSlaveID(int id) system library "pbidea.dll" alias for "mbusSetSlaveID"
//启动轮询, 参数为 0 时关闭轮询
subroutine SetRetrieveTime(long mseconds) system library "pbidea.dll" alias for "mbusSetRetrieveTime"

//读线圈，功能号 0x01
function boolean ReadCoils(uint address,ref boolean value) system library "pbidea.dll" alias for "mbusReadCoils"
function boolean ReadCoils(uint address,ref boolean value[],uint count) system library "pbidea.dll" alias for "mbusReadCoils"

//读输入，功能号 0x02
function boolean ReadInput(uint address,ref boolean value) system library "pbidea.dll" alias for "mbusReadInput"
function boolean ReadInput(uint address,ref boolean value[],uint count) system library "pbidea.dll" alias for "mbusReadInput"

//读保存寄存器，功能号 0x03
function boolean ReadHoldingRegisters(uint address,ref uint value) system library "pbidea.dll" alias for "mbusReadHoldingRegisters"
function boolean ReadHoldingRegisters(uint address,ref uint value[],uint count) system library "pbidea.dll" alias for "mbusReadHoldingRegisters"

//读输入寄存器，功能号 0x04
function boolean ReadInputRegisters(uint address,ref uint value) system library "pbidea.dll" alias for "mbusReadInputRegisters"
function boolean ReadInputRegisters(uint address,ref uint value[],uint count) system library "pbidea.dll" alias for "mbusReadInputRegisters"

//写线圈，功能号 0x05 , 0x0f
function boolean WriteCoil(uint address,boolean value) system library "pbidea.dll" alias for "mbusWriteCoils"
function boolean WriteCoil(uint address,boolean value[]) system library "pbidea.dll" alias for "mbusWriteCoils"

//写寄存器，功能号 0x06 , 0x10
function boolean WriteRegister(uint address,uint value) system library "pbidea.dll" alias for "mbusWriteRegisters"
function boolean WriteRegister(uint address,uint value[]) system library "pbidea.dll" alias for "mbusWriteRegisters"

//工具函数
//将一个整数大小端互换
function int   SwapNumber(int   num) system library "pbidea.dll" alias for "mbusSwapNumber"
function uint  SwapNumber(uint  num) system library "pbidea.dll" alias for "mbusSwapNumber"
function long  SwapNumber(long  num) system library "pbidea.dll" alias for "mbusSwapNumber"
function ulong SwapNumber(ulong num) system library "pbidea.dll" alias for "mbusSwapNumber"

//构建数据区,参数分别是功能，地址 和 数据长度 ，例如 0x01 ,1, 2
function uo_blob CreateBuffer(uint   func,       uint address) system library "pbidea.dll" alias for "mbusCreateBuffer"
function uo_blob CreateBuffer(string funcHexChar,uint address) system library "pbidea.dll" alias for "mbusCreateBuffer"
function uo_blob CreateBuffer(uint   func,       uint address,uint datalen) system library "pbidea.dll" alias for "mbusCreateBuffer"
function uo_blob CreateBuffer(string funcHexChar,uint address,uint datalen) system library "pbidea.dll" alias for "mbusCreateBuffer"

//向 uo_blob 数据区写入数据，默认追加方式
function int Write(uo_blob buffer,readonly blob data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly string data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly string data,boolean utf8) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly int data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly uint data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly long data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly ulong data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly real data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly decimal data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,readonly double data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly blob data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly string data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly string data,boolean utf8) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly string data,boolean utf8,boolean endflag) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly int data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly uint data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly long data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly ulong data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly real data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly decimal data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
function int Write(uo_blob buffer,int pos,readonly double data) system library "PbIdea.dll" alias for "mbusWriteBuffer"
//写入字节
function int WriteByte(uo_blob buffer,int data) system library "PbIdea.dll" alias for "mbusWriteByte"
function int WriteByte(uo_blob buffer,int b8,int b7,int b6,int b5,int b4,int b3,int b2,int b1) system library "PbIdea.dll" alias for "mbusWriteByte"
function int WriteByte(uo_blob buffer,int pos,int data) system library "PbIdea.dll" alias for "mbusWriteByte"
function int WriteByte(uo_blob buffer,int pos,int b8,int b7,int b6,int b5,int b4,int b3,int b2,int b1) system library "PbIdea.dll" alias for "mbusWriteByte"

//从 uo_blob 数据区读数据，可以连续读
function int Read(uo_blob buffer,ref int data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref uint data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref long data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref ulong data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref real data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref double data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,ref decimal data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref int data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref uint data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref long data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref ulong data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref real data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref double data) system library "PbIdea.dll" alias for "mbusReadBuffer"
function int Read(uo_blob buffer,int pos,ref decimal data) system library "PbIdea.dll" alias for "mbusReadBuffer"
//读入字节，可以连续读
function int ReadByte(uo_blob buffer,ref int data) system library "PbIdea.dll" alias for "mbusReadByte"
function int ReadByte(uo_blob buffer,ref int b8,ref int b7,ref int b6,ref int b5,ref int b4,ref int b3,ref int b2,ref int b1) system library "PbIdea.dll" alias for "mbusReadByte"
function int ReadByte(uo_blob buffer,int pos,ref int data) system library "PbIdea.dll" alias for "mbusReadByte"
function int ReadByte(uo_blob buffer,int pos,ref int b8,ref int b7,ref int b6,ref int b5,ref int b4,ref int b3,ref int b2,ref int b1) system library "PbIdea.dll" alias for "mbusReadByte"

//同步发送数据区并获取结果.如果使用uo_blob response参数，直接返回响应结果。
function boolean request(uo_blob data,uo_blob response) system library "pbidea.dll" alias for "mbusRequest"
//异步发送数据区并获取结果，从事件 on_response里返回结果，对反应比较迟钝的应用比较合适.
function boolean request(uo_blob data) system library "pbidea.dll" alias for "mbusRequest"

function string GetError() system library "pbidea.dll" alias for "mbusGetError"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_monitor" id="uo_monitor">uo_monitor</a></div>
<pre><code>
//cn:多显示器管理
//en:Multi display management

//取屏蔽列表
function int GetMonitorList(uo_json json) system library "PbIdea.dll" alias for "monGetMonitorList"
//取屏幕个数
function int GetMonitorCount( ) system library "PbIdea.dll" alias for "monGetMonitorCount"
//屏蔽显示到所有屏上
subroutine CloneMonitor( ) system library "PbIdea.dll" alias for "monCloneMonitor"
//旋转显示屏 ，参数为 270 180 90 0 或 3 2 1 0
subroutine RotateMonitor(int angle ) system library "PbIdea.dll" alias for "monRotateMonitor"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_mouseevent" id="uo_mouseevent">uo_mouseevent</a></div>
<pre><code>
//cn:模拟鼠标点击
//en:Simulate mouse clicks

constant long  MOUSEEVENTF_ABSOLUTE   = 32768
constant long  MOUSEEVENTF_LEFTDOWN   = 2
constant long  MOUSEEVENTF_LEFTUP     = 4
constant long  MOUSEEVENTF_MIDDLEDOWN = 32
constant long  MOUSEEVENTF_MIDDLEUP   = 64
constant long  MOUSEEVENTF_MOVE       = 1
constant long  MOUSEEVENTF_RIGHTDOWN  = 8
constant long  MOUSEEVENTF_RIGHTUP    = 16

Subroutine mouse_event(Ulong dwflag, Ulong dx, Ulong dy, Ulong cbutton, Ulong dwextra) library "user32.dll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_mqtt" id="uo_mqtt">uo_mqtt</a></div>
<pre><code>
//cn:mqtt客户端
//en:mqtt client

//设置持久化对象，由自己完成持久化。如果不设置持久化对象，默认保存在内存。
//持久化,可以在 uo_json,uo_database等各种存储对象，在事件中自己实现
subroutine SetPersistence(boolean enabled) system library "pbidea.dll" alias for "mqttSetPersistence"
//连接服务端
function boolean open(string uri,string user,string password,string clientid) system library "pbidea.dll" alias for "mqttOpen"
function boolean open(string uris[],string user,string password,string clientid) system library "pbidea.dll" alias for "mqttOpen"
//断开连接
function boolean close() system library "pbidea.dll" alias for "mqttClose"
//订阅主题,qos 0:最多一次 1:至少一次 2:恰好一次,默认为2
function boolean subscribe(string topic) system library "pbidea.dll" alias for "mqttSubscribe"
function boolean subscribe(string topic,int qos) system library "pbidea.dll" alias for "mqttSubscribe"
//取消订阅主题
function boolean unsubscribe(string topic) system library "pbidea.dll" alias for "mqttUnsubscribe"
//发布,qos 0:最多一次 1:至少一次 2:恰好一次,默认为2
function boolean publish(string topic,string msg) system library "pbidea.dll" alias for "mqttPublish"
function boolean publish(string topic,string msg,int qos) system library "pbidea.dll" alias for "mqttPublish"
//retain 为是否保留。默认为保留，即主题订阅时会接收到最后一条消息.删除保留，发送一条长度为0，qos=0,retain=1的消息即可
function boolean publish(string topic,string msg,int qos,int retain) system library "pbidea.dll" alias for "mqttPublish"
//token : 返回一个唯一标志号，用于在事件里判断是否发送成功
function boolean publish(string topic,string msg,int qos,int retain,ref long token) system library "pbidea.dll" alias for "mqttPublish"
//发布,qos 0:最多一次 1:至少一次 2:恰好一次,默认为2
function boolean publish(string topic,blob msg) system library "pbidea.dll" alias for "mqttPublish"
function boolean publish(string topic,blob msg,int qos) system library "pbidea.dll" alias for "mqttPublish"
//retain 为是否保留。默认为保留，即主题订阅时会接收到最后一条消息.删除保留，发送一条长度为0，qos=0,retain=1的消息即可
function boolean publish(string topic,blob msg,int qos,int retain) system library "pbidea.dll" alias for "mqttPublish"
//token : 返回一个唯一标志号，用于在事件里判断是否发送成功
function boolean publish(string topic,blob msg,int qos,int retain,ref long token) system library "pbidea.dll" alias for "mqttPublish"
//是否连接
function boolean isconnected() system library "pbidea.dll" alias for "mqttIsConnected"
//错误信息
function string lasterror() system library "pbidea.dll" alias for "mqttLastError"
//设置消息提示框
subroutine SetMessageBox(uo_json json) system library "pbidea.dll" alias for "mqttSetMessageBox"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_ofdreader" id="uo_ofdreader">uo_ofdreader</a></div>
<pre><code>
//ofd reader

public:
//ofd to pdf
function boolean ofd2pdf(readonly string ofdfile, readonly string pdffile) system library "pbidea.dll" alias for "ofd2pdf"
function blob ofd2pdf(readonly string ofdfile) system library "pbidea.dll" alias for "ofd2pdf"
function int ofd2svg(readonly string ofdfile, readonly string outdir, ref string svgfiles[]) system library "pbidea.dll" alias for "ofd2svg"
function int ofd2png(readonly string ofdfile, readonly string outdir, double scale, ref string pngfiles[]) system library "pbidea.dll" alias for "ofd2png"

//绑定到可视对象
function boolean BindView(userobject view) system library "pbidea.dll" alias for "ofdBindView"
//对象销毁时解绑
subroutine UnBindView() system library "pbidea.dll" alias for "ofdUnBindView"
//打开文档
function boolean open(readonly string file) system library "pbidea.dll" alias for "ofdOpen"
function boolean open(readonly blob data) system library "pbidea.dll" alias for "ofdOpen"
//关闭
subroutine Close() system library "pbidea.dll" alias for "ofdClose"
//获取总页数
function int GetPageCount() system library "pbidea.dll" alias for "ofdGetPageCount"
//获取指定页的内容，通常对发票更有用
function boolean GetContext(int page, ref uo_json json) system library "pbidea.dll" alias for "ofdGetContext"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_ofdserver" id="uo_ofdserver">uo_ofdserver</a></div>
<pre><code>
//ofd server, 内置http服务，提供转换服务
//例如:
//	curl -X POST -F "file=@1.ofd" -o output.pdf http://218.94.103.156:9000/ofd2pdf
//	curl -X POST -F "file=@1.ofd" -o output.png http://218.94.103.156:9000/ofd2png?page=1&scale=2
//	curl -X POST -F "file=@1.ofd" -o output.svg http://218.94.103.156:9000/ofd2svg?page=1

//启动服务
function boolean StartServer(readonly string ip, int port, readonly string ofddir, readonly string rootdir) system library "pbidea.dll" alias for "ofdStartServer"
//停止服务
function boolean StopServer() system library "pbidea.dll" alias for "ofdStopServer"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_ofdview" id="uo_ofdview">uo_ofdview</a></div>
<pre><code>
uo_ofdreader ofd

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_orca" id="uo_orca">uo_orca</a></div>
<pre><code>
//orca

//初始化 session,必须
function boolean OpenSession() system library "pbidea.dll" alias for "orcaOpenSession"
subroutine CloseSession() system library "pbidea.dll" alias for "orcaCloseSession"
//library 管理
function boolean CreateLibrary(readonly string libName) system library "pbidea.dll" alias for "orcaCreateLibrary"
subroutine DeleteLibrary(readonly string libName) system library "pbidea.dll" alias for "orcaDeleteLibrary"
//设置库列表
function boolean SetLibraryList(readonly string libList) system library "pbidea.dll" alias for "orcaSetLibraryList"
function int GetLibraryList(ref string libs[]) system library "pbidea.dll" alias for "orcaGetLibraryList"
//对象管理
function boolean ImportEntry(readonly string libName, readonly string entryName,readonly string objType, readonly string syntax, readonly string comment) system library "pbidea.dll" alias for "orcaImportEntry"
function boolean ImportEntry(readonly string libName[], readonly string entryName[],readonly string objType[], readonly string syntax[], readonly string comment[]) system library "pbidea.dll" alias for "orcaImportEntry"
function boolean EntryExists(readonly string libName, readonly string entryName) system library "pbidea.dll" alias for "orcaEntryExists"
function boolean DeleteEntry(readonly string libName, readonly string entryName) system library "pbidea.dll" alias for "orcaDeleteEntry"
function string ExportEntry(readonly string libName, readonly string entryName) system library "pbidea.dll" alias for "orcaExportEntry"
function int GetEntryList(readonly string libName, ref string entryNames[], ref string types[]) system library "pbidea.dll" alias for "orcaGetEntryList"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_painter" id="uo_painter">uo_painter</a></div>
<pre><code>
//cn:画板工具，非常强大的图形处理功能
//en:Drawing board tool, very powerful graphics processing function

private:
//这两个函数在uo_painter内部使用
subroutine painterCreate() system library "PbIdea.dll" alias for "painterCreate"
subroutine painterDestroy() system library "PbIdea.dll" alias for "painterDestroy"
public:
//释放系统资源和内存
subroutine Clear() system library "PbIdea.dll" alias for "painterClear"
//以指定颜色填充背景
subroutine ClearBackground(long clr) system library "PbIdea.dll" alias for "painterClearBackground"
/*
在一个HDC上开始一次绘制
hdc      : HDC句柄
clr      : 一个初始背景颜色
x        : 
y        :
width    :
height   :
obj      : PB 对象名，可视对象
bInWM_PAINT : 是否在 pbm_paint 消息里面,内部会运行GDI的 BeginPaint/EndPaint 函数
imageID  : 在一张图上开始绘制
*/
function boolean BeginPaint(ulong hdc,ulong clr) system library "PbIdea.dll" alias for "painterBeginPaint"
function boolean BeginPaint(ulong hdc,ulong clr,int alpha) system library "PbIdea.dll" alias for "painterBeginPaint"
function boolean BeginPaint(ulong hdc,int width,int height) system library "PbIdea.dll" alias for "painterBeginPaint2"
function boolean BeginPaint(ulong hdc,int width,int height,ulong clr) system library "PbIdea.dll" alias for "painterBeginPaint2"
function boolean BeginPaint(ulong hdc,int x,int y,int width,int height,ulong clr) system library "PbIdea.dll" alias for "painterBeginPaint2"
function boolean BeginPaint(dragobject obj,ulong clr) system library "PbIdea.dll" alias for "painterBeginPaint3"
function boolean BeginPaint(dragobject obj,ulong clr,boolean bInWM_PAINT) system library "PbIdea.dll" alias for "painterBeginPaint3"
function ulong GetDC() system library "PbIdea.dll" alias for "painterGetDC"
//imageID  : 在一张图上开始绘制
function boolean BeginPaintImage(long imageID) system library "PbIdea.dll" alias for "painterBeginPaintImage"
//创建一张空白图，开始绘制
function boolean BeginPaintImage(int width,int height,ulong clrBack) system library "PbIdea.dll" alias for "painterBeginPaintImage"
function boolean BeginPaintImage(int width,int height,ulong clrBack,int alpha) system library "PbIdea.dll" alias for "painterBeginPaintImage"
//结束绘制，将绘制的内容刷新到HDC上，或者图片上
subroutine EndPaint() system library "PbIdea.dll" alias for "painterEndPaint"
//从不同介质加载一张图，返回一个 nImageID ，保存起来留作后用
function long CacheImage(readonly string fileName) system library "PbIdea.dll" alias for "painterCacheImage"
function long CacheImage(readonly string fileName,int alpha) system library "PbIdea.dll" alias for "painterCacheImage"
function long CacheImage(readonly blob image) system library "PbIdea.dll" alias for "painterCacheImageFromBlob"
function long CacheImage(readonly blob image,int alpha) system library "PbIdea.dll" alias for "painterCacheImageFromBlob"
function long CacheImageBase64(readonly string fileOrBase64,int alpha) system library "PbIdea.dll" alias for "painterCacheImageBase64"
//从一个指定image中的指定位置和宽高，复制一块图像并缓存
function long CopyImage(long nImageID,int x,int y,int width,int height) system library "PbIdea.dll" alias for "painterCopyImage"

////从不同介质加载一张图的缩略图，返回一个 nImageID ，保存起来留作后用
function long CacheImageThumb(readonly string fileName,int alpha,double scale) system library "PbIdea.dll" alias for "painterCacheImageThumb"
function long CacheImageThumb(readonly blob image,int alpha,double scale) system library "PbIdea.dll" alias for "painterCacheImageThumbFromBlob"
//截取屏幕，返回一个 nImageID ，保存起来留作后用
function long GrabWindow(int x,int y,int width,int height) system library "PbIdea.dll" alias for "painterGrabWindow"
function long GrabWindow(ulong hwnd) system library "PbIdea.dll" alias for "painterGrabWindow"
function long GrabWindow(ulong hwnd,int x,int y,int width,int height) system library "PbIdea.dll" alias for "painterGrabWindow"
//释放一张缓存的图片
subroutine RemoveImage(long imageID) system library "PbIdea.dll" alias for "painterRemoveImage"

//将一张缓存图另存为文件，imageExt ,后缀名.jpg / jpg ...
function blob ImageToBlob(long imageID,string imageExt) system library "PbIdea.dll" alias for "painterImageToBlob"
//将当前画板另存为文件
function boolean SaveImage(string fileName) system library "PbIdea.dll" alias for "painterSaveImage"
//将一个缓存图片另存为文件
function boolean SaveImage(long imageID,string fileName) system library "PbIdea.dll" alias for "painterSaveImage"
/*
image/bmp
image/jpeg
image/gif
image/x-emf
image/x-wmf
image/tiff
image/png
image/x-icon
*/
//将一个缓存图片另存为文件,显示指定文件类型
function boolean SaveImage(long imageID,string imageType,string fileName) system library "PbIdea.dll" alias for "painterSaveImage"
//将内存里作为画板的那张图的内容保存为文件
function boolean SaveMemoryImage(string fileName) system library "PbIdea.dll" alias for "painterSaveMemoryImage"
//将内存里作为画板的那张图的内容作为 blob 取出来
function blob GetMemoryImage(string ImageExt) system library "PbIdea.dll" alias for "painterGetMemoryImage"
function blob GetMemoryImage(string ImageExt, int bitcount) system library "PbIdea.dll" alias for "painterGetMemoryImage"
function boolean GetMemoryImage(string ImageExt, int bitcount, readonly string file) system library "PbIdea.dll" alias for "painterGetMemoryImage"
//提交画图内容到屏幕
subroutine Paint() system library "PbIdea.dll" alias for "painterPaint"
//获取画板的width,height
function int GetWidth() system library "PbIdea.dll" alias for "painterGetWidth"
function int GetHeight() system library "PbIdea.dll" alias for "painterGetHeight"
//设置画板的透明度，0，完全 透明 ，255，完全不透明 ，1-254，不同透明度
subroutine SetAlpha(int value) system library "PbIdea.dll" alias for "painterSetAlpha"
//设置某张缓存图片的透明度，0，完全 透明 ，255，完全不透明 ，1-254，不同透明度
subroutine SetImageAlpha(long imageID,int value) system library "PbIdea.dll" alias for "painterSetImageAlpha"
//画线
subroutine DrawLine(int x1,int y1,int x2,int y2,int width,int style,ulong clr) system library "PbIdea.dll" alias for "painterDrawLine"
//画文本
subroutine DrawText(int x,int y,int width,int height,readonly string text,readonly string fontName,int fontSize,ulong clr,int align) system library "PbIdea.dll" alias for "painterDrawText"
subroutine DrawText(int x,int y,int width,int height,readonly string text,readonly string fontName,int fontSize,boolean bold,boolean italic,ulong clr,int align,int angle,int RouteOffsetX,int RouteOffsetY,boolean wrap,boolean Smooth) system library "PbIdea.dll" alias for "painterDrawTextEx"
//画一个字符，安装了 iconfont 字体后,可以用这个函数来画 iconfont 图标
subroutine DrawText(int x,int y,int width,int height,readonly long ch,readonly string fontName,int fontSize,ulong clr,int align) system library "PbIdea.dll" alias for "painterDrawText"
//画一张缓存图
subroutine DrawImage(int x,int y,int width,int height,long imageID,int angle) system library "PbIdea.dll" alias for "painterDrawImage"
//增加一个坐标点，以备后面函数连续绘制使用
subroutine AddPoint(int x,int y) system library "PbIdea.dll" alias for "painterAddPoint"
//画多边形
function boolean PointInPolygon(int x,int y) system library "PbIdea.dll" alias for "painterPointInPolygon"
//画多条线
subroutine DrawLines(int width,int style,ulong clr,boolean clear,int drawMode) system library "PbIdea.dll" alias for "painterDrawLines"
//画curve线
subroutine DrawCurve(int width,int style,ulong clr,boolean clear,int drawMode) system library "PbIdea.dll" alias for "painterDrawCurve"
//画贝赛尔曲线
subroutine DrawBezier(int width,int style,ulong clr,boolean clear) system library "PbIdea.dll" alias for "painterDrawBezier"
//画多边形
subroutine DrawPolygon(int width,int style,ulong clr,boolean fill,boolean clear) system library "PbIdea.dll" alias for "painterDrawPolygon"
//画条状图
subroutine DrawBar(int x,int y,int width,int height,ulong clr,boolean is3d) system library "PbIdea.dll" alias for "painterDrawBar"
//画圆角矩形
subroutine DrawRoundRect(int x,int y,int width,int height,int percentageRounded,int borderWidth,int style,ulong clr,boolean fill) system library "PbIdea.dll" alias for "painterDrawRoundRect"
//画菱形
subroutine DrawRhombus(int x,int y,int width,int height,int borderWidth,int style,ulong clr,boolean fill) system library "PbIdea.dll" alias for "painterDrawRhombus"
//画箭头
subroutine DrawArrow(int x1,int y1,int x2,int y2,int width,int style,ulong clr,int format) system library "PbIdea.dll" alias for "painterDrawArrow"
//画椭圆
subroutine DrawEllipse(int x,int y,int width,int height,int borderWidth,int style,ulong clr,boolean fill) system library "PbIdea.dll" alias for "painterDrawEllipse"
//画扇形
subroutine DrawPie(int x, int y, int r, int BeginAngle, int EndAngle, int nMoveOut, int BorderWidth, int style, long clr, boolean bFill) system library "PbIdea.dll" alias for "painterDrawPie"
//计算一个给字字符串在特定字体字号情况下的空间尺寸
subroutine CalcTextSize(string str, string strFontName, int nFontsize, ref int nWidth, ref int nHeight) system library "PbIdea.dll" alias for "painterCalcTextSize"
//安装进程内的字体
function int InstallFontPlus(string fontName) system library "PbIdea.dll" alias for "painterInstallFontPlus"
//缺省安装内嵌的 awesome.ttf 图标字体，安装后可使用字体名 awesome 来绘制图标
function int InstallFontPlus() system library "PbIdea.dll" alias for "painterInstallFontPlus"
//获取缓存图片的大小
function boolean GetImageSize(long imageID,ref int width,ref int height) system library "PbIdea.dll" alias for "painterGetImageSize"
//合并图片初始化为一个X*Y的矩形形区
function boolean MergeImageInit(int nMargin, int nImageMargin, boolean bBorder, int nRows, int nCols, ulong clrBack, string strBackImage, int nAlpha, boolean bStreth, string strSaveImage) system library "PbIdea.dll" alias for "painterMergeImageInit"
//合并图片添加
function boolean MergeImageAdd(double nRow, double nCol, double nRows, double nCols, string strImage, int nAlpha, int nRotate) system library "PbIdea.dll" alias for "painterMergeImageAdd"
//设置单元格大小
function boolean MergeImageSetCellSize(int nWidth, int nHeight) system library "PbIdea.dll" alias for "painterMergeImageSetCellSize"
//完成合并图
function boolean MergeImage() system library "PbIdea.dll" alias for "painterMergeImage"
//获取一个随机颜色组，颜色色谱一致
function string GetColorGroup(int nCount) system library "PbIdea.dll" alias for "painterGetColorGroup"

//设置一个可视对象为画布对象，从而可以响应对象的WM_PAINT消息，具体事件名由eventName指定，带有一个参数，例如  ue_paint(HDC hdc),在这个事件里处理绘制工作
function boolean SetCanvas(powerobject obj,string eventName) system library "PbIdea.dll" alias for "painterSetCanvas"

//设置剪裁区域 
subroutine SetClipRoundRect(int x, int y, int nWidth, int nHeight,int radius,boolean except) system library "PbIdea.dll" alias for "painterSetClip"
subroutine SetClipElliptic(int x, int y, int nWidth, int nHeight,boolean except) system library "PbIdea.dll" alias for "painterSetClip"
subroutine SetClipPolygon(int x[], int y[], boolean except) system library "PbIdea.dll" alias for "painterSetClip"
subroutine SetClipImage(string imageFile,ulong clrMask, boolean except) system library "PbIdea.dll" alias for "painterSetClip"
//清除剪裁区域 
subroutine ResetClip() system library "PbIdea.dll" alias for "painterResetClip"

//获取内嵌图标符号列表
function long GetIconList(ref ulong iconChars[]) system library "PbIdea.dll" alias for "painterGetIconList"
//用指定图标符号生成PNG文件
function boolean IconCharToPng(ulong iconChar,long color,int size,string pngFile) system library "PbIdea.dll" alias for "painterCharToPng"
//用指定图标符号生成BMP文件
function boolean IconCharToBmp(ulong iconChar,long color,long colorBack,int size,string bmpFile) system library "PbIdea.dll" alias for "painterCharToBmp"
//用指定图标符号生成WMF文件
function boolean IconCharToWmf(ulong iconChar,long color,long colorBack,int size,string wmfFile) system library "PbIdea.dll" alias for "painterCharToWmf"


//winapi
FUNCTION ulong GetDeviceCaps(ulong hdc,ulong nIndex) LIBRARY "gdi32.dll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_pdfmaker" id="uo_pdfmaker">uo_pdfmaker</a></div>
<pre><code>
//cn:生成PDF,dw2pdf
//en:Generate PDF, dw2pdf

//把一个 datawindow 内容以虚拟打印的方式输出到PDF，或者 bmp,jpg,png类型文件，具体输出类型以文件扩展名区分
function boolean PrintDatawindow(datawindow dw,string fileName) system library "PbIdea.dll" alias for "dwPrintDatawindow"
function boolean PrintDatawindow(datawindow dw,string fileName,uo_json pdfoption) system library "PbIdea.dll" alias for "dwPrintDatawindow"

function boolean PrintDatawindow(datastore ds,string fileName) system library "PbIdea.dll" alias for "dwPrintDatawindow"
function boolean PrintDatawindow(datastore ds,string fileName,uo_json pdfoption) system library "PbIdea.dll" alias for "dwPrintDatawindow"

function blob PrintDatawindow(datawindow dw) system library "PbIdea.dll" alias for "dwPrintDatawindow"
function blob PrintDatawindow(datastore ds) system library "PbIdea.dll" alias for "dwPrintDatawindow"
function blob PrintDatawindow(datawindow dw, uo_json pdfoption) system library "PbIdea.dll" alias for "dwPrintDatawindow"
function blob PrintDatawindow(datastore ds, uo_json pdfoption) system library "PbIdea.dll" alias for "dwPrintDatawindow"

//设置dw2pdf 的参数打印机，也可以通过设置环境变量 DW2PDF_PRINTER ，达到同样效果
function boolean SetPdfPrinter(readonly string printerName) system library "PbIdea.dll" alias for "SetPdfPrinter"

//function boolean image2pdf(string fileFilter,string pdf) system library "PbIdea.dll" alias for "image2pdf"

//function boolean Json2Pdf(uo_json jsPDF,string fileName) system library "PbIdea.dll" alias for "pdfJson2Pdf"

subroutine SetWaterMaker(readonly string text,long color,int angle) system library "PbIdea.dll" alias for "pdfSetWaterMaker"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_pdfview" id="uo_pdfview">uo_pdfview</a></div>
<pre><code>
//cn:pdf浏览控件
//en:Pdf browse control
/*
1.支持键盘: 
	Home 到最前
	End  到最后
	方向键 鼠标滚轮 上下跳动一行
	PageDown PageUp 上下跳动一页
	ctrl++ ctrl+- ctrl+< ctrl+> ctrl+鼠标滚轮 放大或缩小
	ctrl+r ctrl+l 逆时针或顺时针旋转
	ctrl+s 另存
	ctrl+p 打印
	ctrl+f 查找
*/

//工具条按钮ID定义
constant int  BUTTON_PAGE_PREV     = 201
constant int  BUTTON_PAGE_NEXT     = 202
constant int  BUTTON_ZOOM_LARGE    = 203
constant int  BUTTON_ZOOM_SMALL    = 204
constant int  BUTTON_ROATE_LEFT    = 205
constant int  BUTTON_ROATE_RIGHT   = 206
constant int  BUTTON_SAVE_AS       = 207
constant int  BUTTON_PRINT         = 208
constant int  BUTTON_FIND          = 209
constant int  BUTTON_SIGN          = 210
constant int  BUTTON_ABOUT         = 211

private:
subroutine pdfCreate() system library "PbIdea.dll" alias for "pdfCreate"
subroutine pdfDestroy() system library "PbIdea.dll" alias for "pdfDestroy"

public:
//打开一个PDF文件
function boolean Load(readonly string pdfFile) system library "PbIdea.dll" alias for "pdfLoad"
function boolean Load(readonly string pdfFile,int gotoPage) system library "PbIdea.dll" alias for "pdfLoad"
//打开 PDF 二进制数据
function boolean Load(readonly blob pdfData) system library "PbIdea.dll" alias for "pdfLoad"
function boolean Load(readonly blob pdfData,int gotoPage) system library "PbIdea.dll" alias for "pdfLoad"
//关闭已打开的PDF文件
subroutine Close() system library "PbIdea.dll" alias for "pdfClose"
//获取 PDF 页数
function long GetPageCount() system library "PbIdea.dll" alias for "pdfGetPageCount"
//取得指定页的BITMAP数据，或写入文件
function blob LoadPage(int pageIndex,int nWidth,int nHeight) system library "PbIdea.dll" alias for "pdfLoadPage"
function blob LoadPage(int pageIndex,int nWidth,int nHeight,double bl) system library "PbIdea.dll" alias for "pdfLoadPage"
function blob LoadPage(int pageIndex,int nWidth,int nHeight,readonly string file) system library "PbIdea.dll" alias for "pdfLoadPage"
function blob LoadPage(int pageIndex,int nWidth,int nHeight,readonly string file, double bl) system library "PbIdea.dll" alias for "pdfLoadPage"
//取得指定页的文本内容
function string GetPageText(int pageIndex) system library "PbIdea.dll" alias for "pdfGetPageText"
function long GetPageText(int pageIndex,ref string sText[],ref string strPosition[]) system library "PbIdea.dll" alias for "pdfGetPageText"
//int offsetX, int offsetY 用于发票识别
//offsetX指前一文本与后一文本的字间距在这个范围则视同为同一句
//offsetY指不同Y坐标的差异在范围内，视同为同一行
function long GetPageText(int pageIndex,uo_json result, int offsetX, int offsetY) system library "PbIdea.dll" alias for "pdfGetPageText"
//直接从某文件中取
function boolean GetPageText(readonly string pdffile,uo_json result) system library "PbIdea.dll" alias for "pdfGetPageText"

//打印,是否显示打印对话框
subroutine Print(boolean showPrintDialog) system library "PbIdea.dll" alias for "pdfPrint"
subroutine Print(string printerName) system library "PbIdea.dll" alias for "pdfPrint"
/*
使用 json 作为参数配置文件.json参数：
showPrintDialog,true/false  //是否显示打印对话框
printerName,"" //打印机名称
paperSize,n    //纸张大小，256为自定义纸张，9为A4，其他自行参考DW纸张信息
paperWidth,n.m   //纸张宽度，自定义纸张时有效，单位:cm，可以是小数
paperHeight,n.m  //纸张高度，自定义纸张时有效，单位:cm,可以是小数
paperOrientation, 1/2 ，纸张方向，1纵 2 横
rotate,n //0 不旋转, 1 旋转90度
pageIndex,n 指定打印页
*/
subroutine Print(uo_json options) system library "PbIdea.dll" alias for "pdfPrint"
//获取页面尺寸大小
function int GetPageWidth(int pageIndex) system library "PbIdea.dll" alias for "pdfGetPageWidth"
function int GetPageHeight(int pageIndex) system library "PbIdea.dll" alias for "pdfGetPageHeight"
//将指定图片插入页面的指定位置。pageIndex为0时插入所有页面，nWidth和nHeight为0时，按图片尺寸插入,alpha介于0-255时，0为全透明，255为全不透明 
function boolean InsertImage(readonly string imageFile, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha) system library "PbIdea.dll" alias for "pdfInsertImage"
//maskColor,将这种颜色设置为透明
function boolean InsertImage(readonly string imageFile, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha,ulong maskColor) system library "PbIdea.dll" alias for "pdfInsertImage"
function boolean InsertImage(readonly string imageFile, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha,ulong maskColor,boolean bFixed) system library "PbIdea.dll" alias for "pdfInsertImage"
//将指定图片插入页面的指定位置。pageIndex为0时插入所有页面，nWidth和nHeight为0时，按图片尺寸插入,alpha介于0-255时，0为全透明，255为全不透明 
function boolean InsertImage(readonly blob imageData, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha) system library "PbIdea.dll" alias for "pdfInsertImage"
//maskColor,将这种颜色设置为透明
function boolean InsertImage(readonly blob imageData, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha,ulong maskColor) system library "PbIdea.dll" alias for "pdfInsertImage"
function boolean InsertImage(readonly blob imageData, int pageIndex,int nX,int nY,int nWidth,int nHeight,int alpha,ulong maskColor,boolean bFixed) system library "PbIdea.dll" alias for "pdfInsertImage"
//另存
function boolean SaveAs(readonly string newPdfFile) system library "PbIdea.dll" alias for "pdfSaveAs"
function blob SaveAsBlob() system library "PbIdea.dll" alias for "pdfSaveAsBlob"
//合并多个PDF文件为一个PDF文件
function boolean MeargePDF(readonly string pdfs[],readonly string newPdf) system library "PbIdea.dll" alias for "pdfMeargePDF"
//将一个PDF文件按页分割成多个PDF文件. pdffile: 源文件; prefix: 新文件名前缀，可以是路径加文件名前缀; pdfs[] 返回文件数组
function int SplitPDF(readonly string pdffile, readonly string prefix, ref string pdfs[]) system library "PbIdea.dll" alias for "pdfSplitPDF"
//参数同上. byBookmark 按照书签拆分
function int SplitPDF(readonly string pdffile, readonly string prefix, ref string pdfs[], boolean byBookmark) system library "PbIdea.dll" alias for "pdfSplitPDF"
//参数同上. keywordDefine: 一个 json,用于关键字等定义. 
/*
uo_json kwdef; kwdef = create uo_json
//定义key长度范围
kwdef.set("keylen1", 10)
kwdef.set("keylen2", 10)
//定义坐标及值偏移范围
kwdef.set("x", 604)
kwdef.set("xoffset", 16)
kwdef.set("y", 1012)
kwdef.set("yoffset", 16)
*/
function int SplitPDF(readonly string pdffile, readonly string prefix, ref string pdfs[], uo_json keywordDefine) system library "PbIdea.dll" alias for "pdfSplitPDF"

//设置关于工具栏按钮的文本内容
function blob SetHelpText(readonly string helpText) system library "PbIdea.dll" alias for "pdfSetHelpText"
//移除一个工具条按钮
subroutine RemoveToolButton(int buttonID) system library "PbIdea.dll" alias for "pdfRemoveToolButton"
//显示、隐藏工具条
subroutine ShowToolBar(boolean showToolBar) system library "PbIdea.dll" alias for "pdfShowToolBar"
//设置工具条文本,{"201":{"text":"prev page","icon":64924},"202":{"text":"next page","icon":64925}}
subroutine SetToolbarText(uo_json json) system library "PbIdea.dll" alias for "pdfSetToolbar"
//打开签名对话框
function blob ShowSignDialog() system library "PbIdea.dll" alias for "pdfShowSignDialog"
//旋转，参数 0 逆时针 1 顺时针
subroutine pdfRotate(int direction) system library "PbIdea.dll" alias for "pdfRotate"
//代码触发工具条按钮
subroutine TriggerButton(int button) system library "PbIdea.dll" alias for "pdfTriggerButton"

//画线
function boolean DrawLine(int page, int x1, int y1, int x2, int y2, long clr, double width) system library "PbIdea.dll" alias for "pdfDrawLine"
function boolean DrawLine(int page, int x1, int y1, int x2, int y2, long clr, double width, boolean round) system library "PbIdea.dll" alias for "pdfDrawLine"
//画框
function boolean DrawBox(int page, int x1, int y1, int x2, int y2, long clr, double width, boolean fill) system library "PbIdea.dll" alias for "pdfDrawBox"
//添加文字, int rotate 0-360, alpha 0-255
function boolean DrawText(readonly string text, int page, int x, int y, long clr, readonly string fontName, int fontSize, int rotate) system library "PbIdea.dll" alias for "pdfDrawText"
function boolean DrawText(readonly string text, int page, int x, int y, long clr, readonly string fontName, int fontSize, int rotate, int alpha) system library "PbIdea.dll" alias for "pdfDrawText"
//是否对渲染页面缓存。每次渲染一页，是否加入缓存。默认是
//注意，这个要有取舍。页面很多时，缓存会增加内存使用量。建议页面很多时，设置为false，页面少时，设置为true。
function boolean pdfSetCache(boolean cache) system library "PbIdea.dll" alias for "pdfSetCache"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_pdfwriter" id="uo_pdfwriter">uo_pdfwriter</a></div>
<pre><code>
//create pdf

//不指定文件名时，数据关闭后内存数据存在 data 里面
blob data

//PDF_UNIT, SetUnit(int unit) 的参数
constant int PDF_PB     = 0 //
constant int PDF_PEXEL  = 1 // 1/72 inch
constant int PDF_INCH   = 2 //inch * 1000
constant int PDF_MM     = 3 //毫米*100
constant int PDF_POINT  = 4 //pdf unit

//文本对齐
constant int ALIGN_LEFT     = 0  //居左
constant int ALIGN_CENTER   = 1  //居中
constant int ALIGN_RIGHT    = 2  //居右
constant int ALIGN_TOP      = 0  //居上
constant int ALIGN_VCENTER  = 4 //垂直居中
constant int ALIGN_BOTTOM   = 8 //居底

//线条风格
constant int LINE_SOLID     = 0
constant int LINE_DASH      = 1
constant int LINE_DOT       = 2
constant int LINE_DASHDOT   = 3
constant int LINE_DASHDOTDOT = 4

private:
subroutine pdfwCreate() system library "pbidea.dll" alias for "pdfwCreate"
subroutine pdfwDestroy() system library "pbidea.dll" alias for "pdfwDestroy"

public:
//设置单位.参数静态变量定义
subroutine SetUnit(int unit) system library "pbidea.dll" alias for "pdfwSetUnit"

//打开新文档，指定文件名，则生成文件，否则生成blob数据,width/height单位：毫米
function boolean Open(int widthMM,int heightMM) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(int widthMM,int heightMM,readonly uo_json metadata) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly string filename,int widthMM,int heightMM) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly string filename,int widthMM,int heightMM,readonly uo_json metadata) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly datawindow dw) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly datawindow dw ,readonly uo_json metadata) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly datastore ds) system library "pbidea.dll" alias for "pdfwOpen"
function boolean Open(readonly datastore ds ,readonly uo_json metadata) system library "pbidea.dll" alias for "pdfwOpen"

//close后，如果没有指定文件名打开，数据会存到成员变量 data,boolean freeData 关闭时是否释放内部缓存,默认true
subroutine close() system library "pbidea.dll" alias for "pdfwClose"
subroutine close(boolean freeData) system library "pbidea.dll" alias for "pdfwClose"
//当Open不带filename时，可使用Save函数将内存数据保存为文件
function boolean Save(readonly string fileName) system library "pbidea.dll" alias for "pdfwSave"
//取页面尺寸。单位由 SetUnit 决定，默认是MM
function boolean GetPageSize(ref double width,ref double height) system library "pbidea.dll" alias for "pdfwGetPageSize"
//新建一页
subroutine BeginPage() system library "pbidea.dll" alias for "pdfwBeginPage"
subroutine BeginPage(readonly string label) system library "pbidea.dll" alias for "pdfwBeginPage"
//结束一页
subroutine EndPage() system library "pbidea.dll" alias for "pdfwEndPage"
//保存当前状态
subroutine SaveStatus() system library "pbidea.dll" alias for "pdfwSaveStatus"
//恢复当前状态
subroutine RestoreStatus() system library "pbidea.dll" alias for "pdfwRestoreStatus"
//旋转角度
subroutine Rotate(readonly double angle) system library "pbidea.dll" alias for "pdfwRotate"
//转换位置
subroutine Translate(readonly double x,readonly double y) system library "pbidea.dll" alias for "pdfwTranslate"
//设置边距
subroutine SetMargin(readonly double left,readonly double top,readonly double right,readonly double bottom) system library "pbidea.dll" alias for "pdfwSetMargin"
//设置左上角默认坐标位移
subroutine SetOffset(readonly double x,readonly double y) system library "pbidea.dll" alias for "pdfwSetOffset"
//设置颜色,clr 由 RGB函数产生数值，alpha为 0 - 255 范围值，默认为255
subroutine SetColor(ulong clr) system library "pbidea.dll" alias for "pdfwSetColor"
subroutine SetColor(ulong clr,int alpha) system library "pbidea.dll" alias for "pdfwSetColor"
//设置线宽,线风格,风格参考instance 里的定义
subroutine SetLineWidth(readonly double lineWidth) system library "pbidea.dll" alias for "pdfwSetLineWidth"
subroutine SetLineWidth(readonly double lineWidth,int style) system library "pbidea.dll" alias for "pdfwSetLineWidth"
//设置字体
subroutine SetFont(readonly string fontName,int fontSize) system library "pbidea.dll" alias for "pdfwSetFont"
subroutine SetFont(readonly string fontName,int fontSize,boolean bold,boolean italic) system library "pbidea.dll" alias for "pdfwSetFont"

//绘制矩形,stroke 是否描线，fill 是否填充。如果为否，可以调用 Stroke()函数描线，Fill()函数填充
subroutine Rectangle(readonly double left,readonly double top,readonly double width,readonly double height) system library "pbidea.dll" alias for "pdfwRectangle"
subroutine Rectangle(readonly double left,readonly double top,readonly double width,readonly double height,boolean stroke,boolean fill) system library "pbidea.dll" alias for "pdfwRectangle"
//绘制线条,stroke 是否描线。如果为否，可以调用 Stroke()函数描线
subroutine LineTo(readonly double x1,readonly double y1,readonly double x2,readonly double y2) system library "pbidea.dll" alias for "pdfwLineTo"
subroutine LineTo(readonly double x1,readonly double y1,readonly double x2,readonly double y2,boolean stroke) system library "pbidea.dll" alias for "pdfwLineTo"

//描线
subroutine Stroke() system library "pbidea.dll" alias for "pdfwStroke"
//填充
subroutine Fill() system library "pbidea.dll" alias for "pdfwFill"
//填充并且描线
subroutine FillAndStrok() system library "pbidea.dll" alias for "pdfwFillAndStrok"
//描线并且填充
subroutine StrokAndFill() system library "pbidea.dll" alias for "pdfwStrokAndFill"

//在当前位置绘制文本,url为链接
subroutine DrawString(readonly string text) system library "pbidea.dll" alias for "pdfwDrawString"
subroutine DrawString(readonly string text, readonly string url) system library "pbidea.dll" alias for "pdfwDrawString"
//在指定位置绘制文本,url为链接
subroutine DrawString(readonly double x,readonly double y,readonly string text) system library "pbidea.dll" alias for "pdfwDrawString"
subroutine DrawString(readonly double x,readonly double y,readonly string text, readonly string url) system library "pbidea.dll" alias for "pdfwDrawString"
//在指定位置和指定范围绘制文本
subroutine DrawString(readonly double x,readonly double y,readonly double width,readonly double height,readonly string text) system library "pbidea.dll" alias for "pdfwDrawString"
subroutine DrawString(readonly double x,readonly double y,readonly double width,readonly double height,readonly string text, long align) system library "pbidea.dll" alias for "pdfwDrawString"
//指定位置绘制图片,支持 bmp,jpeg,png,可以是图片文件，也可以是图片数据.alpha指定透明度0-255，alpha指定旋转角度0-360
subroutine DrawPicture(readonly double x,readonly double y,readonly double width,readonly double height,readonly string imageFile) system library "pbidea.dll" alias for "pdfwDrawPicture"
subroutine DrawPicture(readonly double x,readonly double y,readonly double width,readonly double height,blob imageData) system library "pbidea.dll" alias for "pdfwDrawPicture"
subroutine DrawPicture(readonly double x,readonly double y,readonly double width,readonly double height,int alpha,int angle,readonly string imageFile) system library "pbidea.dll" alias for "pdfwDrawPicture"
subroutine DrawPicture(readonly double x,readonly double y,readonly double width,readonly double height,int alpha,int angle,blob imageData) system library "pbidea.dll" alias for "pdfwDrawPicture"
//绘制水印,水印内容由metadata给定
subroutine DrawWaterMark() system library "pbidea.dll" alias for "pdfwDrawWaterMark"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_printer" id="uo_printer">uo_printer</a></div>
<pre><code>
//cn:打印机相关功能
//en:Printer related functions

//获取默认打印机
function string GetDefaultPrinter() system library "PbIdea.dll" alias for "piGetDefaultPrinter"
//设置默认打印机
function boolean SetDefaultPrinter(string printerName) system library "PbIdea.dll" alias for "piSetDefaultPrinter"
//取打印机列表
//当 detail 为 true 时获取明细信息，此时 printerName 可以指定获取指定打印机信息。printerName 为 "" 则获取所有打印机信息
function boolean GetPrinterList(string printerName,uo_json json,boolean detail) system library "PbIdea.dll" alias for "GetPrinterList"
//获取打印机和纸张信息,如果打印机名为空则取默认打印机
function boolean GetPrinterAndPaper(string printerName,uo_json json) system library "PbIdea.dll" alias for "piGetPrinterAndPaper"
//添加自定义纸张,如果打印机名为空则取默认打印机
//PaperName: 自定义纸张名称,PaperSize: 纸张的大小，以0.001mm为单位 ,Margin: 打印机的最小可打印边界，以0.001mm为单位。
function boolean AddCustomPaper(string PrinterName, string PaperName, long PaperWidth,long PaperHeight, long marginLeft, long marginTop, long marginRight, long marginBottom) system library "PbIdea.dll" alias for "piAddCustomPaper"
//删除自定义纸张,如果打印机名为空则取默认打印机
function boolean DeleteCustomPaper(string PrinterName, string PaperName) system library "PbIdea.dll" alias for "piDeleteCustomPaper"
//设置纸张方向 1 竖向 2 横向,如果打印机名为空则取默认打印机。返回PaperSize的数字序号，例如A4是9
function int SetPaper(string PrinterName, string PaperName,int Orientation) system library "PbIdea.dll" alias for "piSetPaper"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_printer_usb" id="uo_printer_usb">uo_printer_usb</a></div>
<pre><code>
//cn:usb 无驱打印机
//en:Usb driveless printer

private:
subroutine usbpCreate() system library "PbIdea.dll" alias for "usbpCreate"
subroutine usbpDestroy() system library "PbIdea.dll" alias for "usbpDestroy"
public:
//获取打印机列表
function int     GetUsbPrinters(ref string ls_printers[]) system library "PbIdea.dll" alias for "usbpGetUsbPrinters"
//打开指定打印机
function ulong   OpenUsbPrinters(string strCom,int nBandRate,int nDataBits,int nStopBits,int nReceiveBuffer) system library "PbIdea.dll" alias for "usbpOpenUsbPrinters"
//关闭打印机
function boolean CloseUsbPrinters() system library "PbIdea.dll" alias for "usbpCloseUsbPrinters"
//打印二进制数据
function boolean PrintBlob(blob data) system library "PbIdea.dll" alias for "usbpPrintBlob"
//打印字符串
function boolean PrintString(string str,boolean bBold,boolean bDTail,boolean bDWide,int nAlign,boolean bPrintAndNewLine) system library "PbIdea.dll" alias for "usbpPrintString"
//打开钱箱
function boolean OpenMoneyBox(int m,int t1,int t2) system library "PbIdea.dll" alias for "usbpOpenMoneyBox"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_process" id="uo_process">uo_process</a></div>
<pre><code>
//process

//run process
function boolean RunProcess(readonly string exeName,readonly string cmdLine, ref ulong processID, ref ulong hwnd) system library "PbIdea.dll" alias for "RunProcess"
//kill process
function boolean KillProcess(ulong processID) system library "PbIdea.dll" alias for "procKillProcess"
//枚举进程
function ulong GetProcessList(ref ulong ids[],ref string processNames[]) system library "PbIdea.dll" alias for "GetProcessList"
function ulong GetProcessList(ref ulong ids[],ref string processNames[], ref string err) system library "PbIdea.dll" alias for "GetProcessList"
//枚举进程里面的模块
function ulong GetProcessModuleList(ulong processID,ref ulong hModules[],ref string moduleNames[]) system library "PbIdea.dll" alias for "GetProcessModuleList"

//可以跨进程发送字符串消息
/*
有个A程序，
有个B程序
现在A程序通过FindWindow函数，可以找到B程序的数据窗口的 hwnd.
然后A程序发送消息给B程序的数据窗口。
比如发送另存为消息，指定文件名，会失败，而且一定程序会崩溃。那么就使用SendMessageEx来发送字符串消息吧
uo_utils u
u = create uo_utils
String FilePath
FilePath = "1.TXT"
u.sendmessageex(hwndDWforB,1305,-2,FilePath)
FilePath = "2.TXT"
u.sendmessageex(hwndDWforB,1305,2,FilePath)
destroy u
*/
function long SendMessageEx(ulong hwnd, uint msg,long wparam,string lparam)  SYSTEM library "PbIdea.dll" alias for "SendMessageEx"
//ansi参数在高版本PB向PB9及以下版本发消息时，请指定为 true
function long SendMessageEx(ulong hwnd, uint msg,long wparam,string lparam,boolean ansi)  SYSTEM library "PbIdea.dll" alias for "SendMessageEx"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_progress" id="uo_progress">uo_progress</a></div>
<pre><code>
//cn:进度条，可以有多项
//en:Progress bar, can have multiple items

private:
subroutine pwCreate() system library "PbIdea.dll" alias for "pwCreate"
subroutine pwDestroy() system library "PbIdea.dll" alias for "pwDestroy"

public:
/*
创建一个进度栏,返回一个唯一ID值，代表进度控件中的一个进度条
参数内容均为可选参数
uo_json jsArgs; jsArgs = create uo_json
jsArgs.set("padding",8)  //边距
jsArgs.set("panelheight", 96) //进度块高度
jsArgs.set("barheight",8) //色条高度
jsArgs.set("alpha" ,220) //背景透明度，取值范围0-255，0 全透明，255 完全不透明
jsArgs.set("title","test.txt") //标题,显示在进度条上方
jsArgs.set("smalltitle","正在复制文件到 d:\test\") //标题,显示在进度条下方
jsArgs.set("maxvalue",100) //最大值
jsArgs.set("image","../demores/images/logo.png") //图标，可以是图片文件，也可以是base64的图片内容
jsArgs.set("clrback","RGB(20,20,20)") //背景颜色
jsArgs.set("clrtext","RGB(250,250,250)") //文本颜色
jsArgs.set("clrbar","RGB(0,200,0)") //进度条颜色
*/
function ulong CreateItem(uo_json args) system library "PbIdea.dll" alias for "pwCreateItem"
//删除一个进度栏,bar 为 CreateItem 返回值
subroutine DestroyItem(ulong bar) system library "PbIdea.dll" alias for "pwDestroyItem"
//刷新一个进度栏,bar 为 CreateItem 返回值
subroutine UpdateItem(ulong bar,long value) system library "PbIdea.dll" alias for "pwUpdateItem"
//刷新一个进度栏,bar 为 CreateItem 返回值,
/*
args 同CreateItem参数
jsArgs.set("value",value) //给出实际值
*/
subroutine UpdateItem(ulong bar,uo_json args) system library "PbIdea.dll" alias for "pwUpdateItem"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_progress_dialog" id="uo_progress_dialog">uo_progress_dialog</a></div>
<pre><code>
//线程进度对话框，支持取消判断
/*
使用方法
uo_progress_dialog dialog
uo_json js
js = create uo_json
js.set("title","正在导出数据...")   //窗口标题
js.set("text1","总表 100 个")       //第1个文本
js.set("text2","当前表第 1 第记录") //第2个文本
js.set("button","取消导出")         //按钮文本
js.set("/progress/min",0)           //进度条最小值
js.set("/progress/max",100)         //进度条最大值
js.set("/progress/value",0)           //进度条当前值
js.set("/progress/color",rgb(40,40,40)) //进度条文本颜色
js.set("/progress/back",RGB(240,140,40)) //进度条背景颜色
dialog = create uo_progress_dialog
dialog.open(js)

参数说明:
1.以上参数均为可选参数，dialog.open(js) 时初始化，dialog.SetInfo(js) 设置值
2.进度条最小值小于进度条最大值时，显示进度条，否则隐藏进度条
3.业务循环中，使用dialog.SetInfo(js)设置相关信息
4.业务循环中，使用dialog.iscancel()判断是用户是否点了取消
5.代码中可以使用 dialog.cancel() 设置取消
6.可以使用 js.set("/progress/value",0) 设置进度值 ，也可以使用 dialog.StepIt() 步进
*/

//打开一个基于线程的进度对话框
function boolean Open() system library "pbidea.dll" alias for "pgdlgOpen"
function boolean Open(uo_json param) system library "pbidea.dll" alias for "pgdlgOpen"
//关闭一个基于线程的进度对话框
subroutine Close() system library "pbidea.dll" alias for "pgdlgClose"
//设置数据
subroutine SetInfo(uo_json param) system library "pbidea.dll" alias for "pgdlgSetInfo"
//进步条前进一步
function int StepIt() system library "pbidea.dll" alias for "pgdlgStepIt"
//取消
subroutine Cancel() system library "pbidea.dll" alias for "pgdlgCancel"
//判断是否取消
function boolean IsCancel() system library "pbidea.dll" alias for "pgdlgIsCancel"
//与 IsCancel() 相反
function boolean IsContinue() system library "pbidea.dll" alias for "pgdlgIsContinue"
//下载或上传速率转字符串
function string SpeedToString(double speed, boolean add_unit_name) system library "pbidea.dll" alias for "pgdlgSpeedToString"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_rabbitmq" id="uo_rabbitmq">uo_rabbitmq</a></div>
<pre><code>
//cn:rabbitmq客户端
//en:rabbitmq client

//参考(reference resources)
//1. https://rabbitmq-c.docsforge.com/master/api
//2. https://blog.csdn.net/weixin_43498985/article/details/119026198

//连接
function boolean Open(string ip,int port,string userName,string Password,string virtualHost) system library "pbidea.dll" alias for "rabbitOpen"
//SSL连接
function boolean Open(string ip,int port,string userName,string Password,string virtualHost, &
boolean use_ssl,string cacert_path, string client_cert_path, string client_key_path,boolean verify_peer, boolean verify_hostname &
) system library "pbidea.dll" alias for "rabbitOpen"

//断开
function boolean Close() system library "pbidea.dll" alias for "rabbitClose"
//获取错误信息
function string GetError() system library "pbidea.dll" alias for "rabbitLastError"

//创建一个消息机
function uo_rabbitmq_exchange CreateExchange() system library "pbidea.dll" alias for "rabbitCreateExchange"
function uo_rabbitmq_exchange CreateExchange(string name) system library "pbidea.dll" alias for "rabbitCreateExchange"
//销毁一个消息机
subroutine DestroyExchange(uo_rabbitmq_exchange exchange) system library "pbidea.dll" alias for "rabbitDestroyExchange"

//创建队列
function uo_rabbitmq_queue CreateQueue() system library "pbidea.dll" alias for "rabbitCreateQueue"
function uo_rabbitmq_queue CreateQueue(string name) system library "pbidea.dll" alias for "rabbitCreateQueue"
//销毁消息机
subroutine DestroyQueue(uo_rabbitmq_queue exchange) system library "pbidea.dll" alias for "rabbitDestroyQueue"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_rabbitmq_exchange" id="uo_rabbitmq_exchange">uo_rabbitmq_exchange</a></div>
<pre><code>
//cn:rabbitmq路由
//en:rabbitmq exchange

//消息类型
constant int DIRECT = 1
constant int FANOUT = 2
constant int TOPIC  = 3

constant int AMQP_AUTODELETE     = 1     //没有consumer时，队列是否自动删除
constant int AMQP_DURABLE	      = 2     //队列是否持久化
constant int AMQP_PASSIVE        = 4
constant int AMQP_MANDATORY      = 8
constant int AMQP_IMMIDIATE      = 16
constant int AMQP_IFUNUSED       = 32
constant int AMQP_EXCLUSIVE      = 64    //当前连接不在时，队列是否自动删除
constant int AMQP_NOWAIT         = 128
constant int AMQP_NOACK          = 256   //是否需要确认消息后再从队列中删除消息
constant int AMQP_NOLOCAL        = 512
constant int AMQP_MULTIPLE       = 1024

private:
subroutine OnExchangeDestroy() system library "pbidea.dll" alias for "rabbitOnExchangeDestroy"

public:
//声明消息机
//messagetype: 1 direct , 2 fanout , 3 topic
function boolean ExchangeDeclare() system library "pbidea.dll" alias for "rabbitExchangeDeclare"
function boolean ExchangeDeclare(string name) system library "pbidea.dll" alias for "rabbitExchangeDeclare"
function boolean ExchangeDeclare(string name,int messagetype) system library "pbidea.dll" alias for "rabbitExchangeDeclare"
function boolean ExchangeDeclare(string name,int messagetype,int parms) system library "pbidea.dll" alias for "rabbitExchangeDeclare"

//删除消息机
function boolean ExchangeDelete() system library "pbidea.dll" alias for "rabbitExchangeDelete"
function boolean ExchangeDelete(string name) system library "pbidea.dll" alias for "rabbitExchangeDelete"

//绑定消息机和关键字
function boolean Bind(string name) system library "pbidea.dll" alias for "rabbitExchangeBind"
function boolean Bind(string name,string key) system library "pbidea.dll" alias for "rabbitExchangeBind"

//设置头键值对
function boolean SetHeader(string name,int value) system library "pbidea.dll" alias for "rabbitSetHeader"
function boolean SetHeader(string name,string value) system library "pbidea.dll" alias for "rabbitSetHeader"
function boolean SetHeader(string name,string value,boolean special) system library "pbidea.dll" alias for "rabbitSetHeader"

//作为生产者发布消息
function boolean Publish(string msg,string key) system library "pbidea.dll" alias for "rabbitPublish"
function boolean Publish(string msg,string key,boolean toUTF8) system library "pbidea.dll" alias for "rabbitPublish"
function boolean Publish(blob msg,string key) system library "pbidea.dll" alias for "rabbitPublish"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_rabbitmq_queue" id="uo_rabbitmq_queue">uo_rabbitmq_queue</a></div>
<pre><code>
//cn:rabbitmq队列
//en:rabbitmq queue
constant int AMQP_AUTODELETE     = 1     //没有consumer时，队列是否自动删除
constant int AMQP_DURABLE	      = 2     //队列是否持久化
constant int AMQP_PASSIVE        = 4
constant int AMQP_MANDATORY      = 8
constant int AMQP_IMMIDIATE      = 16
constant int AMQP_IFUNUSED       = 32
constant int AMQP_EXCLUSIVE      = 64    //当前连接不在时，队列是否自动删除
constant int AMQP_NOWAIT         = 128
constant int AMQP_NOACK          = 256   //是否需要确认消息后再从队列中删除消息
constant int AMQP_NOLOCAL        = 512
constant int AMQP_MULTIPLE       = 1024

private:
subroutine OnQueueDestroy() system library "pbidea.dll" alias for "rabbitOnQueueDestroy"

public:
//声明消息队列
function boolean QueueDeclare() system library "pbidea.dll" alias for "rabbitQueueDeclare"
function boolean QueueDeclare(string name) system library "pbidea.dll" alias for "rabbitQueueDeclare"
function boolean QueueDeclare(string name,int parms) system library "pbidea.dll" alias for "rabbitQueueDeclare"

//purge: 只是清空队列里的消息，并把消息放入已经出队里
function boolean QueuePurge() system library "pbidea.dll" alias for "rabbitQueuePurge"
function boolean QueuePurge(string name) system library "pbidea.dll" alias for "rabbitQueuePurge"

//delete: 删除这个queue，在列表里会消失
function boolean QueueDelete() system library "pbidea.dll" alias for "rabbitQueueDelete"
function boolean QueueDelete(string name) system library "pbidea.dll" alias for "rabbitQueueDelete"

//绑定消息队列与关键字
function boolean Bind(string name,string key) system library "pbidea.dll" alias for "rabbitQueueBind"
//解绑消息队列与关键字
function boolean UnBind(string name,string key) system library "pbidea.dll" alias for "rabbitQueueUnBind"

//设置消息队列标志符
function boolean SetConsumerTag(string tag) system library "pbidea.dll" alias for "rabbitSetConsumerTag"

//绑定事件触发,有订阅消息到到达时，会触发此事件，此事件自己在指定对象中写，事件有一个 readonly uo_json messages 参数
function boolean BindEvent(powerobject obj,string eventName) system library "pbidea.dll" alias for "rabbitBindEvent"

//设置订阅参数
function boolean qos(long prefetch_size,int prefetch_count,boolean isGlobal) system library "pbidea.dll" alias for "rabbitQos"

//订阅，异步由事件触发消息响应
function boolean Consume() system library "pbidea.dll" alias for "rabbitConsume"
//取消订阅
function boolean ConsumeStop() system library "pbidea.dll" alias for "rabbitConsumeStop"

//逐条订阅，可批量返回。逐条从网上拉消息到本地
function boolean retrieve(uo_json result) system library "pbidea.dll" alias for "rabbitRetrieve"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_redis" id="uo_redis">uo_redis</a></div>
<pre><code>
//cn:redis客户端
//en:redis client

//私有函数，对象内部使用
private:
subroutine redisCreate() system library "PbIdea.dll" alias for "_redisCreate"
subroutine redisDestroy() system library "PbIdea.dll" alias for "_redisDestroy"

public:
//打开一个数据库连接
function boolean Open(string ip,long port,boolean async) system library "PbIdea.dll" alias for "_redisConnect"
function boolean Open(string ip,long port,string auth) system library "PbIdea.dll" alias for "_redisConnect"
//关闭数据库连接
subroutine Close() system library "PbIdea.dll" alias for "_redisDisconnect"
//执行命令，并取得结果
function uo_redisreply ExecCommand(string fmt,...) system library "PbIdea.dll" alias for "_redisExecCommand"
//设置键值对,自动转utf8
function uo_redisreply Set(string key,string value) system library "PbIdea.dll" alias for "_redisSet"
function uo_redisreply Set(string key,blob value) system library "PbIdea.dll" alias for "_redisSet"
//获取键的值，返回对象
function uo_redisreply Get(string key) system library "PbIdea.dll" alias for "_redisGet"
//直接获取键的值
function boolean Get(string key,ref string value) system library "PbIdea.dll" alias for "_redisGet"
function boolean Get(string key,ref blob value) system library "PbIdea.dll" alias for "_redisGet"

//获取返回值,参数为超时毫秒
function uo_redisreply GetReply(long timeout) system library "PbIdea.dll" alias for "_redisGetReply"

//打开一个流水线,可以批量执行ExecCommand
subroutine BeginPipeline() system library "PbIdea.dll" alias for "_redisBeginPipeline"
//关闭事务
function long EndPipeline(ref uo_redisreply replys[]) system library "PbIdea.dll" alias for "_redisEndPipeline"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_redisasync" id="uo_redisasync">uo_redisasync</a></div>
<pre><code>
//cn:redis异步客户端
//en:redis async client

//私有函数，对象内部使用
private:
subroutine redisAsyncCreate() system library "PbIdea.dll" alias for "_redisAsyncCreate"
subroutine redisAsyncDestroy() system library "PbIdea.dll" alias for "_redisAsyncDestroy"

public:
//打开一个数据库连接
function boolean Open(string ip,long port) system library "PbIdea.dll" alias for "_redisAsyncConnect"
//关闭数据库连接
subroutine Close() system library "PbIdea.dll" alias for "_redisAsyncDisconnect"
//执行命令，并取得结果
function boolean ExecCommand(string fmt,...) system library "PbIdea.dll" alias for "_redisAsyncExecCommand"
//设置键值对
function ulong Set(string key,string value) system library "PbIdea.dll" alias for "_redisAsyncSet"
function ulong Set(string key,blob value) system library "PbIdea.dll" alias for "_redisAsyncSet"
function ulong Get(string key) system library "PbIdea.dll" alias for "_redisAsyncGet"

function ulong Subscribe(string chat , boolean switch) system library "PbIdea.dll" alias for "_redisAsyncSubscribe"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_redisreply" id="uo_redisreply">uo_redisreply</a></div>
<pre><code>
//cn:redis 应答
//en:redis reply

constant int REPLY_STRING   = 1 //字符串
constant int REPLY_ARRAY    = 2 //数组，是一系列 uo_redisreply
constant int REPLY_INTEGER  = 3 //整值,int,long,longlong
constant int REPLY_NIL      = 4 //空值
constant int REPLY_STATUS   = 5 //状态，执行一条命令后，会返回此状态
constant int REPLY_ERROR    = 6 //错误
constant int REPLY_DOUBLE   = 7
constant int REPLY_BOOL     = 8
constant int REPLY_MAP      = 9
constant int REPLY_SET      = 10
constant int REPLY_ATTR     = 11
constant int REPLY_PUSH     = 12
constant int REPLY_BIGNUM   = 13
constant int REPLY_VERB     = 14

//私有函数，对象内部使用
private:
subroutine replyDestroy() system library "PbIdea.dll" alias for "_replyDestroy"

public:
//获取值
function boolean Get(ref string value) system library "PbIdea.dll" alias for "_replyGet"
function boolean Get(ref blob   value) system library "PbIdea.dll" alias for "_replyGet"
function boolean Get(ref long   value) system library "PbIdea.dll" alias for "_replyGet"
function boolean Get(ref uo_redisreply values[]) system library "PbIdea.dll" alias for "_replyGet"
//获取类型，具体类型说明在 instance 变量里有定义
function int GetType() system library "PbIdea.dll" alias for "_replyType"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_response" id="uo_response">uo_response</a></div>
<pre><code>
//cn:http响应对象,uo_httpclient.response
//en:http response object,uo_httpclient.response

//!!!!!!!!!!!!!!!!!!!!!!!
//这里的名称不要改动，对象内部使用，改动后会失效
string header          //保存 httpclient 的response header
string headerlist[]    //保存 httpclient 的response header 关键字
blob   data            //保存 httpclient 的结果，不仅限于文本，也可能是其他二进制数据。在只是文本的情况下，可以取 text 值
int    errcode         //返回值错误值 
string errtext         //返回值错误文本
int    httpcode        //200 正常 , 404 501
string verb            //POST ，PUT ，GET 。。。
long   timeout = 5000  //默认5秒超时
string charset         //语言编码 utf-8 gbk 等
string ContentType     //text/html application/json等
string Server          //服务器类型
string text            //文本，由data转换而来。在多数情况下，此文本是可用的。但不排除响结果是非文本情况，那就必须读取 data才能获取正确结果。
uo_json json           //当返回Content-Type: application/json时，会生成此 json 对象
uo_xml  xml            //当返回Content-Type: application/xml时，会生成此 xml 对象
uo_json headers

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_rsa" id="uo_rsa">uo_rsa</a></div>
<pre><code>
//cn:RSA加密/解密，签名/验签
//en:RSA encryption/decryption, signature/signature verification

//对齐定义
constant int RSA_PKCS1_PADDING       = 1
constant int RSA_SSLV23_PADDING      = 2
constant int RSA_NO_PADDING          = 3
constant int RSA_PKCS1_OAEP_PADDING  = 4
constant int RSA_X931_PADDING        = 5
constant int RSA_PKCS1_PSS_PADDING   = 6

//MD可用参数
/*
md4
md5
md5_sha1
blake2b512
blake2b256
sha1
sha224
sha256
sha384
sha512
sha512_224
sha512_256
sha3_224
sha3_256
sha3_384
sha3_512
shake128
shake256
mdc2
ripemd160
whirlpool
sm3
*/

//生成密钥
//当私钥不为空公钥为空时，会根据私钥推导出公钥
subroutine RsaKey(int bits,ref string prikey,ref string pubkey) system library "pbidea.dll" alias for "evpRsaKey"
//加密
function blob encrypt(blob data,readonly string pubkey) system library "pbidea.dll" alias for "evpRsaEncrypt"
function blob encrypt(blob data,readonly string pubkey,int padding,readonly string md,readonly string mgf1) system library "pbidea.dll" alias for "evpRsaEncrypt"
//解密
function blob decrypt(blob data,readonly string prikey) system library "pbidea.dll" alias for "evpRsaDecrypt"
function blob decrypt(blob data,readonly string prikey,int padding,readonly string md,readonly string mgf1) system library "pbidea.dll" alias for "evpRsaDecrypt"

//签名
function blob sign(blob data,readonly string prikey,readonly string md) system library "pbidea.dll" alias for "evpRsaSign"
//验签
function boolean verify(blob data,readonly string pubkey,readonly string md,blob signData) system library "pbidea.dll" alias for "evpRsaVerify"
function boolean verify(blob data,readonly string pubkey,readonly string md,readonly string signString) system library "pbidea.dll" alias for "evpRsaVerify"

//随机字符串
function string random() system library "pbidea.dll" alias for "getRandom"
function string random(blob seed) system library "pbidea.dll" alias for "getRandom"
function string random(blob seed,int bit_count) system library "pbidea.dll" alias for "getRandom"
function string random(blob seed,int bit_count,readonly string md) system library "pbidea.dll" alias for "getRandom"

/*
string prikey,pubkey
uo_rsa rsa
rsa = create uo_rsa
prikey = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDmac1tjPdYxOP4R5qU5s1RXOfRV0oX9A3lIzzFP5DlizTP2Mx1MEzRi/IpMOHMv2rSxtARW7Ov5y2ny4IocHFscIciV6r6GXKWyznqE7JNkWYOE5aBz2Vqe6UXAH1aRWJ7o98IosBHkGhoiH2yabfjMpsDGefV/sPF97ycbWfGu/nI9P03yVJvXF7on1hkPFgu5Sjddw2E1Z8pB8akY526cxXaTw+/YUOEag79tv0T+zVZ9bQLY3U2DDceSJmXDF5txoM6zR2CfbevkMl6RY9XShCH45aLtbEQe1SEmLts+CzCdjBCaCeMc4jjELVBmL6Ioj6LY8jtaLxJXfMTvd13AgMBAAECggEAM37b+arysPU4Ggouwy6eHpwL915x4c6auGZas57UTGkDQZyrfVlxIbgMRCZ3oKH7RuZGJEsBasPZEVJLYaxXvSudGBDN1p2PXaJH7EfAptNjIqxAC/0FJnpB2FU0rtMpAocKVszA+n2MyCgRJ6m2/mEWAehtRwdsS7dlgPR2qBR4U42mQ9n7yyIn31bCg5GdWS+K41TgZu0rpwzjKBAFLyw/mLj3WkxbTVRMzR3VDPNmpH5jSzSjaHqamEH0ArKNhh81ecFsqnpwurOKzI5+r4ETP2teD44RKEmn/h32CUvXf5XF61V1a+dMhUmsiLvBGpyDMPRjvft9L8O1AJr4GQKBgQD5FDcQ6AfGlmk9/FwJGFxGOXh9cH7sZTyU3ijl7AeODc5mPyyAAxUjVh01iFBCtf0AUdk8Kr9+xFx2+PiPUcqNWdUoX6j3ZaHWHFnKViZBttlAWEHmYFzGhGw0Yh6JHhxDoG5OMckN82M47bHxRCauoct1iLLC8L7q2pNb9BJgiwKBgQDs0M/b0jCbimeRGvztsY9XPrGwW02Z88DGZ3SFSzBlnDlSn6bnRzMxDXdNGmZbqGONNb7lFkgWcbilRFyIPY6Tfb3fLrSG8URX6n7Ao1tadKCnoOVI27uekGoTd5QUJ25K2ElUTJTzFmuyga4VcqFguyIeZlc+ignoufvHBoCIRQKBgEzonQgvXRdIoj5tic2VJAja/gVdkxNTPx2Ia4BzHPIT+UNBBnCQgxpiIKrC6GVw5CoRG86kNHTkFNj3j2hRjQWQU20f/IBHdW0zW9ZKO43W88YWemK0JnF1uiOCmIMmNPv8sZKbdMVF/cE6Q9OHg5owgy5Lg0cGJy1FSHMALhx5AoGBAMOnmbQiKqq3ZO3MAGBZrPYGBESSisDBVOoXG3vtLSUmN23+HaVDfBXw7Do1r4/WxbkrSHZ5PEHe3xEcM98UDLHq126HZft/ZlnEkciSrq1DYmBcXFMfyBkvc5R13U/xa/xGSf9t7joQshYfcjaiKJaExaGcKESxQ5KV5mD/DD6JAoGARjstnK8o577vpuYd0SEdnEOLYkEASbymbgDl5G+OmNgaf0FF8jpWc4CCoDv0IkeSFVtplLI5oYNT0sjOZu175lkUCUBt4MR72lv/YM28J1q4eC5sWoJarFXrObMvaVBpFYDcdghf6z5mCdoYLx82Ayfcv8TS8JNf6G4L282/Sa8="
pubkey = ""
rsa.rsakey(2048,prikey,pubkey)
blob rsadata
//rsadata = rsa.RsaEncrypt(blob("hello boby 2022"),pubkey,rsa.RSA_PKCS1_OAEP_PADDING,"sha256","sha256")
rsadata = rsa.e_RSAECBOAEPWithSHA256AndMGF1Padding(blob("hello boby 2022,tz"),pubkey)
uo_crypto c
c = create uo_crypto

printf("rsa: {}~n",c.base64encode(rsadata,false))

string cipher
cipher = "YzuZJp62RaUxS9HAhniYtP6qWnL1Gx2/R5MB6wR53fufOhP2HcdQxtf4E/w05NQYUkuU19vH2+AcidkVOs+2ALjaneQRiPdUJMUpu2DFdIDyXCYqZ47Wlt6Bh7tDbzPtn7JDurgLeHgxUAFaPaiTa6tAcrIs5N+3va+rrAz0aN5WxP3KuPztWhDbjjCuBCGNn1xNjHU0D3VKjE1HF9B1+gMIPauEDyb1HFBIqDoDRMKW7HOjRiWANnxm4rLaBqaazJoQWmtJAgy3vIjEfJUMBiit9/aYCoW6Wvwx0WHAb5u5cASJNXeUvRUSzTa9yEqG0iplBbrSP4FWqJR7bmCSsw=="

blob data
data = rsa.RsaDecrypt(c.base64decode(cipher),prikey,rsa.RSA_PKCS1_OAEP_PADDING,"sha256","sha256")
printf("{}~n",string(data))
data = rsa.RsaDecrypt(rsadata,prikey,rsa.RSA_PKCS1_OAEP_PADDING,"sha256","sha256")
printf("{}~n",string(data))

data = rsa.d_RSAECBOAEPWithSHA256AndMGF1Padding(rsadata,prikey)
printf("{}~n",string(data))
*/
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_scintilla" id="uo_scintilla">uo_scintilla</a></div>
<pre><code>
//cn:语法编辑器
//en:syntax editor

private:
subroutine sciCreate() system library "PbIdea.dll" alias for "sciCreate"
subroutine sciDestroy() system library "PbIdea.dll" alias for "sciDestroy"

public:
//发消息，实现功能。具体消息定义，参考 https://www.scintilla.org/ScintillaDoc.html
function long SendEditor(ulong iMessage,ulong wParam,long lParam) system library "PbIdea.dll" alias for "sciSendEditor"
function long SendEditor(ulong iMessage,ulong wParam,readonly string lParam) system library "PbIdea.dll" alias for "sciSendEditor"
//设置语言
function boolean SetLanguage(readonly string language) system library "PbIdea.dll" alias for "sciSetLanguage"
//取支持的语言列表
function int GetLanguageList(ref string languages[]) system library "PbIdea.dll" alias for "sciGetLanguageList"
//设置文本
function long SetText(readonly string strText) system library "PbIdea.dll" alias for "sciSetText"
function long SetText(uo_json json) system library "PbIdea.dll" alias for "sciSetText"
function long SetText(uo_xml xml) system library "PbIdea.dll" alias for "sciSetText"
//获取文本
function string GetText() system library "PbIdea.dll" alias for "sciGetText"
//追加文本
subroutine AppendText(readonly string strText) system library "PbIdea.dll" alias for "sciAppendText"
//追加文本,并滚动到尾部
subroutine AppendText(readonly string strText, boolean ScrollToEnd) system library "PbIdea.dll" alias for "sciAppendText"
//清除所有
subroutine Clear() system library "PbIdea.dll" alias for "sciClear"
//读取文件
function boolean OpenFile(readonly string fileName) system library "PbIdea.dll" alias for "sciOpenFile"
//存为文件
function boolean SaveFile(readonly string fileName) system library "PbIdea.dll" alias for "sciSaveFile"
//打印
function boolean Print(boolean showPrinter) system library "PbIdea.dll" alias for "sciPrint"
function boolean Print(boolean showPrinter,int fromPage,int toPage,int marginLeft,int marginTop,int marginRight,int marginBottom,readonly string header,readonly string footer) system library "PbIdea.dll" alias for "sciPrint"
//设置字体
function boolean SetFont(readonly string fontName,int fontSize) system library "PbIdea.dll" alias for "sciSetFont"
//设置为只读
subroutine SetReadonly(boolean isReadonly) system library "PbIdea.dll" alias for "sciSetReadonly"
//添加感兴趣的自动完成关键字，输入这些关键字时会触发 ue_auto_show 事件
subroutine AddAutoComplateKey(readonly string key) system library "PbIdea.dll" alias for "sciAddAutoComplateKey"
//折行模式, 0 无折行， 1 word, 2 char, 3 whitespace。中文按文字分行必须 2 char
subroutine SetWrapMode(int mode) system library "PbIdea.dll" alias for "sciSetWrapMode"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_script" id="uo_script">uo_script</a></div>
<pre><code>
//cn:脚本调用
//en:Script call

private:
subroutine scriptCreate() system library "pbidea.dll" alias for "scriptCreate"
subroutine scriptDestroy() system library "pbidea.dll" alias for "scriptDestroy"
public:

//动态调用脚本
function boolean InvokeScript(readonly string script, ref any returnValue) system library "pbidea.dll" alias for "scriptInvokeScript"

//参数处理
function boolean PushRefArg(ref powerobject arg) system library "pbidea.dll" alias for "scriptPushRefArg"
function boolean PushRefArg(ref dragobject arg) system library "pbidea.dll" alias for "scriptPushRefArg"
function boolean PushRefArg(ref string arg) system library "pbidea.dll" alias for "scriptPushRefArg"
function boolean PushRefArg(ref int arg) system library "pbidea.dll" alias for "scriptPushRefArg"
function boolean PushRefArg(ref long arg) system library "pbidea.dll" alias for "scriptPushRefArg"
function boolean PushRefArg(ref blob arg) system library "pbidea.dll" alias for "scriptPushRefArg"

function boolean PushArg(readonly any arg) system library "pbidea.dll" alias for "scriptPushArg"

//按函数名称调用函数. 最好使用RunRoutine
function any InvokeFunction(readonly string functionName, ...) system library "pbidea.dll" alias for "scriptInvokeFunction"
function any InvokeFunction(powerobject obj,  readonly string functionName, ...) system library "pbidea.dll" alias for "scriptInvokeFunction"
function any InvokeFunction1(powerobject obj,  readonly string functionName, ref powerobject refobj,readonly string cn,int ix,int iy) system library "pbidea.dll" alias for "scriptInvokeFunction"

//第一个参数是函数名，然后都是参数。调用某对象下的函数，此函数声明要放到指定对象里面
function any RunRoutine(readonly string funcName,...) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是对象，第二个函数名是函数名，然后都是参数。调用某对象下的函数，此函数声明可以放到任意地方
function any RunRoutine(powerobject obj,readonly string funcName,...) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是函数名，然后都是参数。调用某对象下的函数，此函数声明要放到指定对象里面
function any RunRoutine(readonly string funcName, any args[]) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是对象，第二个函数名是函数名，然后都是参数。调用某对象下的函数，此函数声明可以放到任意地方
function any RunRoutine(powerobject obj,readonly string funcName, any args[]) system library "PbIdea.dll" alias for "RunRoutine"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_script2" id="uo_script2">uo_script2</a></div>
<pre><code>
//cn:脚本调用
//en:Script call

string errmsg = ""

boolean is_func = false

private:
subroutine scriptCreate() system library "pbidea.dll" alias for "scriptCreate2"
subroutine scriptDestroy() system library "pbidea.dll" alias for "scriptDestroy2"
public:

//动态调用脚本
function boolean InvokeScript(readonly string script) system library "pbidea.dll" alias for "scriptInvokeScript"
function boolean InvokeScript(readonly string script, ref any returnValue) system library "pbidea.dll" alias for "scriptInvokeScript"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_sdtapi" id="uo_sdtapi">uo_sdtapi</a></div>
<pre><code>
//cn:身份证读卡器通用阅读对象
//en:Common reading object of ID card reader

//打开设备，设置参数
//json参数包括字段 : string dll,long port,long baud
/*
参数
js.set("dll","sdtapi.dll")   //通用读身份证库
js.set("wltdll","dewlt.dll") //照片解码库
js.set("port",0)             //COM端口号 1-16，或者 USB端口号 1001,1002,1003 ...，为0 时默认为 1001
js.set("baud",115200)        //默认波特率
*/
function boolean open(uo_json json) system library "pbidea.dll" alias for "sdtOpen"
//关闭设备
subroutine close() system library "pbidea.dll" alias for "sdtClose"
//读卡
subroutine read(uo_json json) system library "pbidea.dll" alias for "sdtReadCard"

///////////////////// 以上3个函数用于同步读卡//////////////////////////

//异步读卡
/*
参数
js.set("dll","sdtapi.dll")   //通用读身份证库
js.set("wltdll","dewlt.dll") //照片解码库
js.set("port",0)             //COM端口号 1-16，或者 USB端口号 1001,1002,1003 ...，为0 时默认为 1001
js.set("baud",115200)        //默认波特率
js.set("timer",1500)         //间隔毫秒
*/
subroutine async_read(uo_json json) system library "pbidea.dll" alias for "sdtAsyncReadCard"
//停止
subroutine async_stop() system library "pbidea.dll" alias for "sdtClose"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_serial" id="uo_serial">uo_serial</a></div>
<pre><code>
//cn:串口控件
//en:Serial port control

public:

//波特率
constant long BaudRate1200 = 1200		///< 1200
constant long BaudRate2400 = 2400		///< 2400
constant long BaudRate4800 = 4800		///< 4800
constant long BaudRate9600 = 9600		///< 9600 recommend 推荐
constant long BaudRate19200 = 19200		///< 19200
constant long BaudRate38400 = 38400		///< 38400
constant long BaudRate115200 = 115200	///< 115200

//数据位
constant int DataBits5 = 5			///< 5 data bits 5位数据位
constant int DataBits6 = 6			///< 6 data bits 6位数据位
constant int DataBits7 = 7			///< 7 data bits 7位数据位
constant int DataBits8 = 8			///< 8 data bits 8位数据位

//停止位
constant int StopOne = 0				///< 1 stop bit 1位停止位
constant int StopOneAndHalf = 1	///< 1.5 stop bit 1.5位停止位 - This is only for the Windows platform
constant int StopTwo = 2			///< 2 stop bit 2位停止位

//校验位
constant int ParityNone  = 0			///< No Parity 无校验
constant int ParityOdd   = 1			///< Odd Parity 奇校验
constant int ParityEven  = 2			///< Even Parity 偶校验
constant int ParityMark  = 3            ///< Mark Parity 1校验
constant int ParitySpace = 4			///< Space Parity 0校验

private:
subroutine comCreate() system library "pbidea.dll" alias for "comCreate"
subroutine comDestroy() system library "pbidea.dll" alias for "comDestroy"

public:
//打开串口
function boolean Open(string port) system library "pbidea.dll" alias for "comOpen"
function boolean Open(string port,long nBaudRate,long nDataBits,long nStopBits,long nParity,long nReadBufferSize) system library "pbidea.dll" alias for "comOpen"
//返回0成功，-1失败
subroutine Close() system library "pbidea.dll" alias for "comClose"

//异步,发送BLOB数据
function boolean SendData(BLOB data) system library "pbidea.dll" alias for "comSendData"
//异步,发送字符串，bConvertToUTF8指明是否要将字符自动转为UTF8编码格式
function boolean SendData(string str,boolean bConvertToUTF8) system library "pbidea.dll" alias for "comSendData"
//异步,发送BLOB数据
function boolean SendData(uo_blob data) system library "pbidea.dll" alias for "comSendData"

//打开调试模式，生成调试文件
subroutine SetDebug(boolean bDebug) system library "pbidea.dll" alias for "comSetDebug"

//订阅数据,事件有一个参数 blob data
function boolean BindEvent(powerobject obj,string eventName) system library "pbidea.dll" alias for "comBindEvent"
function boolean BindEvent(powerobject obj,string eventName, int datalen) system library "pbidea.dll" alias for "comBindEvent"

//取com列表
function int GetComList(ref string coms[]) system library "pbidea.dll" alias for "comGetComList"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_sftp" id="uo_sftp">uo_sftp</a></div>
<pre><code>
//cn:基于 ssh 的 ftp
//en:Ftp based on ssh

//私有函数,初始化和销毁对象,对象内部使用
private:
//创建sftp对象
function ulong sftpCreate() system library "PbIdea.dll" alias for "sftpCreate"
//销毁sftp对象
subroutine sftpDestroy() system library "PbIdea.dll" alias for "sftpDestroy"

public:
//打开调试输出
subroutine sftpSetDebug(boolean bDebug) system library "PbIdea.dll" alias for "sftpSetDebug"
//连接与断开
function boolean sftpConnect(readonly string host,int port,readonly string username,readonly string passwd) system library "PbIdea.dll" alias for "sftpConnect"
function boolean sftpConnect(readonly string host,int port,readonly string username,readonly string passwd,readonly string privateKey) system library "PbIdea.dll" alias for "sftpConnect"
//断开
subroutine sftpDisconnect() system library "PbIdea.dll" alias for "sftpDisconnect"
//UTF8
subroutine sftpUTF8(boolean bUtf8) system library "PbIdea.dll" alias for "sftpUTF8"
//判断连接状态
function boolean sftpIsConnected() system library "PbIdea.dll" alias for "sftpIsConnected"
//运行命令
function string sftpRun(readonly string cmd) system library "PbIdea.dll" alias for "sftpRun"
function string sftpRun(readonly string cmd,boolean bCrLf) system library "PbIdea.dll" alias for "sftpRun"
//下载文件
function boolean sftpGet(readonly string file) system library "PbIdea.dll" alias for "sftpGet"
function boolean sftpGet(readonly string savefile,readonly string remoteFile) system library "PbIdea.dll" alias for "sftpGet"
function boolean sftpGet(readonly string savefile,readonly string remoteFile,boolean openfile) system library "PbIdea.dll" alias for "sftpGet"
//上传文件
function boolean sftpPut(readonly string file,boolean bProgressEvent) system library "PbIdea.dll" alias for "sftpPut"
function boolean sftpPut(readonly string localfile,readonly string remotefile) system library "PbIdea.dll" alias for "sftpPut"
function boolean sftpPut(readonly string localfile,readonly string remotefile,boolean bProgressEvent) system library "PbIdea.dll" alias for "sftpPut"
//显示当指定目录文件列表明细
function long sftpDir(readonly string strDir ,ref string files[]) system library "PbIdea.dll" alias for "sftpDir"
function long sftpList(readonly string strDir ,ref string files[]) system library "PbIdea.dll" alias for "sftpList"
//改名文件
function boolean sftpRename(readonly string oldfile,string newfile) system library "PbIdea.dll" alias for "sftpRename"
//取文件大小
function ulong sftpSize(readonly string file) system library "PbIdea.dll" alias for "sftpSize"
//取文件修改时间
function string sftpDateTime(readonly string file) system library "PbIdea.dll" alias for "sftpDateTime"
//错误信息
function string sftpLastError() system library "PbIdea.dll" alias for "sftpLastError"

/*
//直接打开sftp服务上的文件，如何进行了修改，会自动同步上传
function boolean sftpShellExecute(string file) system library "PbIdea.dll" alias for "sftpShellExecute"
//删除文件
function boolean sftpDelete(string file) system library "PbIdea.dll" alias for "sftpDelete"

//创建目录
function boolean sftpMkdir(string dirName) system library "PbIdea.dll" alias for "sftpMkdir"
//删除目录
function boolean sftpRmDir(string dirName) system library "PbIdea.dll" alias for "sftpRmDir"
//取当前目录
function string sftpGetDir() system library "PbIdea.dll" alias for "sftpGetDir"

*/


//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
function string GetFileIcon(readonly string strFile,ulong clrBack) system library "PbIdea.dll" alias for "GetFileIcon"
function int SplitFileInfo(readonly string strFileInfo,ref string fields[]) system library "PbIdea.dll" alias for "SplitFileInfo"

//调试输出,测试使用
function boolean Printf(readonly string strText) system library "PbIdea.dll" alias for "Printf"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_sharedata" id="uo_sharedata">uo_sharedata</a></div>
<pre><code>
//cn:进程共享数据
//en:Process sharing data

//初始化一块指定大小的共享内存。一旦初始化后，便不再能改变大小
function boolean InitShareData(long size) system library "PbIdea.dll" alias for "InitShareData"
//释放内存。必须所有使用此共享的进程全部都释放 ，才能有效释放内存
subroutine ClearShareData() system library "PbIdea.dll" alias for "ClearShareData"
//设置一块内存区域,可以使用JSON解析更复杂内容
function boolean SetShareData(readonly string Data) system library "PbIdea.dll" alias for "SetShareData"
//获取一块内存区域
function string GetShareData() system library "PbIdea.dll" alias for "GetShareData"
//内存区域存为文件
subroutine SaveShareData(readonly string fileName) system library "PbIdea.dll" alias for "SaveShareData"

//设置一个关键字和内容
function boolean SetShareValue(readonly string key,readonly string value) system library "PbIdea.dll" alias for "SetShareValue"
//获取一个关键字的内容
function string GetShareValue(readonly string key) system library "PbIdea.dll" alias for "GetShareValue"

//运行子exe程序
//exeName为程序名称，cmdLine通常应该是一个共享数据的唯一key，由子程序通过这个唯一key，获取相关信息。不建议通过cmdLine传敏感数据
function boolean RunShareProcess(readonly string exeName,readonly string cmdLine) system library "PbIdea.dll" alias for "RunShareProcess"
//启动了一些 exe 后， 进入等待状态，直到这些子程序全部运行完毕，本函数才返回
function boolean WaitShareProcess() system library "PbIdea.dll" alias for "WaitShareProcess"
function boolean WaitShareProcess(long milliseconds) system library "PbIdea.dll" alias for "WaitShareProcess"
function boolean WaitShareProcess(powerobject obj,string eventname) system library "PbIdea.dll" alias for "WaitShareProcess"
//释放共享子程序的资源，如果前面调用了WaitShareProcess，本函数可以不调用。
function boolean ClearShareProcess() system library "PbIdea.dll" alias for "ClearShareProcess"
//获取进程的主窗口,title为窗口包含的内容
function ulong GetProcessMainWnd(string title) system library "PbIdea.dll" alias for "GetProcessMainWnd"
//获取指定窗口所有的子窗口
function int GetWindowChildren(ulong hwnd, ref ulong hwnds[]) system library "PbIdea.dll" alias for "GetWindowChildren"
//向指定窗口发送按键,keys是字符串和控制符,utf8编码
subroutine SendKeyToProcess(ulong hwnd,blob keys) system library "PbIdea.dll" alias for "SendKeyToProcess"
//向指定窗口发送鼠标眯击
subroutine SendClickToProcess(ulong hwnd) system library "PbIdea.dll" alias for "SendClickToProcess"
//根据句柄获取字符串文本
function string GetProcessWndText(ulong hwnd) system library "PbIdea.dll" alias for "GetProcessWndText"


//工具函数
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_shellapi" id="uo_shellapi">uo_shellapi</a></div>
<pre><code>
//shortcut, 快捷方式

public:
constant string GET_DESKTOP                  = '0x0000'        // <desktop>
constant string GET_INTERNET                 = '0x0001'        // Internet Explorer (icon on desktop)
constant string GET_PROGRAMS                 = '0x0002'        // Start Menu\Programs
constant string GET_CONTROLS                 = '0x0003'        // My Computer\Control Panel
constant string GET_PRINTERS                 = '0x0004'        // My Computer\Printers
constant string GET_PERSONAL                 = '0x0005'        // My Documents
constant string GET_FAVORITES                = '0x0006'        // <user name>\Favorites
constant string GET_STARTUP                  = '0x0007'        // Start Menu\Programs\Startup
constant string GET_RECENT                   = '0x0008'        // <user name>\Recent
constant string GET_SENDTO                   = '0x0009'        // <user name>\SendTo
constant string GET_BITBUCKET                = '0x000a'        // <desktop>\Recycle Bin
constant string GET_STARTMENU                = '0x000b'        // <user name>\Start Menu
constant string GET_MYDOCUMENTS              = '0x0005'        //  Personal was just a silly name for My Documents
constant string GET_MYMUSIC                  = '0x000d'        // "My Music" folder
constant string GET_MYVIDEO                  = '0x000e'        // "My Videos" folder
constant string GET_DESKTOPDIRECTORY         = '0x0010'        // <user name>\Desktop
constant string GET_DRIVES                   = '0x0011'        // My Computer
constant string GET_NETWORK                  = '0x0012'        // Network Neighborhood (My Network Places)
constant string GET_NETHOOD                  = '0x0013'        // <user name>\nethood
constant string GET_FONTS                    = '0x0014'        // windows\fonts
constant string GET_TEMPLATES                = '0x0015'
constant string GET_COMMON_STARTMENU         = '0x0016'        // All Users\Start Menu
constant string GET_COMMON_PROGRAMS          = '0X0017'        // All Users\Start Menu\Programs
constant string GET_COMMON_STARTUP           = '0x0018'        // All Users\Startup
constant string GET_COMMON_DESKTOPDIRECTORY  = '0x0019'        // All Users\Desktop
constant string GET_APPDATA                  = '0x001a'        // <user name>\Application Data
constant string GET_PRINTHOOD                = '0x001b'        // <user name>\PrintHood
constant string GET_LOCAL_APPDATA            = '0x001c'        // <user name>\Local Settings\Applicaiton Data (non roaming)
constant string GET_ALTSTARTUP               = '0x001d'        // non localized startup
constant string GET_COMMON_ALTSTARTUP        = '0x001e'        // non localized common startup
constant string GET_COMMON_FAVORITES         = '0x001f'
constant string GET_INTERNET_CACHE           = '0x0020'
constant string GET_COOKIES                  = '0x0021'
constant string GET_HISTORY                  = '0x0022'
constant string GET_COMMON_APPDATA           = '0x0023'        // All Users\Application Data
constant string GET_WINDOWS                  = '0x0024'        // GetWindowsDirectory()
constant string GET_SYSTEM                   = '0x0025'        // GetSystemDirectory()
constant string GET_PROGRAM_FILES            = '0x0026'        // C:\Program Files
constant string GET_MYPICTURES               = '0x0027'        // C:\Program Files\My Pictures
constant string GET_PROFILE                  = '0x0028'        // USERPROFILE
constant string GET_SYSTEMX86                = '0x0029'        // x86 system directory on RISC
constant string GET_PROGRAM_FILESX86         = '0x002a'        // x86 C:\Program Files on RISC
constant string GET_PROGRAM_FILES_COMMON     = '0x002b'        // C:\Program Files\Common
constant string GET_PROGRAM_FILES_COMMONX86  = '0x002c'        // x86 Program Files\Common on RISC
constant string GET_COMMON_TEMPLATES         = '0x002d'        // All Users\Templates
constant string GET_COMMON_DOCUMENTS         = '0x002e'        // All Users\Documents
constant string GET_COMMON_ADMINTOOLS        = '0x002f'        // All Users\Start Menu\Programs\Administrative Tools
constant string GET_ADMINTOOLS               = '0x0030'        // <user name>\Start Menu\Programs\Administrative Tools
constant string GET_CONNECTIONS              = '0x0031'        // Network and Dial-up Connections
constant string GET_COMMON_MUSIC             = '0x0035'        // All Users\My Music
constant string GET_COMMON_PICTURES          = '0x0036'        // All Users\My Pictures
constant string GET_COMMON_VIDEO             = '0x0037'        // All Users\My Video
constant string GET_RESOURCES                = '0x0038'        // Resource Direcotry
constant string GET_RESOURCES_LOCALIZED      = '0x0039'        // Localized Resource Direcotry
constant string GET_COMMON_OEM_LINKS         = '0x003a'        // Links to All Users OEM specific apps
constant string GET_CDBURN_AREA              = '0x003b'        // USERPROFILE\Local Settings\Application Data\Microsoft\CD Burning

//创建快捷方式
function boolean CreateShortcut(readonly string exe, readonly string workDir, readonly string desc, readonly string iconName, int iconIndex, readonly string targetName) system library "pbidea.dll" alias for "shellCreateShortcut"
//解析快捷方式，获取快捷方式信息
function boolean ParseShortcut(readonly string target, ref string exe, ref string workDir, ref string desc) system library "pbidea.dll" alias for "shellParseShortcut"

//获取指定路径,例如桌面、开始菜单等。 id 参考实例静态变量定义
function string GetPath(string id) system library "pbidea.dll" alias for "shellGetPath"

//获取盘符及类型
function boolean GetDriverList(uo_json drivers) system library "pbidea.dll" alias for "shellGetDriverList"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_socket_client" id="uo_socket_client">uo_socket_client</a></div>
<pre><code>
//cn:socket client,可替代winsocket
//en:socket client,Can replace winsocket

private:
subroutine socketCreate() system library "PbIdea.dll" alias for "socketCreate"
subroutine socketDestroy() system library "PbIdea.dll" alias for "socketDestroy"

public:
//设置是否是异步模式，默认是同步模式.必须在连接前设置!!!
subroutine SetMode(boolean async) system library "PbIdea.dll" alias for "socketSetMode"
//打开连接
function boolean Open(readonly string host,readonly string port) system library "PbIdea.dll" alias for "socketConnect"
function boolean Open(readonly string host) system library "PbIdea.dll" alias for "socketConnect"
//返回是否打开状态
function boolean IsOpen() system library "PbIdea.dll" alias for "socketIsOpen"

//关闭
subroutine close() system library "PbIdea.dll" alias for "socketDisconnect"
//写入数据
function long Write(readonly blob data) system library "PbIdea.dll" alias for "socketWrite"
//读取数据
function long Read(ref blob data) system library "PbIdea.dll" alias for "socketRead"

//获取错误信息
function string GetError() system library "PbIdea.dll" alias for "socketGetError"

//定时完成写入data计划,间隔秒数
function ulong ScheduleWrite(blob data,int seconds) system library "PbIdea.dll" alias for "socketScheduleWrite"
function ulong ScheduleWrite(blob data,int seconds,boolean once/*false*/) system library "PbIdea.dll" alias for "socketScheduleWrite"
subroutine DeleteSchedule(ulong scheduleID) system library "PbIdea.dll" alias for "socketDeleteSchedule"

//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_socket_server" id="uo_socket_server">uo_socket_server</a></div>
<pre><code>
string is_thread_name = "pbidea_socketserver_thread"

//subroutine EchoCreate() system library "PbIdea.dll" alias for "socketEchoCreate"
function boolean Start(uo_json jsOption) system library "PbIdea.dll" alias for "socketStartServer"
function boolean Stop() system library "PbIdea.dll" alias for "socketStopServer"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_socket_server_thread" id="uo_socket_server_thread">uo_socket_server_thread</a></div>
<pre><code>
//socket server thread

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_socket_udp_client" id="uo_socket_udp_client">uo_socket_udp_client</a></div>
<pre><code>
//cn:socket client,可替代winsocket
//en:socket client,Can replace winsocket

private:
subroutine socketUdpCreate() system library "PbIdea.dll" alias for "socketUdpCreate"
subroutine socketUdpDestroy() system library "PbIdea.dll" alias for "socketUdpDestroy"

public:
//设置是否是异步模式，默认是同步模式.必须在连接前设置!!!
subroutine SetMode(boolean async) system library "PbIdea.dll" alias for "socketUdpSetMode"
//打开连接
function boolean Open(readonly string host,readonly string port) system library "PbIdea.dll" alias for "socketUdpConnect"
function boolean Open(readonly string host) system library "PbIdea.dll" alias for "socketUdpConnect"
//返回是否打开状态
//function boolean IsOpen() system library "PbIdea.dll" alias for "socketUdpIsOpen"

//关闭
subroutine close() system library "PbIdea.dll" alias for "socketUdpDisconnect"
//写入数据
function long Write(readonly blob data) system library "PbIdea.dll" alias for "socketUdpWrite"
//读取数据
function long Read(ref blob data) system library "PbIdea.dll" alias for "socketUdpRead"

//获取错误信息
//function string GetError() system library "PbIdea.dll" alias for "socketUdpGetError"

//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_speak" id="uo_speak">uo_speak</a></div>
<pre><code>
//cn:文字转语音，对微软语音COM进行了封装
//en:Text to speech, encapsulated Microsoft Voice COM

string is_packages[]

//nVolumn 设置音量，范围是 0 -100 , nRate 设置速度，范围是 -10 - 10
function boolean Speak(string strText,int nVolumn,int nRate,string strPackage,string strWavFile) system library "PbIdea.dll" alias for "Speak"
function boolean SpeakStop() system library "PbIdea.dll" alias for "SpeakStop"
function boolean SpeakOpen() system library "PbIdea.dll" alias for "SpeakOpen"
function boolean SpeakClose() system library "PbIdea.dll" alias for "SpeakClose"
function int GetSpeakPackages(ref string packages) system library "PbIdea.dll" alias for "GetSpeakPackages"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_speak_recognizer" id="uo_speak_recognizer">uo_speak_recognizer</a></div>
<pre><code>
//cn:语音识别
//en:speech recognition

constant int WM_USER      = 1024
constant int WM_RECOGNIZE = (WM_USER + 20198)

function boolean RecogOpen() system library "PbIdea.dll" alias for "RecogOpen"
function boolean RecogClose() system library "PbIdea.dll" alias for "RecogClose"
function boolean RecogAttachWindow(powerobject obj) system library "PbIdea.dll" alias for "RecogAttachWindow"

Function ulong MemoryCopy(REF blob destination,ulong source, ulong srclen) system library "PbIdea.dll" alias for "utilRtlMoveMemory"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_sqlite3" id="uo_sqlite3">uo_sqlite3</a></div>
<pre><code>
//sqlite3 interface

//事务类型 transaction type
constant int TRANS_NONE              = 0 //default by memory
constant int TRANS_COMMIT_ON_CLOSE   = 1
constant int TRANS_ROLLBACK_ON_CLOSE = 2 //default by file

int SqlCode = 0
string SqlErrText = ""

subroutine SetDataDirectory(readonly string dir) system library "pbidea.dll" alias for "sqlite3SetDataDirectory"
function boolean open(readonly string dbname) system library "pbidea.dll" alias for "sqlite3Open"
function boolean open(readonly string dbname, int trans_type) system library "pbidea.dll" alias for "sqlite3Open"
function boolean open() system library "pbidea.dll" alias for "sqlite3Open"
function boolean open(int trans_type) system library "pbidea.dll" alias for "sqlite3Open"
subroutine close() system library "pbidea.dll" alias for "sqlite3Close"
function boolean exec(readonly string sql) system library "pbidea.dll" alias for "sqlite3Exec"
function boolean CommitTrans() system library "pbidea.dll" alias for "sqlite3Commit"
function boolean RollbackTrans() system library "pbidea.dll" alias for "sqlite3Rollback"
function boolean CreateFunction(readonly string funcName) system library "pbidea.dll" alias for "sqlite3CreateFunction"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_string" id="uo_string">uo_string</a></div>
<pre><code>
//cn:字符串增强功能
//en:String Enhancements

//定义访问属性
public:
INDIRECT string text {_SetText(*value),_GetText()}

private:
subroutine stringCreate() system library "PbIdea.dll" alias for "stringCreate"
subroutine stringDestroy() system library "PbIdea.dll" alias for "stringDestroy"

public:
//强制释放占用内存
subroutine free() system library "PbIdea.dll" alias for "stringFree"
//相当于 PB自身的 ls_str = ls_str + subString , 但效率提高了50倍，尤其是有大量字符串需要接续的场合下更需要优化。
//format 格式参考 https://fmt.dev/dev/syntax.html
function uo_string append(readonly string format, ...) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly long v) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly long v,string strFormat) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly int v) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly int v,string strFormat) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly longlong v) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly double v) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly datetime dt) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly date dt) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly time dt) system library "PbIdea.dll" alias for "stringAppend"
function uo_string append(readonly uo_string str) system library "PbIdea.dll" alias for "stringAppend"
//对象转为字符串
function string ToString() system library "PbIdea.dll" alias for "stringToString"
//从一个PB string  构建对象
//format 格式参考 https://fmt.dev/dev/syntax.html
function uo_string FromString(readonly string str) system library "PbIdea.dll" alias for "stringFromString"
//取字符串长度
function ulong length() system library "PbIdea.dll" alias for "stringLength"
//判断是否为空
function boolean IsNull() system library "PbIdea.dll" alias for "stringIsNull"
//设置为空
function boolean SetNull() system library "PbIdea.dll" alias for "stringSetNull"
//清空内容
function boolean Clear() system library "PbIdea.dll" alias for "stringClear"
//重置字符串长度，会丢失内容
function uo_string Resize(ulong newSize) system library "PbIdea.dll" alias for "stringResize"
//颠倒顺序
function uo_string Reverse() system library "PbIdea.dll" alias for "stringReverse"
//从前向后查找
function ulong Pos(readonly string str) system library "PbIdea.dll" alias for "stringPos"
//指定起始位置从前向后查找
function ulong Pos(readonly string str,ulong nStart) system library "PbIdea.dll" alias for "stringPos"
//指定起始位置从前向后查找，是否忽略大小写，默认是忽略大小写
function ulong Pos(readonly string str,ulong nStart,boolean ignoreCase) system library "PbIdea.dll" alias for "stringPos"
//从后向前查找，忽略大小写
function ulong LastPos(readonly string str) system library "PbIdea.dll" alias for "stringLastPos"
//指定起始位置从后向前查找
function ulong LastPos(readonly string str,ulong nStart) system library "PbIdea.dll" alias for "stringLastPos"
//指定起始位置从后向前查找，是否忽略大小写，默认是忽略大小写
function ulong LastPos(readonly string str,ulong nStart,boolean ignoreCase) system library "PbIdea.dll" alias for "stringLastPos"
//在指定位置插入字符串 
function uo_string InsertStr(long nStart,readonly string str) system library "PbIdea.dll" alias for "stringInsert"
//字符串截取
function string Substr(ulong nStart) system library "PbIdea.dll" alias for "stringSubstr"
function string Substr(ulong nStart,ulong nLen) system library "PbIdea.dll" alias for "stringSubstr"
//替换，返回替换了多少次,默认替换所有
function uo_string Replace(readonly string strOld,readonly string strNew) system library "PbIdea.dll" alias for "stringReplace"
function uo_string Replace(readonly string strOld,readonly string strNew,boolean replaceAll) system library "PbIdea.dll" alias for "stringReplace"
function uo_string Replace(ulong nStart,ulong nLen, readonly string strNew) system library "PbIdea.dll" alias for "stringReplace"
//格式化字符串,格式符参考fmt,{} {0} {1} 等
function uo_string Format(readonly string strFormat,...) system library "PbIdea.dll" alias for "stringFormat"
//转化为数字,原字符串的制定用 nRadix，例如 10 ，表示10进制，16表示16进制
function boolean ToNumber(int nRadix,ref double value) system library "PbIdea.dll" alias for "stringToNumber"
function boolean ToNumber(int nRadix,ref int value) system library "PbIdea.dll" alias for "stringToNumber"
function boolean ToNumber(int nRadix,ref long value) system library "PbIdea.dll" alias for "stringToNumber"
//表达式搜索
function boolean RegexSearch(long nStart,readonly string pattern) system library "PbIdea.dll" alias for "stringRegexSearch"
function boolean RegexSearch(long nStart,readonly string pattern,ref string items[]) system library "PbIdea.dll" alias for "stringRegexSearch"
function boolean RegexSearch(long nStart,readonly string pattern,ref string items[],ref long postions[],ref long lengths[]) system library "PbIdea.dll" alias for "stringRegexSearch"
//icase: true/false, 忽略大小写，默认为 true
subroutine SetRegexOption(readonly string value,readonly string value) system library "PbIdea.dll" alias for "stringSetRegexOption"

//表达式匹配
function boolean RegexMatch(readonly string pattern) system library "PbIdea.dll" alias for "stringRegexMatch"
function boolean RegexMatch(readonly string pattern,ref string items[]) system library "PbIdea.dll" alias for "stringRegexMatch"
function boolean RegexMatch(readonly string pattern,ref string items[],ref long postions[],ref long lengths[]) system library "PbIdea.dll" alias for "stringRegexMatch"
//表达式替换,$0、$1、$2……等代表分组，所以上面$2代表第三组
function string RegexReplace(readonly string pattern,readonly string newString) system library "PbIdea.dll" alias for "stringRegexReplace"
//读文本文件,支持 ansi,utf8,utf16格式
function boolean ReadFile(readonly string textFileName) system library "PbIdea.dll" alias for "stringReadFile"
//将文本内容写入文件
function boolean WriteFile(readonly string textFileName) system library "PbIdea.dll" alias for "stringWriteFile"
function boolean WriteFile(readonly string textFileName,boolean bUTF8) system library "PbIdea.dll" alias for "stringWriteFile"
//字符集转换
function blob ToAnsi()  system library "PbIdea.dll" alias for "stringToAnsi"
function blob ToUtf8()  system library "PbIdea.dll" alias for "stringToUtf8"
function blob ToUtf16() system library "PbIdea.dll" alias for "stringToUtf16"
function blob ToUtf16(boolean UTF16BE) system library "PbIdea.dll" alias for "stringToUtf16"
function string FromUtf16(readonly blob utf16Data) system library "PbIdea.dll" alias for "stringFromUtf16"
function string FromUtf16(readonly blob utf16Data,boolean UTF16BE) system library "PbIdea.dll" alias for "stringFromUtf16"
//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"
//字符串缓存区地址,有些函数调用，可以传这个地址。例如需要预先分配空间的时候，可以 Resize(空间大小)，然后传入地址。
function ulong GetAddress() system library "PbIdea.dll" alias for "stringGetAddress"
//字符串的长度
function ulong GetLength() system library "PbIdea.dll" alias for "stringGetLength"
//重新计算字符串长度，当有其他函数操作了字符串缓存，需要执行本函数重新计算指针和长度
subroutine CalcLength() system library "PbIdea.dll" alias for "stringCalcLength"
//获取行数
function long GetLineCount() system library "PbIdea.dll" alias for "stringGetLineCount"
//取指定行内容
function string GetLine(long lineNumber) system library "PbIdea.dll" alias for "stringGetLine"
//以指定字符串，切分字符串.delim是一个字符串，每个字符都可以作为切割符，可同时指定多个切割符
function long Split(readonly string delim,ref string items[]) system library "PbIdea.dll" alias for "stringSplit"
function long Split(readonly string delim,ref string items[], boolean ignoreNull) system library "PbIdea.dll" alias for "stringSplit"
//比较2个字符串相似度,mode: 0 全部比较 ， 1 str1的str2的前面位置 , 2 str1 在 str2 的中间位置 ，默认为0
function long Compare(readonly string str1,readonly string str2) system library "PbIdea.dll" alias for "stringCompare"
function long Compare(readonly string str1,readonly string str2,int mode,boolean ignoreSpace,boolean ignoreNumber,boolean ignoreLetter,boolean ignoreSymbol,boolean ignoreCaseSensitive) system library "PbIdea.dll" alias for "stringCompare"
//转全角
function string toFull(readonly string str) system library "PbIdea.dll" alias for "stringFull"
//转半角
function string toHalf(readonly string str) system library "PbIdea.dll" alias for "stringHalf"
//取首字母拼音
function string PinYin(readonly string str) system library "PbIdea.dll" alias for "stringPinYin"
//简体转繁体
function string GBK2BIG5(readonly string str) system library "PbIdea.dll" alias for "stringGBK2BIG5"
//繁体转简体
function string BIG52GBK(readonly string str) system library "PbIdea.dll" alias for "stringBIG52GBK"
//繁体转简体
function string ChineseMoney(readonly string num) system library "PbIdea.dll" alias for "stringChineseMoney"
function string ChineseMoney(double num) system library "PbIdea.dll" alias for "stringChineseMoney"
function string ChineseMoney(decimal num) system library "PbIdea.dll" alias for "stringChineseMoney"
function string ChineseMoney(long num) system library "PbIdea.dll" alias for "stringChineseMoney"
function string ChineseMoney(int num) system library "PbIdea.dll" alias for "stringChineseMoney"
//根据指定标志，指定长度，取一个序号.本函数功能主要是在服务端，提供一个乱序，但不重复的单据号
function string GetRandSerial(string flag,int numLen) system library "PbIdea.dll" alias for "stringGetRandSerial"
//unescape
function string unescape(string str) system library "PbIdea.dll" alias for "stringUnescape"
//将~r和~n全部转成windows的 ~r~n
subroutine crlf() system library "PbIdea.dll" alias for "stringCRLF"
//将~r和~r~n全部转成 ~n
subroutine lf() system library "PbIdea.dll" alias for "stringLF"

//工具函数，打印数据到控制台
//format 格式参考 https://fmt.dev/dev/syntax.html
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"
//function int PrintStr(readonly string strTest) library "PbIdea.dll" alias for "_PrintStr"
subroutine OpenConsoleWindow() system library "PbIdea.dll" alias for "OpenConsoleWindow"
subroutine CloseConsoleWindow() system library "PbIdea.dll" alias for "CloseConsoleWindow"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_structure" id="uo_structure">uo_structure</a></div>
<pre><code>
//cn:动态structure
//en:Dynamic structure
public:
constant int ST_INT        = 1
constant int ST_INTETER    = 1
constant int ST_UINT       = 1
constant int ST_UINTEGER   = 1
constant int ST_SHORT      = 1
constant int ST_WORD       = 1
constant int ST_LONG       = 2
constant int ST_ULONG      = 2
constant int ST_DWORD      = 2
constant int ST_CHAR       = 3
constant int ST_BYTE       = 3
constant int ST_WCHAR      = 4

uo_blob _buffer

private:
int _nextID = 0
int _type[]
int _len[]
int _pos[]
int _bufsize

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_subclass" id="uo_subclass">uo_subclass</a></div>
<pre><code>
//cn:子类化
//en:Subclassification

/*
第一步：在窗口里声明instance变量，
uo_subclass subclass

第二步：初始化，并实现子类化
subclass = create uo_subclass
subclass.subclass(sle_count)

第三步：给子类化对象增加事件 ue_subclass,并且响应事件

====================================================================
> Event: uo_tabpage_utils.ue_subclass
>--------------------------------------------------------------------
> 描述: 
>--------------------------------------------------------------------
> 参数: 
> 	unsignedlong hwnd
> 	long msg
> 	long wparam
> 	long lparam	
>--------------------------------------------------------------------
> 返回:  boolean
>--------------------------------------------------------------------

if msg = 258 then //WM_CHAR
	if (wparam>= 48 and wparam <= 59) or wparam < 32 then //输入了数字和控制符
	   return false
	else
		MessageBox("","输入了非法字符")
		return true
	end if
end if
return false //返回false，系统会继续完成消息处理，返回 true，系统不再继续消息处理

*/

function boolean SubClass(powerobject obj) system library "PbIdea.dll" alias for "utilSubClass"
subroutine DisubClass() system library "PbIdea.dll" alias for "utilDisubClass"
function long CallProc(long uMsg, long wParam, long lParam) system library "PbIdea.dll" alias for "utilCallProc"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_svg" id="uo_svg">uo_svg</a></div>
<pre><code>
//svg render

string str

//打开svg文件，或者svg内容字符串
function boolean open(readonly string svg) system library "pbidea.dll" alias for "svgOpen"
//关闭
subroutine close() system library "pbidea.dll" alias for "svgClose"
//设置某一值
function string SetAttr(readonly string name, readonly string value) system library "pbidea.dll" alias for "svgSetAttribute"
function string SetAttr(readonly string svg, readonly string name, readonly string value) system library "pbidea.dll" alias for "svgSetAttribute"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_sysenv" id="uo_sysenv">uo_sysenv</a></div>
<pre><code>
//cn:系统环境变量相关处理
//en:System environment variable correlation processing

//获取环境变量列表
function int GetEnvStrings(ref string vars[]) system library "pbidea.dll" alias for "envGetEnvStrings"
//获取一个变量
function boolean GetEnvVar(readonly string key, ref string var) system library "pbidea.dll" alias for "envGetEnvVar"
//获取一个变量,如果成员是以 ; 分割，则生成数组，例如 PATH
function boolean GetEnvVar(readonly string key, ref string vars[]) system library "pbidea.dll" alias for "envGetEnvVar"
//添加一个环境变量
function boolean SetEnvVar(readonly string key, readonly string var) system library "pbidea.dll" alias for "envSetEnvVar"
//添加一个环境变量,appendToExists 指定是否追加到现有变量，以; 分割，例如 PATH
function boolean SetEnvVar(readonly string key, readonly string var,boolean appendToExists) system library "pbidea.dll" alias for "envSetEnvVar"
//删除一个环境变量
subroutine RemoveEnvVar(readonly string key) system library "pbidea.dll" alias for "envRemoveEnvVar"
//以固定分割符，切割字符串，结果放到数组里
function int Split(readonly string str,readonly string ch, ref string vars[]) system library "pbidea.dll" alias for "envSplit"
//进行实路径转换
function string GetPath(readonly string path) system library "pbidea.dll" alias for "envGetPath"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_tempfile" id="uo_tempfile">uo_tempfile</a></div>
<pre><code>
//临时文件管理，退出时会自动删除
//temp file,auto delete when exit

private:
subroutine Init() system library "pbidea.dll" alias for "tmpfileInit"
subroutine UnInit() system library "pbidea.dll" alias for "tmpfileUnInit"

public:
//获取临时文件名, addManager 默认为 true
function string GetFile() system library "pbidea.dll" alias for "tmpfileGetTempFile"
function string GetFile(readonly string fileNameOrExt) system library "pbidea.dll" alias for "tmpfileGetTempFile"
function string GetFile(readonly string fileNameOrExt, boolean addManager) system library "pbidea.dll" alias for "tmpfileGetTempFile"
//添加文件到管理器，以便会自动删除
subroutine Add(readonly string fileName) system library "pbidea.dll" alias for "tmpfileAddTempFile"
//移除
subroutine Remove(readonly string fileName) system library "pbidea.dll" alias for "tmpfileRemoveTempFile"
//是否存在
function boolean Exist(readonly string fileName) system library "pbidea.dll" alias for "tmpfileExist"
//删除当前对象管理的所有临时文件
subroutine Clear() system library "pbidea.dll" alias for "tmpfileClear"
//临时文件目录
function string GetPath() system library "pbidea.dll" alias for "tmpfileGetPath"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_thread" id="uo_thread">uo_thread</a></div>
<pre><code>
//cn:线程对象
//en:thread

private:
subroutine OnCreate() system library "PbIdea.dll" alias for "threadOnCreate"
subroutine OnDestroy() system library "PbIdea.dll" alias for "threadOnDestroy"
//内部调用，实际线程过程
subroutine ThreadProc(ulong ptr,readonly string proc, readonly any params[]) system library "PbIdea.dll" alias for "threadThreadProc"

public:

//退出函数时，调用此函数关闭线程，否则 factory 就有可能一直等待
subroutine ExitThread() system library "PbIdea.dll" alias for "threadExitThread"

//返回当前唯一线程实例名
function string GetThreadName() system library "PbIdea.dll" alias for "threadGetThreadName"
//调用 uo_thread_factory 事件或函数
function boolean InvokeFactory(string routineName, ...) system library "PbIdea.dll" alias for "threadInvokeRoutine"

//取全局值
function any GetGlobalVar(readonly string varName) system library "PbIdea.dll" alias for "threadGetGlobalVar"
//设置全局值
subroutine SetGlobalVar(readonly string varName, any value) system library "PbIdea.dll" alias for "threadSetGlobalVar"

//锁与解锁
function boolean Lock() system library "PbIdea.dll" alias for "threadLock"
function boolean UnLock() system library "PbIdea.dll" alias for "threadUnLock"

//
FUNCTION ulong GetCurrentThreadId() LIBRARY "kernel32.dll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_thread_factory" id="uo_thread_factory">uo_thread_factory</a></div>
<pre><code>
//cn:线程生产者
//en:thread factory

private:
subroutine OnCreate() system library "PbIdea.dll" alias for "threadOnCreateFactory"
subroutine OnDestroy() system library "PbIdea.dll" alias for "threadOnDestroyFactory"

public:

//启动一个线程
//参数说明：
//bGuiThread : 是否是带图形界面线程。决定是否启用线程内部消息循环
//libList: 库文件列表，如果为""，则使用当前程序的库列表，如果指定库列表，则使用指定列表。
//         指定库文件列表，可完成独立应用，可以是另一个程序的库拿来直接使用
//objectAndFunc : 形如uo_func.of_msgbox,即:对象.函数名称.
//                当线程被启动时，会自动实例化指定对象，并调用指定的函数。
//... : 省略点表示可选参数，即传递给指定对象的函数。
//返回值 : 线程句柄,可用作ResumeThread,SuspendThread,GetExitCodeThread,TerminateThread 等线程函数来操作此句柄
//例如,uo_func 对象有个函数of_msgbox,该函数有一个字符型参数，那么 可以这样启动线程：
// StartThread("func.pbl","uo_func.of_msgbox","这是of_msgbox的参数")
function long StartThread(string objectName,string funcName,...) system library "PbIdea.dll" alias for "threadStartThread"
//等待线程结束
subroutine WaitThreads(long msTimes) system library "PbIdea.dll" alias for "threadWaitThreads"
//查询当前还有多少线程在运行中
function int GetThreadCount() system library "PbIdea.dll" alias for "threadGetThreadCount"
//获取当前线程列表
function int GetThreadList(ref string threadNames[]) system library "PbIdea.dll" alias for "threadGetThreadList"
//关闭一个线程，内部实现了SharedObjectUnregister
subroutine CloseThread(ulong threadID) system library "PbIdea.dll" alias for "threadCloseThread"
//暂停一个线程
//function boolean SuspendThread(uo_thread thread) system library "PbIdea.dll" alias for "SuspendThreadEx"
//继续运行线程 
//function boolean ResumeThread(uo_thread thread) system library "PbIdea.dll" alias for "ResumeThreadEx"
//终止或者关闭一个线程 
//function boolean CloseThread(uo_thread thread) system library "PbIdea.dll" alias for "CloseThread"
//获取线程ID号
//function ulong GetThreadID(uo_thread thread) system library "PbIdea.dll" alias for "GetThreadID"
//获取线程返回值
//function boolean GetThreadReturn(uo_thread thread,ref any returnValue) system library "PbIdea.dll" alias for "GetThreadReturn"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_timer" id="uo_timer">uo_timer</a></div>
<pre><code>
//cn:基于线程异步的 timer 定时器对象
//en:Timer object based on thread asynchrony

//启动定时器,以后响应timer事件
subroutine start(long mesc) system library "pbidea.dll" alias for "timerStart"
subroutine start(long mesc, powerobject bindObject) system library "pbidea.dll" alias for "timerStart"
//停止定时器
subroutine stop() system library "pbidea.dll" alias for "timerStop"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_tooltip" id="uo_tooltip">uo_tooltip</a></div>
<pre><code>
//cn:tooltip提示控件
//en:Tooltip prompt control

private:
subroutine CreateTip() system library "PbIdea.dll" alias for "CreateTip"
subroutine DestroyTip() system library "PbIdea.dll" alias for "DestroyTip"

public:
subroutine ShowTip(powerobject obj, readonly string strTip) system library "PbIdea.dll" alias for "ShowTip"
subroutine ShowTip(powerobject obj, readonly string strTip, uo_json options) system library "PbIdea.dll" alias for "ShowTip"

public:
subroutine SetTooltipOption(uo_json options) system library "PbIdea.dll" alias for "SetTooltipOption"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_transaction" id="uo_transaction">uo_transaction</a></div>
<pre><code>
//事务对象
string ip = ""
int port = 0

any dws[] //异常断开时，抛出application.transactionend 事件，这里会记录哪些DW/DS曾经 SetTransObject

//连接数据库
function boolean tsConnect() system library "PbIdea.dll" alias for "tsConnect"
//断开数据库连接
function boolean tsDisConnect() system library "PbIdea.dll" alias for "tsDisConnect"
//重新 SetTransObject 
function boolean tsSetTransObject() system library "PbIdea.dll" alias for "tsSetTransObject"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_trayicon" id="uo_trayicon">uo_trayicon</a></div>
<pre><code>
//cn:托盘图标工具控件
//en:Tray icon tool control

constant int WM_TRAYICON = 2019

function boolean ShowBalloon(string title,string text,ulong timeoutms) system library "PbIdea.dll" alias for "tiShowBalloon"
function boolean PopupMenu(uo_json jsMenu) system library "PbIdea.dll" alias for "tiPopupMenu"
function boolean ChangeTitle(string tip,string info,string title) system library "PbIdea.dll" alias for "tiChangeTitle"
private:
function boolean AddTrayIcon(window w,string appName,string title,string icon,ulong msg) system library "PbIdea.dll" alias for "tiAddTrayIcon"
function boolean RemoveTrayIcon() system library "PbIdea.dll" alias for "tiRemoveTrayIcon"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_uhfreader18" id="uo_uhfreader18">uo_uhfreader18</a></div>
<pre><code>
//UHFReader18
//RFID

//打开端口，自动选择端口, baud 比特率
function boolean open(uo_json result) system library "pbidea.dll" alias for "uhfOpen"
function boolean open(uo_json result, long baud) system library "pbidea.dll" alias for "uhfOpen"
//关闭端口
subroutine close() system library "pbidea.dll" alias for "uhfClose"

function string GetWorkMode() system library "pbidea.dll" alias for "uhfGetWorkMode"

//设置工作模式,hex字符串，长度12，每2个字符表示一个字节
//Bit0=0时读写器支持18000-6C协议；Bit0=1时读写器支持18000-6B协议。
//Bit1=0时韦根输出，Bit1=1时RS232/RS485输出。
//Bit2=0时开蜂鸣器提示，Bit2=1时关蜂鸣器提示，默认值为0。
//Bit3=0时First_Adr为字地址；Bit3=1时First_Adr为字节地址。
function boolean SetWorkMode(boolean activeMode, int MemInven) system library "pbidea.dll" alias for "uhfSetWorkMode"
//读数据
//BYTE Mem = 0x01; //0x00: 保留区；0x01：EPC存储器；0x02：TID存储器；0x03：用户存储器。
//BYTE Num = 8; //Num不能超过120，即最多读取120个字
function int ReadData(uo_json data) system library "pbidea.dll" alias for "uhfReadData"
function int ReadData(uo_json data, int mem, int num) system library "pbidea.dll" alias for "uhfReadData"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_utils" id="uo_utils">uo_utils</a></div>
<pre><code>
//cn:工具类函数，包含许多增强功能
//en:Tool class function, including many enhancements

//ping 一个IP或主机 count次 ，测试是不是通，返回 通的次数，返回值为0，不通，等于 count ，信号 稳定，小于 count ，网络连接不佳 
//timeoutMS 为超时设置，毫秒
function int Ping(readonly string ip,int count,long timeoutMS) system library "PbIdea.dll" alias for "Ping"
//可以指定ping端口，用于连接前判断是否可连接，避免等待时间过长
function int Ping(readonly string ip,int count,long timeoutMS,int port) system library "PbIdea.dll" alias for "Ping"
//字符集转换
//blob srcData 源数据，如果是字符串，由 blob(字符串)
//string fromCharset,string toCharset ,从一个字符集到另一个字符集，可以取值
//gb18030 , utf-8 , utf-16 , utf-16le , utf-16be ,  更多转换功能项，可以 iconv -l 察看
function blob CharsetConvert(blob srcData,readonly string fromCharset,readonly string toCharset) system library "PbIdea.dll" alias for "CharsetConvert"
//取客户区大小，GetClientRect
subroutine GetClientSize(powerobject obj,ref int left,ref int top,ref int width,ref int height) system library "PbIdea.dll" alias for "GetClientSize"
subroutine GetClientSize(ulong hwnd,ref int left,ref int top,ref int width,ref int height) system library "PbIdea.dll" alias for "GetClientSize"

//取OCX 的 CLSID
function string GetCLSID(readonly string dllocxName) system library "PbIdea.dll" alias for "GetCLSID"

//取系统的CPU个数
function long GetCPUCount() system library "PbIdea.dll" alias for "GetCPUCount"

//返回 1 文本 ，2 图片,返回1时，ls_text = string(data),返回2时，data 里是一张图的内容，可以 p_1.SetPicture(data)
function long FetchClipboard(ref blob data) system library "PbIdea.dll" alias for "FetchClipboard"

//取当前堆栈里的变量信息、当前模块、事件名称、行号
function string QueryVar(string varName) system library "PbIdea.dll" alias for "QueryVar"
function string QueryVar(string varName,boolean trace) system library "PbIdea.dll" alias for "QueryVar"
//查当前执行栈位置
function string QueryStack() system library "PbIdea.dll" alias for "QueryStack"

function ulong H(readonly string strHex) SYSTEM library "PbIdea.dll" alias for "FromHex"

//第一个参数是函数名，然后都是参数。调用某对象下的函数，此函数声明要放到指定对象里面
function any RunRoutine(readonly string funcName,...) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是对象，第二个函数名是函数名，然后都是参数。调用某对象下的函数，此函数声明可以放到任意地方
function any RunRoutine(powerobject obj,readonly string funcName,...) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是函数名，然后都是参数。调用某对象下的函数，此函数声明要放到指定对象里面
function any RunRoutine(readonly string funcName, any args[]) system library "PbIdea.dll" alias for "RunRoutine"
//第一个参数是对象，第二个函数名是函数名，然后都是参数。调用某对象下的函数，此函数声明可以放到任意地方
function any RunRoutine(powerobject obj,readonly string funcName, any args[]) system library "PbIdea.dll" alias for "RunRoutine"

//枚举进程
function ulong GetProcessList(ref ulong ids[],ref string processNames[]) system library "PbIdea.dll" alias for "GetProcessList"
function ulong GetProcessList(ref ulong ids[],ref string processNames[], ref string err) system library "PbIdea.dll" alias for "GetProcessList"
//枚举进程里面的模块
function ulong GetProcessModuleList(ulong processID,ref ulong hModules[],ref string moduleNames[]) system library "PbIdea.dll" alias for "GetProcessModuleList"

//可以跨进程发送字符串消息
/*
有个A程序，
有个B程序
现在A程序通过FindWindow函数，可以找到B程序的数据窗口的 hwnd.
然后A程序发送消息给B程序的数据窗口。
比如发送另存为消息，指定文件名，会失败，而且一定程序会崩溃。那么就使用SendMessageEx来发送字符串消息吧
uo_utils u
u = create uo_utils
String FilePath
FilePath = "1.TXT"
u.sendmessageex(hwndDWforB,1305,-2,FilePath)
FilePath = "2.TXT"
u.sendmessageex(hwndDWforB,1305,2,FilePath)
destroy u
*/
function long SendMessageEx(ulong hwnd, uint msg,long wparam,string lparam)  SYSTEM library "PbIdea.dll" alias for "SendMessageEx"
//ansi参数在高版本PB向PB9及以下版本发消息时，请指定为 true
function long SendMessageEx(ulong hwnd, uint msg,long wparam,string lparam,boolean ansi)  SYSTEM library "PbIdea.dll" alias for "SendMessageEx"

//从库列表中取所有对象名称
function long ReadObjectNames(ref string names[])  SYSTEM library "PbIdea.dll" alias for "ReadObjectNames"
function long ReadObjectNames(readonly string libList,ref string names[])  SYSTEM library "PbIdea.dll" alias for "ReadObjectNames"

//从库列表中取对象内容
function blob ReadObjectContent(readonly string objectName)  SYSTEM library "PbIdea.dll" alias for "ReadObjectContent"
function blob ReadObjectContent(readonly string libList,readonly string objectName) SYSTEM library "PbIdea.dll" alias for "ReadObjectContent"

//从所有PBL源码中解析文件名，从而构建PBR文件
//extList 参数为包含列表，可以是"txt;bmp;jpg;jpeg"或".txt;.bmp;.jpg;.jpeg"之类
//searchDir是否扫描当前目录和子目录
function long ReadResourceList(ref string fileNames[],string extList,boolean searchDir)  SYSTEM library "PbIdea.dll" alias for "ReadResourceList"

//获取变量地址
function ulong AddressOf(any value)  SYSTEM library "PbIdea.dll" alias for "AddressOf"
//计算表达式
function double CalcExpression(readonly string expr)  SYSTEM library "PbIdea.dll" alias for "CalcExpression"
function double CalcExpression(readonly string expr,ref boolean success) SYSTEM library "PbIdea.dll" alias for "CalcExpression"

//获取输入法列表
function int GetInputList(uo_json inputList) system library "PbIdea.dll" alias for "GetInputList"
//切换输入法
function boolean InputChange(string inputID) system library "PbIdea.dll" alias for "InputChange"


//初始化应用程序（功能保密）
subroutine InitApplication(string appName) system library "PbIdea.dll" alias for "InitApplication"
//释放此功能
subroutine UnInitApplication() system library "PbIdea.dll" alias for "UnInitApplication"
//对系列文件进行打包加密
function boolean PackApplication(string packFile,string key,string files[]) system library "PbIdea.dll" alias for "PackApplication"

//给按钮安装消息过滤，自动显示按钮的clicked源码
subroutine InstallButtonMsgFilter(commandbutton btn) system library "PbIdea.dll" alias for "InstallButtonMsgFilter"
//与上函数功能相反
subroutine UnInstallButtonMsgFilter(commandbutton btn) system library "PbIdea.dll" alias for "UnInstallButtonMsgFilter"
//给可视对象安装mouse消息过滤，可以抓到控件的ue_mouseOver(int column,long row) 和 ue_mouseLeave() 事件
subroutine InstallMouseMsgFilter(powerobject obj) system library "PbIdea.dll" alias for "InstallMouseMsgFilter"

//选择颜色框
function boolean ChooseColor(ref long clr) system library "PbIdea.dll" alias for "utilChooseColor"

//弹出菜单,JSON结构同 menu.json, style
function string PopupMenu(powerobject obj, uo_json jsonMenu) system library "PbIdea.dll" alias for "menuPopupMenu"
function string PopupMenu(powerobject obj, uo_json jsonMenu, int style) system library "PbIdea.dll" alias for "menuPopupMenu"

//检查网卡状态
function boolean GetNetworkStatus() system library "PbIdea.dll" alias for "GetNetworkStatus"
//异步检查网络状态，网络状态变化时，会发通知给 obj，由event_name 触发
function boolean GetNetworkStatus(powerobject obj,string event_name) system library "PbIdea.dll" alias for "GetNetworkStatus"
//停止监控
subroutine StopGetNetworkStatus() system library "PbIdea.dll" alias for "StopGetNetworkStatus"
//生成对象参考手册
subroutine MakeManual(string libs[],string path, string css,string lang) system library "PbIdea.dll" alias for "MakeManual"
//设置license授权文件内容
subroutine SetLicense(readonly string license) system library "PbIdea.dll" alias for "licSetLicense"

//读对象的所有属性值
function int ReadObjectProperty(powerobject obj,ref string names[],ref any values[]) system library "PbIdea.dll" alias for "ReadObjectProperty"

//查找窗口
function int FindWindow(string title,boolean matchAll,ref ulong hwnds[]) system library "PbIdea.dll" alias for "utilFindWindow"

//压缩一下内存
subroutine PushMemory() system library "PbIdea.dll" alias for "sysPushMemory"
//取已使用内存大小
function ulong GetMemorySize() system library "PbIdea.dll" alias for "sysGetMemorySize"
//获取系统启动时间
function datetime GetSystemBootTime() system library "PbIdea.dll" alias for "sysGetSystemBootTime"

//使能输出到控制台，或者输出到文件
subroutine EnablePrintf(boolean enable) system library "PbIdea.dll" alias for "EnablePrintf"
subroutine EnablePrintf(readonly string fileName) system library "PbIdea.dll" alias for "EnablePrintf"
//EEE, dd MMM yyyy HH:mm:ss GMT, category: 默认为空，或者 en-US ...
function string GMT(boolean gmtime) system library "PbIdea.dll" alias for "utilGMT"
function string GMT(datetime dt) system library "PbIdea.dll" alias for "utilGMT"
function string GMT(string category, boolean gmtime) system library "PbIdea.dll" alias for "utilGMT"
function string GMT(datetime dt,string category) system library "PbIdea.dll" alias for "utilGMT"
//取颜色值
function long GetColor(long clr) system library "PbIdea.dll" alias for "utilGetColor"
//计算文本框的文本width height
FUNCTION boolean CalcTextSize(powerobject obj,readonly string text,ref long width,ref long height) system LIBRARY  "pbidea.dll" alias for "utilCalcTextSize"
FUNCTION boolean CalcTextSize(ulong hdc, readonly string fontName,int fontSize,readonly string text,ref long width,ref long height) system LIBRARY  "pbidea.dll" alias for "utilCalcTextSize"
//计算文本框的文本width height
FUNCTION string CalcText(readonly string fontname, int fontsize, long widthPixel,readonly string text,ref long height) system LIBRARY  "pbidea.dll" alias for "utilCalcText"
//check HaveSciLexer
FUNCTION boolean HaveSciLexer() system LIBRARY  "pbidea.dll" alias for "utilHaveSciLexer"
//取 keycode 码
FUNCTION int GetKeyCode(keycode key) system LIBRARY  "pbidea.dll" alias for "utilGetKeyCode"
//将字符串中的 double 去掉小数部分，转成 long
FUNCTION string DoubleToLong(readonly string str) system LIBRARY  "pbidea.dll" alias for "utilDoubleToLong"
//使某控件在指定时间（毫秒）内处于 enable = false状态
subroutine DelayObject(powerobject obj, long ms, readonly string format) system library "PbIdea.dll" alias for "utilDelayObject"
//对数组排序, method: 0 升序， 1 降序
function boolean sort(ref string arr[], int method) system library "PbIdea.dll" alias for "utilSort"
function boolean sort(ref long   arr[], int method) system library "PbIdea.dll" alias for "utilSort"
function boolean sort(ref int    arr[], int method) system library "PbIdea.dll" alias for "utilSort"

//解析地址信息
FUNCTION string ParseAddress(readonly string address) system LIBRARY  "pbidea.dll" alias for "ParseAddress"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_variable" id="uo_variable">uo_variable</a></div>
<pre><code>
//cn:变量直接处理函数
//en:Variable Direct Processing Function

//设置全局变量值
//可以是单纯变量，例如:string gs_var , SetGlobalVar("gs_var","new text")
//也可以对象属，例如全局声明: uo_object guo_obj,SetGlobalVar("guo.obj.text","new text")
function boolean SetGlobalVar(readonly string strVarname,readonly any value) system library "PbIdea.dll" alias for "SetGlobalVar"
//取全局变量值,单纯变量，例如:string gs_var,GetGlobalVar("gs_var")
function any GetGlobalVar(string strVarname) system library "PbIdea.dll" alias for "GetGlobalVar"
//对数组: long index 是数组索引,ref boolean success 取索引项是否成功
function any GetGlobalVar(string strVarname, long index, ref boolean success) system library "PbIdea.dll" alias for "GetGlobalVar"
//取对象所有的属性名称 ,GetPropNames(dw_1,ref ls_prop[]) 读出所有属性名称
function int GetPropNames(powerobject obj,ref string propertys[]) system library "PbIdea.dll" alias for "GetPropNames"
//取某个属性值，GetPropValue(dw_1,"dataobject")
function any GetPropValue(powerobject obj,string property)  system library "PbIdea.dll" alias for "GetPropValue"
//设置某个属性值,SetPropValue(dw_1,"dataobject","d_grid")
function boolean SetPropValue(powerobject obj,readonly string property,readonly any value)  system library "PbIdea.dll" alias for "SetPropValue"
/*
这组函数的用处：
假设，你有个配置文件  uo_config guo_config，这个里面你定义了很多属性，经常增减少，你比较麻烦。
select name into guo_config.sysname ...
 比如这样。
变量越多，你写得越麻烦。
那有没有简单的方法呢？
通常，你的变是一是在一个表里，是一个字段名。
那么，你可以弄一个游标，查这个表。
open cur;
loop while ...
fetch into :ls_name,:ls_value;
SetPropValue(guo_config,ls_name, ls_value)
end loop;
close cur;

循环把所有字段，从数据库里提出来，灌到对象里面。
很爽的。
*/


//工具函数，打印数据到控制台
function int Printf(string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//枚举所有对象和菜单,触发事件.
//obj 指定代理对象
//boolean objectEvent(powerobject obj, string typename, int refCount) //枚举对象时触发,返回 true，继续枚举，返回 false，停止枚举
//boolean menuEvent(window win, menu m) //枚举菜单时触发,返回 true，继续枚举，返回 false，停止枚举
subroutine EnumObjectsAndMenu(dragobject obj, readonly string objectEvent,readonly string menuEvent) system library "PbIdea.dll" alias for "EnumObjectsAndMenu"
//枚举所有对象和菜单,记入 json
subroutine EnumObjectsAndMenu(readonly uo_json js) system library "PbIdea.dll" alias for "EnumObjectsAndMenu"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_version" id="uo_version">uo_version</a></div>
<pre><code>
//version
string version
int major
int minor
int release
int build
string BuildDateTime
string sign

private:
//version
function any getVersion(readonly string var) system library "PbIdea.dll" alias for "getVersion"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_wait_box" id="uo_wait_box">uo_wait_box</a></div>
<pre><code>
//cn:基于多线程的等待框
//en:Multi thread based wait box

subroutine OpenWait(int nRadius, ulong clr,ulong clrBack, boolean bShowSecond, readonly string szTitle, int nMargin, long nReserve) system library "PbIdea.dll" alias for "OpenWait"
subroutine CloseWait() system library "PbIdea.dll" alias for "CloseWait"
subroutine SetWaitPos(int x ,int y) system library "PbIdea.dll" alias for "SetWaitPos"
function boolean GetWaitPos(ref int x ,ref int y,ref int w,ref int h) system library "PbIdea.dll" alias for "GetWaitPos"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_wavfile" id="uo_wavfile">uo_wavfile</a></div>
<pre><code>
//cn:wav文件合并与播放
//en:wav file merging and playing

//合并多个wav文件为一个,数据可以是 string或blob成员
function blob MergeFile(readonly any wavFiles[]) system library "PbIdea.dll" alias for "wavMergeFile"
function blob MergeFile(readonly any wavFiles[],string wavSaveFile) system library "PbIdea.dll" alias for "wavMergeFile"

//播放wav内容或文件
subroutine Play(blob wavData) system library "PbIdea.dll" alias for "wavPlay"
subroutine Play(string wavFile) system library "PbIdea.dll" alias for "wavPlay"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_websocket_client" id="uo_websocket_client">uo_websocket_client</a></div>
<pre><code>
//cn:websocket客户端
//en:websocket client

private:
subroutine wsCreate() system library "PbIdea.dll" alias for "wsCreate"
subroutine wsDestroy() system library "PbIdea.dll" alias for "wsDestroy"
public:

//设置代理
function boolean setProxy(readonly string proxy) system library "PbIdea.dll" alias for "wsSetProxy"
//设置header
function boolean setHeader(readonly string key,readonly string value) system library "PbIdea.dll" alias for "wsSetHeader"
//连接服务器
function boolean ConnectServer(readonly string url,readonly string memo) system library "PbIdea.dll" alias for "wsConnectServer"
function boolean ConnectServer(readonly string url,readonly string memo,long HeartbeatTimeMS) system library "PbIdea.dll" alias for "wsConnectServer"
function boolean ConnectServer(readonly string url,readonly string memo,long HeartbeatTimeMS,boolean autoReconnect) system library "PbIdea.dll" alias for "wsConnectServer"
//断开连接
function boolean DisconnectServer() system library "PbIdea.dll" alias for "wsDisconnectServer"
function boolean DisconnectServer(boolean triggerOnClose) system library "PbIdea.dll" alias for "wsDisconnectServer"
//发消息
function boolean SendMessage(readonly blob msg) system library "PbIdea.dll" alias for "wsSendMessageClient"
function boolean SendMessage(readonly string msg) system library "PbIdea.dll" alias for "wsSendMessageClient"
function boolean SendMessage(readonly string msg,boolean toUtf8) system library "PbIdea.dll" alias for "wsSendMessageClient"
//返回连接状态0:connecting , 1:open = 1, 2:closing , 3:closed
function int GetStatus() system library "PbIdea.dll" alias for "wsGetStatus"


//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(string str) system library "PbIdea.dll" alias for "ToUTF8"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_websocket_server" id="uo_websocket_server">uo_websocket_server</a></div>
<pre><code>
//cn:web服务器，包含http和websocket功能
//en:Web server, including http and websocket functions

//响应消息类型
constant int ACTION_NULL     = 0
constant int ACTION_START    = 1
constant int ACTION_STOP     = 2
constant int ACTION_MESSAGE  = 3
constant int ACTION_OPEN     = 4
constant int ACTION_CLOSE    = 5
constant int ACTION_FAIL     = 6
constant int ACTION_HTTP     = 7
constant int ACTION_PING     = 8
constant int ACTION_PONGTIMEOUT  = 9
constant int ACTION_VALIDATE     = 10
constant int ACTION_SCHEUDLE     = 11

//以下对象会由 pss 自动初始化
uo_json request      //请求数据
uo_json session      //登录session信息
uo_map  header       //设置响应头

int     httpcode =   200  //返回值
string  charset  = "utf8" //默认字符集 or gbk

//以下响应数据，只要设置其中一个即可,下列变量声明顺序，也是响应有效顺序
blob    bresponse    //二进制响应数据
string  sresponse    //字符串型响应数据，与 response 对象,bresponse 只需要设置其中一个
uo_json response     //响应数据


/*
任务计划定义, 参考linux cron
crontab的命令构成为 时间+动作，其时间有分、时、日、月、周五种，操作符有
* 取值范围内的所有数字
/ 每过多少个数字
- 从X到Z
，散列数字
实例

实例1：每1分钟执行一次myCommand
* * * * * myCommand

实例2：每小时的第3和第15分钟执行
3,15 * * * * myCommand

实例3：在上午8点到11点的第3和第15分钟执行
3,15 8-11 * * * myCommand

实例4：每隔两天的上午8点到11点的第3和第15分钟执行
3,15 8-11 *~/2  *  * myCommand

实例5：每周一上午8点到11点的第3和第15分钟执行
3,15 8-11 * * 1 myCommand

实例6：每晚的21:30重启smb
30 21 * * * /etc/init.d/smb restart

实例7：每月1、10、22日的4 : 45重启smb
45 4 1,10,22 * * /etc/init.d/smb restart

实例8：每周六、周日的1 : 10重启smb
10 1 * * 6,0 /etc/init.d/smb restart

实例9：每天18 : 00至23 : 00之间每隔30分钟重启smb
0,30 18-23 * * * /etc/init.d/smb restart

实例10：每星期六的晚上11 : 00 pm重启smb
0 23 * * 6 /etc/init.d/smb restart

实例11：每一小时重启smb
0 *~/1 * * * /etc/init.d/smb restart

实例12：晚上11点到早上7点之间，每隔一小时重启smb
0 23-7/1 * * * /etc/init.d/smb restart

*/

//启动 websocket/http 服务
function boolean Start(readonly uo_json jsParam) system library "PbIdea.dll" alias for "wsStartServer"
//停止 websocket/http 服务
function boolean Stop() system library "PbIdea.dll" alias for "wsStopServer"
//根据事件提供的ID号，取回请求消息，内容为JSON

//强行关闭一个客户端，通常是验证没有通过，关闭之
subroutine CloseClient(ulong hdl) system library "PbIdea.dll" alias for "wsCloseClient"

function boolean GetMessage(ulong messageID,uo_json js) system library "PbIdea.dll" alias for "wsGetMessageServer"
//根据事件提供的ID号，发送一个 websocket 消息。仅用于 websocket 消息
function boolean SendMessage(ulong messageHandle,readonly blob msg) system library "PbIdea.dll" alias for "wsSendMessageServer"
function boolean SendMessage(ulong messageHandle,readonly string msg) system library "PbIdea.dll" alias for "wsSendMessageServer"
function boolean SendMessage(ulong messageHandle,readonly string msg,boolean toUtf8) system library "PbIdea.dll" alias for "wsSendMessageServer"
//消息群发、推送
function boolean Broadcast(readonly blob msg) system library "PbIdea.dll" alias for "wsBroadcast"
function boolean Broadcast(readonly string msg) system library "PbIdea.dll" alias for "wsBroadcast"
function boolean Broadcast(readonly string msg,boolean toUtf8) system library "PbIdea.dll" alias for "wsBroadcast"
//获取 client 列表
function int GetClientList(uo_json json) system library "PbIdea.dll" alias for "wsGetClientList"
function int GetClientByHandle(uo_json json,ulong hdl) system library "PbIdea.dll" alias for "wsGetClientByHandle"

//根据事件提供的ID号，对相应请求设置相应的响应内容和格式头。用于 webapi/http
function boolean SetResponse(ulong messageID,readonly uo_json json,readonly uo_map head) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly uo_xml data,readonly uo_map head) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly blob data,readonly uo_map head) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly string data,readonly uo_map head) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly uo_json json,readonly uo_map head,int nhttpcode) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly uo_xml data,readonly uo_map head,int nhttpcode) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly blob data,readonly uo_map head,int nhttpcode) system library "PbIdea.dll" alias for "wsSetResponse"
function boolean SetResponse(ulong messageID,readonly string data,readonly uo_map head,int nHttpcode) system library "PbIdea.dll" alias for "wsSetResponse"
//发送文件作为响应内容，如果数据量比较大的情况下，这样可以节省内存，效率比较高,autoDelete 指示是否发送后自动删除
function boolean SetResponseFile(ulong messageID,readonly string fileName,readonly uo_map head,boolean autoDelete) system library "PbIdea.dll" alias for "wsSetResponseFile"

//根据事件提供的ID号，移除缓存在内存中的请求包
subroutine RemoveMessage(ulong messageID) system library "PbIdea.dll" alias for "wsRemoveMessageServer"

//初始化变量数据库文件名和密码，默认为"./db/pss" "pbidea ss",访问时会自动打开,sync默认false,cacheSize默认0
subroutine InitVar(readonly string dbName,readonly string password) system library "PbIdea.dll" alias for "wsInitVar"
subroutine InitVar(readonly string dbName,readonly string password,boolean sync,long cacheSize) system library "PbIdea.dll" alias for "wsInitVar"
//关闭变量数据库，下次访问时会自动打开
subroutine CloseVar() system library "PbIdea.dll" alias for "wsCloseVar"
//跨线程变量访问,这些共用变量是进程内全局共享
//可以设置超时时间，即超过多少毫秒没有访问后，判断此变量即为过期
subroutine SetVar(readonly string varName,readonly any value) system library "PbIdea.dll" alias for "wsSetVar"
subroutine SetVar(readonly string varName,readonly any value,long timeout) system library "PbIdea.dll" alias for "wsSetVar"
//根据变量名取变量值
function any GetVar(readonly string varName) system library "PbIdea.dll" alias for "wsGetVar"
//根据变量名判断此变量是否已过期，即自动根据 SetVar 设置的超时时间，判断是否已经过 timeout 没有访问过
function boolean VarExpired(readonly string varName) system library "PbIdea.dll" alias for "wsVarExpired"
//根据变量名判断此变量是否存的
function boolean VarExist(readonly string varName) system library "PbIdea.dll" alias for "wsVarExist"
//删除一个全局变量
subroutine RemoveVar(readonly string varName) system library "PbIdea.dll" alias for "wsRemoveVar"

//获取一个不会重复的字符串，确保唯一性
function string GetNextID() system library "PbIdea.dll" alias for "wsGetNextID"

//保存和还原所有全局变量
subroutine SaveVar() system library "PbIdea.dll" alias for "wsSaveVar"
subroutine RestoreVar() system library "PbIdea.dll" alias for "wsRestoreVar"

//UTF8转换
function string FromUTF8(readonly blob utf8Data) system library "PbIdea.dll" alias for "FromUTF8"
function blob ToUTF8(readonly string str) system library "PbIdea.dll" alias for "ToUTF8"

//获取一个临时文件名
function string GetTempFilename(readonly string ext) system library "PbIdea.dll" alias for "wsGetTempFilename"

//取系统的CPU个数
function long GetCPUCount() system library "PbIdea.dll" alias for "GetCPUCount"

//取当前堆栈里的变量信息、当前模块、事件名称、行号
function string QueryVar(string varName) system library "PbIdea.dll" alias for "QueryVar"
function string QueryVar(string varName,boolean trace) system library "PbIdea.dll" alias for "QueryVar"

//返回最后错误
function string GetError() system library "PbIdea.dll" alias for "wsGetError"

//同步锁
subroutine Lock() system library "PbIdea.dll" alias for "wsLock"
subroutine UnLock() system library "PbIdea.dll" alias for "wsUnLock"

//基于多进程服务模式，在响应事件里调用此函数可通知当前进程退出，有新请求时，会自动重建进程
//subroutine QuitTask() system library "PbIdea.dll" alias for "wsQuitTask"

//基于多进程服务模式，获取各进程工作情况, js接收数据， bUpdate 自上次取过以后信息是否更新
function int GetRequestInfo(uo_json js, ref boolean bUpdate) system library "PbIdea.dll" alias for "wsGetRequestInfo"

//添加计划任务
function boolean SetSchedule(readonly string name, readonly string schedule, readonly string memo) system library "PbIdea.dll" alias for "wsSetSchedule"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_webview2" id="uo_webview2">uo_webview2</a></div>
<pre><code>
//cn:基于 webView2 的浏览器控件
//en:Browser control based on webView2

private:
//私有函数，不开放
subroutine wbCreate() system library "pbidea.dll" alias for "wbCreate"
subroutine wbDestroy() system library "pbidea.dll" alias for "wbDestroy"

public:
//判断是否支持，WIN7以上系统才支持
function boolean support() system library "pbidea.dll" alias for "scSupport"
//获取 webView2 版本，如果没有版本，说明没有安装
function boolean GetVerInfo(readonly string path, ref string verInfo) system library "pbidea.dll" alias for "wbGetVerInfo"
//设置选项
/*
uo_json opt
opt = create uo_json
opt.set("title","pbidea webView2")
opt.set("isAddProtocol",true)
opt.set("isInPrivate",true)
opt.set("isDevToolsEnabled",false)           //禁F2打开调试
opt.set("isefaultContextMenusEnabled",false) //禁右键菜单
opt.set("downloadPath","./tmp/download")
opt.set("profileName","./tmp/wv2.data")
opt.set("home","http://218.94.103.156:8090/download")
opt.set("language","zh-cn")
opt.set("browserExecutableFolder","C:\Program Files (x86)\Microsoft\EdgeWebView\Application\103.0.1264.37")
opt.set("userDataFolder","./tmp/wv2")
opt.set("ignoreSubDir", false) //是否在userDataFolder后面追加以进程句柄为名称的子目录作为当前实例的临时目录,默认是false，设置为true时所有目录固定为同一目录
opt.set("additionalBrowserArguments","")
opt.set("/map/0/host","pbidea.com")
opt.set("/map/0/folder","../demores/html")
destroy opt
*/
subroutine SetOption(uo_json opt) system library "pbidea.dll" alias for "wbSetOption"

//创建浏览器，通常在窗口初始化时调用此函数
function boolean CreateWebBrowser() system library "pbidea.dll" alias for "wbCreateWebBrowser"
function boolean CreateWebBrowser(string urlHome) system library "pbidea.dll" alias for "wbCreateWebBrowser"
//加载指定url
function boolean LoadUrl(string url) system library "pbidea.dll" alias for "wbLoadUrl"
//加载指定html内容
function boolean LoadHtml(string html) system library "pbidea.dll" alias for "wbLoadHtml"
//加载资源, method: POST GET
function boolean LoadResource(string url, string method, string headers, string data) system library "pbidea.dll" alias for "wbLoadResource"
//判断是否可以返回
function boolean CanGoBack() system library "pbidea.dll" alias for "wbCanGoBack"
//判断是否可以向前
function boolean CanGoForward() system library "pbidea.dll" alias for "wbCanGoForward"
//返回
function boolean GoBack() system library "pbidea.dll" alias for "wbGoBack"
//向前
function boolean GoForward() system library "pbidea.dll" alias for "wbGoForward"
//返回首页
function boolean GoHome() system library "pbidea.dll" alias for "wbGoHome"
//刷新
function boolean Refresh() system library "pbidea.dll" alias for "wbRefresh"
//页面生成 pdf
function boolean PrintToPdf(string fileName,boolean Landscape) system library "pbidea.dll" alias for "wbPrintToPdf"
//屏幕截图
function boolean SaveScreenshot(string fileName) system library "pbidea.dll" alias for "wbSaveScreenshot"
//打开调试窗口
subroutine OpenDevToolsWindow() system library "pbidea.dll" alias for "wbOpenDevToolsWindow"
//运行 javaScript脚本，此函数会触发 on_execute_script 事件，并得到结果
function boolean ExecuteScript(readonly string script) system library "pbidea.dll" alias for "wbExecuteScript"
function boolean ExecuteScript(readonly string script,ref string result) system library "pbidea.dll" alias for "wbExecuteScript"
function boolean ExecuteScriptInFrame(readonly string script, readonly string frameName) system library "pbidea.dll" alias for "wbExecuteScript"
function boolean ExecuteScriptInFrame(readonly string script, readonly string frameName, ref string result) system library "pbidea.dll" alias for "wbExecuteScript"

//向webview发送消息，html js 里使用 window.chrome.webview.addEventListener('message', handler) 监听消息
subroutine PostWebMessage(uo_json json) system library "pbidea.dll" alias for "wbPostWebMessage"
subroutine PostWebMessage(uo_json json, readonly string frameName) system library "pbidea.dll" alias for "wbPostWebMessage"
subroutine PostWebMessage(readonly string msg) system library "pbidea.dll" alias for "wbPostWebMessage"
subroutine PostWebMessage(readonly string msg, readonly string frameName) system library "pbidea.dll" alias for "wbPostWebMessage"
//获取得输入焦点
subroutine SetWebFocus() system library "pbidea.dll" alias for "wbSetFocus"

//工具函数
subroutine SetWindowIcon(window win,ulong hicon) system library "pbidea.dll" alias for "wbSetWindowIcon"

//print
/*
uo_json js; js = create uo_json
js.Set("printerName", printerName);
js.Set("footerUri", footerUri);
js.Set("headerTitle", headerTitle);
js.Set("marginLeft", marginLeft);
js.Set("marginTop", marginTop);
js.Set("marginRight", marginRight);
js.Set("marginBottom", marginBottom);
js.Set("copies", copies);
js.Set("pagesPerSide", pagesPerSide);
js.Set("pageRanges", pageRanges);
js.Set("orientation", orientation);
js.Set("pageHeight", pageHeight);
js.Set("pageWidth", pageWidth);
js.Set("scaleFactor", scaleFactor);
js.Set("shouldBackgrounds", shouldBackgrounds);
js.Set("shouldHeaderAndFooter", shouldHeaderAndFooter);
js.Set("shouldPrintSelectionOnly", shouldPrintSelectionOnly);
以上参数可选填
*/
subroutine print(uo_json option) system library "pbidea.dll" alias for "wbPrint"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_widgetstack" id="uo_widgetstack">uo_widgetstack</a></div>
<pre><code>
//堆叠控件
window _win
boolean removeborder = true //当添加窗口时，默认去掉窗口边框

//私有函数
private:
subroutine stackCreate() system library "pbidea.dll" alias for "stackCreate"
subroutine stackDestroy() system library "pbidea.dll" alias for "stackDestroy"

//公有函数
public:
//取子控件个数
function int count() system library "pbidea.dll" alias for "stackCount"
//根据索引获取子控件
function powerobject GetItem(int index) system library "pbidea.dll" alias for "stackGetItem"
//打开添加控件到堆叠管理
function boolean Open(readonly powerobject obj, readonly string param) system library "pbidea.dll" alias for "stackOpenObject"
function boolean Open(readonly powerobject obj, readonly string param, boolean show) system library "pbidea.dll" alias for "stackOpenObject"
function boolean Open(readonly powerobject obj, readonly string param, boolean show, boolean byOpenUserObject) system library "pbidea.dll" alias for "stackOpenObject"
//查找是否存在
function powerobject find(powerobject obj) system library "pbidea.dll" alias for "stackFind"
function powerobject find(readonly string classdef) system library "pbidea.dll" alias for "stackFind"
//显示指定子控件
function boolean show(powerobject obj) system library "pbidea.dll" alias for "stackShowItem"
function boolean show(int index) system library "pbidea.dll" alias for "stackShowItem"
//关闭所有子控件
subroutine CloseAll() system library "pbidea.dll" alias for "stackClose"
//获取当前最顶层控件，即当前显示控件
function powerobject GetTopItem() system library "pbidea.dll" alias for "stackGetTopItem"
//关闭指定控件
function boolean CloseItem() system library "pbidea.dll" alias for "stackCloseItem"
function boolean CloseItem(readonly powerobject obj) system library "pbidea.dll" alias for "stackCloseItem"
//设置四周边距
subroutine SetPadding(int left, int top, int right, int bottom) system library "pbidea.dll" alias for "stackSetPadding"
//取json列表菜单，以便uo_util.PopupMenu可以弹出菜单
function string GetMenu() system library "pbidea.dll" alias for "stackGetListMenu"
//
subroutine BeginStack() system library "pbidea.dll" alias for "stackBeginStack"
subroutine EndStack() system library "pbidea.dll" alias for "stackEndStack"
//是否显示 header, 即 TAB 
subroutine SetHeader(int headerHeight, readonly string headerStyle, int positon) system library "pbidea.dll" alias for "stackSetHeader"
//设置固定项个数, 为-1，所有项均固定，不显示 x 标记
subroutine SetFixCount(int count) system library "pbidea.dll" alias for "stackSetFixCount"
//设置header颜色等皮肤特性
subroutine SetSkin(uo_json skin) system library "pbidea.dll" alias for "stackSetSkin"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_wmf" id="uo_wmf">uo_wmf</a></div>
<pre><code>
//wmf

private:
subroutine wmfDestroy() system library "pbidea.dll" alias for "wmfDestroy"

public:
//打印 dw ，截图
function boolean Print(datawindow dw, readonly string file) system library "pbidea.dll" alias for "wmfPrint"
//开始绘制，返回 hdc
function ulong BeginPaint() system library "pbidea.dll" alias for "wmfBeginPaint"
//结束绘制，内部会生成数据，返回 HENHMETAFILE
function ulong EndPaint() system library "pbidea.dll" alias for "wmfEndPaint"
//保存为文件 
function boolean Save(readonly string file) system library "pbidea.dll" alias for "wmfSave"
//返回 blob 数据
function blob Data() system library "pbidea.dll" alias for "wmfData"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_wxface" id="uo_wxface">uo_wxface</a></div>
<pre><code>
//微信人脸支付
//调用WxpayFaceSDK.dll，实现微信刷脸支付
//文档:https://pay.weixin.qq.com/wiki/doc/wxfacepay/develop/windows/facepay.html

uo_json response

//代理，如果有的话
string ip = ""
string port = ""
string user = "username"
string passwd = "password"

string store_id = "11"     //门店编号， 由商户定义， 各门店唯一。
string store_name = "name" //门店名称，由商户定义。（可用于展示）
string device_id = "d001"  //终端设备编号，由商户定义。
string appid = "appid123"  //商户号绑定的公众号/小程序 appid
string mch_id = ""         //商户号


//商户平台设置的密钥
string key = ""

private:
  uo_json apires
  boolean debug = true
  boolean _inited = false

private:
//调用WxpayFaceSDK.dll，实现微信刷脸支付
/*
initWxpayface
getWxpayfaceRawdata
getWxpayfaceCode
releaseWxpayface
*/
function boolean _Request(uo_json req, uo_json res) system library "pbidea.dll" alias for "wxfaceRequest"

public:
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_base" id="uo_xl_base">uo_xl_base</a></div>
<pre><code>
//

//constant
//cell type
constant int CELLTYPE_EMPTY      = 0
constant int CELLTYPE_NUMBER     = 1
constant int CELLTYPE_STRING     = 2
constant int CELLTYPE_BOOLEAN    = 3
constant int CELLTYPE_BLANK      = 4
constant int CELLTYPE_ERROR      = 5
constant int CELLTYPE_STRICTDATE = 6


//font.underline
constant integer   UNDERLINE_NONE      = 0
constant integer   UNDERLINE_SINGLE    = 1
constant integer   UNDERLINE_DOUBLE    = 2
constant integer   UNDERLINE_SINGLEACC = 33 //0x21
constant integer   UNDERLINE_DOUBLEACC = 34 //0x22

//NUMFORMAT 定义
constant int NUMFORMAT_GENERAL                       = 0
constant int NUMFORMAT_NUMBER                        = 1
constant int NUMFORMAT_NUMBER_D2                     = 2
constant int NUMFORMAT_NUMBER_SEP                    = 3
constant int NUMFORMAT_NUMBER_SEP_D2                 = 4
constant int NUMFORMAT_CURRENCY_NEGBRA               = 5
constant int NUMFORMAT_CURRENCY_NEGBRARED            = 6
constant int NUMFORMAT_CURRENCY_D2_NEGBRA            = 7
constant int NUMFORMAT_CURRENCY_D2_NEGBRARED         = 8
constant int NUMFORMAT_PERCENT                       = 9
constant int NUMFORMAT_PERCENT_D2                    = 10
constant int NUMFORMAT_SCIENTIFIC_D2                 = 11
constant int NUMFORMAT_FRACTION_ONEDIG               = 12
constant int NUMFORMAT_FRACTION_TWODIG               = 13
constant int NUMFORMAT_DATE                          = 14
constant int NUMFORMAT_CUSTOM_D_MON_YY               = 15
constant int NUMFORMAT_CUSTOM_D_MON                  = 16
constant int NUMFORMAT_CUSTOM_MON_YY                 = 17
constant int NUMFORMAT_CUSTOM_HMM_AM                 = 18
constant int NUMFORMAT_CUSTOM_HMMSS_AM               = 19
constant int NUMFORMAT_CUSTOM_HMM                    = 20
constant int NUMFORMAT_CUSTOM_HMMSS                  = 21
constant int NUMFORMAT_CUSTOM_MDYYYY_HMM             = 22
constant int NUMFORMAT_NUMBER_SEP_NEGBRA             = 37
constant int NUMFORMAT_NUMBER_SEP_NEGBRARED          = 38
constant int NUMFORMAT_NUMBER_D2_SEP_NEGBRA          = 39
constant int NUMFORMAT_NUMBER_D2_SEP_NEGBRARED       = 40
constant int NUMFORMAT_ACCOUNT                       = 41
constant int NUMFORMAT_ACCOUNTCUR                    = 42
constant int NUMFORMAT_ACCOUNT_D2                    = 43
constant int NUMFORMAT_ACCOUNT_D2_CUR                = 44
constant int NUMFORMAT_CUSTOM_MMSS                   = 45
constant int NUMFORMAT_CUSTOM_H0MMSS                 = 46
constant int NUMFORMAT_CUSTOM_MMSS0                  = 47
constant int NUMFORMAT_CUSTOM_000P0E_PLUS0           = 48
constant int NUMFORMAT_TEXT                          = 49

//ALIGNH
constant int ALIGNH_GENERAL        = 0
constant int ALIGNH_LEFT           = 1
constant int ALIGNH_CENTER         = 2
constant int ALIGNH_RIGHT          = 3
constant int ALIGNH_FILL           = 4
constant int ALIGNH_JUSTIFY        = 5
constant int ALIGNH_MERGE          = 6
constant int ALIGNH_DISTRIBUTED    = 7

//ALIGNV
constant int ALIGNV_TOP            = 0
constant int ALIGNV_CENTER         = 1
constant int ALIGNV_BOTTOM         = 2
constant int ALIGNV_JUSTIFY        = 3
constant int ALIGNV_DISTRIBUTED    = 4

//BORDERSTYLE
constant int BORDERSTYLE_NONE             = 0
constant int BORDERSTYLE_THIN             = 1
constant int BORDERSTYLE_MEDIUM           = 2
constant int BORDERSTYLE_DASHED           = 3
constant int BORDERSTYLE_DOTTED           = 4
constant int BORDERSTYLE_THICK            = 5
constant int BORDERSTYLE_DOUBLE           = 6
constant int BORDERSTYLE_HAIR             = 7
constant int BORDERSTYLE_MEDIUMDASHED     = 8
constant int BORDERSTYLE_DASHDOT          = 9
constant int BORDERSTYLE_MEDIUMDASHDOT    = 10
constant int BORDERSTYLE_DASHDOTDOT       = 11
constant int BORDERSTYLE_MEDIUMDASHDOTDOT = 12
constant int BORDERSTYLE_SLANTDASHDOT     = 13

//BORDERDIAGONAL
constant int BORDERDIAGONAL_NONE  = 0
constant int BORDERDIAGONAL_DOWN  = 1
constant int BORDERDIAGONAL_UP    = 2
constant int BORDERDIAGONAL_BOTH  = 3

//FILLPATTERN
constant int FILLPATTERN_NONE                = 0
constant int FILLPATTERN_SOLID               = 1
constant int FILLPATTERN_GRAY50              = 2
constant int FILLPATTERN_GRAY75              = 3
constant int FILLPATTERN_GRAY25              = 4
constant int FILLPATTERN_HORSTRIPE           = 5
constant int FILLPATTERN_VERSTRIPE           = 6
constant int FILLPATTERN_REVDIAGSTRIPE       = 7
constant int FILLPATTERN_DIAGSTRIPE          = 8
constant int FILLPATTERN_DIAGCROSSHATCH      = 9
constant int FILLPATTERN_THICKDIAGCROSSHATCH = 10
constant int FILLPATTERN_THINHORSTRIPE       = 11
constant int FILLPATTERN_THINVERSTRIPE       = 12
constant int FILLPATTERN_THINREVDIAGSTRIPE   = 13
constant int FILLPATTERN_THINDIAGSTRIPE      = 14
constant int FILLPATTERN_THINHORCROSSHATCH   = 15
constant int FILLPATTERN_THINDIAGCROSSHATCH  = 16
constant int FILLPATTERN_GRAY12P5            = 17
constant int FILLPATTERN_GRAY6P25            = 28

//啥也不干的一个空函数
subroutine   NoSet(any v_null) system library "pbidea.dll" alias for "xlNoSet"
function any NoGet() system library "pbidea.dll" alias for "xlNoGet"

//颜色和日期处理
function long     PackColor(long color) system library "pbidea.dll" alias for "xlPackColor"
function long     UnPackColor(long color) system library "pbidea.dll" alias for "xlUnPackColor"
function double   PackDate(datetime dt) system library "pbidea.dll" alias for "xlPackDate"
function double   PackDate(date dt) system library "pbidea.dll" alias for "xlPackDate"
function datetime UnPackDate(double dt) system library "pbidea.dll" alias for "xlUnPackDate"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_book" id="uo_xl_book">uo_xl_book</a></div>
<pre><code>
//libxl wrapper
public:

INDIRECT string   ErrMsg               {NoSet(*value),           GetErrorMessage()}
INDIRECT integer  FontCount            {NoSet(*value),           GetFontCount()}
INDIRECT integer  FormatCount          {NoSet(*value),           GetFormatCount()}
INDIRECT integer  PictureCount         {NoSet(*value),           GetPictureCount()}
INDIRECT integer  SheetCount           {NoSet(*value),           SheetCount()}
INDIRECT integer  ActiveSheet          {SetActiveSheet(*value), GetActiveSheet()}


indirect uo_xl_sheet sheets[] {&
                     NoSet(*name, *value), &
                     NoSet(*name, *args, *value), &
                     sheet_get_array(*name), &
                     sheet_get_item(*name, *args), &
                     SheetCount(), &
                     sheetLowerBound()}

protected:
subroutine xlInitXL() system library "pbidea.dll" alias for "xlInitXL"
function boolean xlCreate(int xlsType) system library "pbidea.dll" alias for "xlCreate"
subroutine xlDestroy() system library "pbidea.dll" alias for "xlDestroy"

public:
//打开xls/xlsx文件
function boolean Open(readonly string file) system library "pbidea.dll" alias for "xlbookOpen"
function boolean Open(readonly string file, readonly string local) system library "pbidea.dll" alias for "xlbookOpen"
//打开blob xls/xlsx文件
function boolean Open(readonly blob raw) system library "pbidea.dll" alias for "xlbookOpen"
function boolean Open(readonly blob raw, readonly string local) system library "pbidea.dll" alias for "xlbookOpen"
//保存xls/xlsx文件
function boolean save(readonly string file) system library "pbidea.dll" alias for "xlbookSave"
function blob save(ref boolean success) system library "pbidea.dll" alias for "xlbookSave"

//get sheet count
function int SheetCount() system library "pbidea.dll" alias for "xlbookGetSheetCount"
//插入新sheet, 索引 1,2,3,4,5 ...
function uo_xl_sheet InsertSheet(int index, readonly string sheetName) system library "pbidea.dll" alias for "xlbookInsertSheet"
//根据索引或者名称取 sheet
function uo_xl_sheet GetSheet(int index) system library "pbidea.dll" alias for "xlbookGetSheet"
function uo_xl_sheet GetSheet(readonly string sheetName) system library "pbidea.dll" alias for "xlbookGetSheet"
//删除 sheet
function boolean RemoveSheet(int index) system library "pbidea.dll" alias for "xlbookRemoveSheet"
function boolean RemoveSheet(readonly string sheetName) system library "pbidea.dll" alias for "xlbookRemoveSheet"
//设置/获取活动sheet
subroutine SetActiveSheet(int index) system library "pbidea.dll" alias for "xlbookSetActiveSheet"
function integer GetActiveSheet() system library "pbidea.dll" alias for "xlbookGetActiveSheet"

//添加或获取字体信息
function uo_xl_font CreateFont() system library "pbidea.dll" alias for "xlfontCreateFont"
function uo_xl_font CreateFont(uo_xl_font font) system library "pbidea.dll" alias for "xlfontCreateFont"
function int GetFontCount() system library "pbidea.dll" alias for "xlworkbookgetFontCount"
function uo_xl_font GetFont(int index) system library "pbidea.dll" alias for "xlfontGetFont"

//添加或获取格式信息
function uo_xl_format CreateFormat() system library "pbidea.dll" alias for "xlformatCreateFormat"
function uo_xl_format CreateFormat(uo_xl_format fmt) system library "pbidea.dll" alias for "xlformatCreateFormat"
function int GetFormatCount() system library "pbidea.dll" alias for "xlworkbookgetFormatCount"
function uo_xl_format GetFormat(int index) system library "pbidea.dll" alias for "xlformatGetFormat"

//图片
function long GetPictureCount() system library "pbidea.dll" alias for "xlbookGetPictureCount"
//根据索取图片
function blob GetPicture(long index) system library "pbidea.dll" alias for "xlbookGetPicture"
//添加图片
function long SetPicture(string file) system library "pbidea.dll" alias for "xlbookSetPicture"
function long SetPicture(blob raw_pic) system library "pbidea.dll" alias for "xlbookSetPicture"

//获取错误信息
function string GetErrorMessage() system library "pbidea.dll" alias for "xlbookGetErrorMessage"

//自定义数字、日期类型格式, 具体参考 https://www.libxl.com/custom-format.html
function int defineNumFormat(readonly string numFormat) system library "pbidea.dll" alias for "xlbookDefineNumFormat"

//调用系统功能操作文件, operator: edit, explore, find, open, print, runas, default: open
function boolean Run(readonly string file) system library "pbidea.dll" alias for "xlbookRun"
function boolean Run(readonly string file, readonly string operator) system library "pbidea.dll" alias for "xlbookRun"

//生成 html 文件
function boolean Sheet2Html(int sheet, readonly string htmlFile) system library "pbidea.dll" alias for "xlbookSheet2Html"
function string Sheet2Html(int sheet) system library "pbidea.dll" alias for "xlbookSheet2Html2" 

private:
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_cell" id="uo_xl_cell">uo_xl_cell</a></div>
<pre><code>
//cell

//属性性
INDIRECT integer  celltype          {NoSet(*value),         GetType()}
INDIRECT string   text              {SetText(*value),       GetText()}
INDIRECT double   num               {SetNum(*value),        GetNum()}
INDIRECT boolean  bool              {SetBool(*value),       GetBool()}
INDIRECT boolean  blank             {SetBlank(*value),      GetBlank()}
INDIRECT integer  width             {NoSet(*value),         GetWidth()}
INDIRECT integer  widthPX           {NoSet(*value),         GetWidthPX()}
INDIRECT integer  height            {NoSet(*value),         GetHeight()}
INDIRECT integer  heightPX          {NoSet(*value),         GetHeightPX()}
INDIRECT integer  widthEx           {NoSet(*value),         GetWidthEx()}
INDIRECT integer  widthExPX         {NoSet(*value),         GetWidthExPX()}
INDIRECT integer  heightEx          {NoSet(*value),         GetHeightEx()}
INDIRECT integer  heightExPX        {NoSet(*value),         GetHeightExPX()}
INDIRECT long     row               {SetRow(*value),        GetRow()}
INDIRECT long     col               {SetCol(*value),        GetCol()}
INDIRECT string   formula           {WriteFormula(*value),  ReadFormula()}
INDIRECT string   comment           {WriteComment(*value),  ReadComment()}
INDIRECT uo_xl_format   format      {SetFormat(*value),     GetFormat()}

//type
function int GetType() system library "pbidea.dll" alias for "xlcelltype"
//get
function boolean Get(ref string value) system library "pbidea.dll" alias for "xlcellGet"
//text
function string GetText() system library "pbidea.dll" alias for "xlcellreadStr"
subroutine SetText(readonly string str) system library "pbidea.dll" alias for "xlcellwriteStr"
//num
function double GetNum() system library "pbidea.dll" alias for "xlcellreadNum"
subroutine SetNum(double value) system library "pbidea.dll" alias for "xlcellwriteNum"
//bool
function boolean GetBool() system library "pbidea.dll" alias for "xlcellreadBool"
subroutine SetBool(boolean value) system library "pbidea.dll" alias for "xlcellwriteBool"
//blank
function boolean GetBlank() system library "pbidea.dll" alias for "xlcellreadBlank"
subroutine SetBlank(boolean value) system library "pbidea.dll" alias for "xlcellwriteBlank"
//error
function int GetError() system library "pbidea.dll" alias for "xlcellreadError"
subroutine SetError(int value) system library "pbidea.dll" alias for "xlcellwriteError"

//宽高
function int GetWidth() system library "pbidea.dll" alias for "xlcellwidth"
function int GetWidthPX() system library "pbidea.dll" alias for "xlcellwidthPX"
function int GetHeight() system library "pbidea.dll" alias for "xlcellheight"
function int GetHeightPX() system library "pbidea.dll" alias for "xlcellheightPX"

function int GetWidthEx() system library "pbidea.dll" alias for "xlcellwidthEx"
function int GetWidthExPX() system library "pbidea.dll" alias for "xlcellwidthExPX"
function int GetHeightEx() system library "pbidea.dll" alias for "xlcellheightEx"
function int GetHeightExPX() system library "pbidea.dll" alias for "xlcellheightExPX"

//位置
function long GetRow() system library "pbidea.dll" alias for "xlcellrow"
function long GetCol() system library "pbidea.dll" alias for "xlcellcol"
subroutine SetRow(long _row) system library "pbidea.dll" alias for "xlcellsetRow"
subroutine SetCol(long _col) system library "pbidea.dll" alias for "xlcellsetCol"

//公式
function boolean isFormula() system library "pbidea.dll" alias for "xlcellisFormula"
function string  ReadFormula() system library "pbidea.dll" alias for "xlcellreadFormula"
subroutine       WriteFormula(readonly string value) system library "pbidea.dll" alias for "xlcellwriteFormula"

//comment
function string  ReadComment() system library "pbidea.dll" alias for "xlcellreadComment"
subroutine       WriteComment(readonly string value) system library "pbidea.dll" alias for "xlcellwriteComment"
subroutine       WriteComment(readonly string value, readonly string author, int w, int h) system library "pbidea.dll" alias for "xlcellwriteComment"
subroutine       RemoveComment() system library "pbidea.dll" alias for "xlcellremoveComment"

//format
function uo_xl_format  GetFormat() system library "pbidea.dll" alias for "xlcellcellFormat"
subroutine       SetFormat(uo_xl_format fmt) system library "pbidea.dll" alias for "xlcellsetCellFormat"
// is date
function boolean isDate() system library "pbidea.dll" alias for "xlcellisDate"
//is rich string
function boolean isRichStr() system library "pbidea.dll" alias for "xlcellisRichStr"

//merge
function boolean GetMerge(ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast) system library "pbidea.dll" alias for "xlcellgetMerge"
function boolean SetMerge(long rowFirst, long rowLast, long colFirst, long colLast) system library "pbidea.dll" alias for "xlcellgetMerge"
function boolean DelMerge() system library "pbidea.dll" alias for "xlcelldelMerge"

//picture
subroutine       SetPicture(int picID) system library "pbidea.dll" alias for "xlcellsetPicture"
subroutine       SetPicture(int picID, double scale, int offsetX, int offsetY) system library "pbidea.dll" alias for "xlcellsetPicture"
subroutine       SetPicture2(int picID) system library "pbidea.dll" alias for "xlcellsetPicture2"
subroutine       SetPicture2(int picID, int w, int h, int offsetX, int offsetY) system library "pbidea.dll" alias for "xlcellsetPicture2"
function boolean removePicture() system library "pbidea.dll" alias for "xlcellremovePicture"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_font" id="uo_xl_font">uo_xl_font</a></div>
<pre><code>
//font

//定义访问属性
//propertys
//string  fontname   = "SimSun"
INDIRECT string   name              {SetName(*value),       GetName()}
INDIRECT integer  size              {SetSize(*value),       GetSize()}
INDIRECT boolean  italic            {SetItalic(*value),     GetItalic()}
INDIRECT boolean  bold              {SetBold(*value),       GetBold()}
INDIRECT boolean  strikeout         {SetStrikeOut(*value),  GetStrikeOut()}
INDIRECT ulong    color             {SetColor(*value),      GetColor()}
INDIRECT integer  underline         {SetUnderline(*value),  GetUnderline()}

private:
subroutine Init() system library "pbidea.dll" alias for "xlfontInit"

//name
subroutine SetName(readonly string value) system library "pbidea.dll" alias for "xlfontsetName"
function string GetName() system library "pbidea.dll" alias for "xlfontname"
//size
subroutine SetSize(int value) system library "pbidea.dll" alias for "xlfontsetSize"
function int GetSize() system library "pbidea.dll" alias for "xlfontsize"

subroutine SetItalic(boolean value) system library "pbidea.dll" alias for "xlfontsetItalic"
function boolean GetItalic() system library "pbidea.dll" alias for "xlfontitalic"

subroutine SetBold(boolean value) system library "pbidea.dll" alias for "xlfontsetBold"
function boolean GetBold() system library "pbidea.dll" alias for "xlfontbold"

subroutine SetStrikeOut(boolean value) system library "pbidea.dll" alias for "xlfontsetStrikeOut"
function boolean GetStrikeOut() system library "pbidea.dll" alias for "xlfontstrikeOut"

subroutine SetColor(ulong value) system library "pbidea.dll" alias for "xlfontsetColor"
function ulong GetColor() system library "pbidea.dll" alias for "xlfontcolor"

subroutine SetUnderline(int value) system library "pbidea.dll" alias for "xlfontsetUnderline"
function int GetUnderline() system library "pbidea.dll" alias for "xlfontunderline"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_format" id="uo_xl_format">uo_xl_format</a></div>
<pre><code>
//format

//propertys
INDIRECT uo_xl_font   font              {SetFont(*value),         GetFont()}
INDIRECT integer      numFormat         {SetNumFormat(*value),    GetNumFormat()}
INDIRECT integer      alignH            {SetAlignH(*value),       GetAlignH()}
INDIRECT integer      alignV            {SetAlignV(*value),       GetAlignV()}
INDIRECT boolean      wrap              {SetWrap(*value),         GetWrap()}
INDIRECT integer      rotation          {SetRotation(*value),     GetRotation()} // 0 - 90	Text rotated counterclockwise 0 to 90 degrees
                                                                               // 91 - 180	Text rotated clockwise 1 to 90 degrees
                                                                               // 255	Vertical text
INDIRECT integer      indent            {SetIndent(*value),       GetIndent()}
INDIRECT boolean      shrinkToFit       {SetShrinkToFit(*value),  GetShrinkToFit()}
INDIRECT integer      border            {SetBorder(*value),       GetBorderLeft()}
INDIRECT ulong        borderColor       {SetBorderColor(*value),  GetBorderLeftColor()}
INDIRECT integer      borderLeft        {SetBorderLeft(*value),    GetBorderLeft()}
INDIRECT ulong        borderLeftColor   {SetBorderLeftColor(*value), GetBorderLeftColor()}
INDIRECT integer      borderRight       {SetBorderRight(*value),  GetBorderRight()}
INDIRECT ulong        borderRightColor  {SetBorderRightColor(*value),  GetBorderRightColor()}
INDIRECT integer      borderTop         {SetBorderTop(*value),    GetBorderTop()}
INDIRECT ulong        borderTopColor    {SetBorderTopColor(*value),  GetBorderTopColor()}
INDIRECT integer      borderBottom      {SetBorderBottom(*value),    GetBorderBottom()}
INDIRECT ulong        borderBottomColor {SetBorderBottomColor(*value),  GetBorderBottomColor()}
INDIRECT integer      borderDiagonal    {SetBorderDiagonal(*value),     GetBorderDiagonal()}
INDIRECT integer      borderDiagonalStyle {SetBorderDiagonalStyle(*value),  GetBorderDiagonalStyle()}
INDIRECT ulong        borderDiagonalColor {SetBorderDiagonalColor(*value),  GetBorderDiagonalColor()}
INDIRECT integer      fillPattern         {SetFillPattern(*value),  GetFillPattern()}
INDIRECT ulong        patternForegroundColor {SetPatternForegroundColor(*value),  GetPatternForegroundColor()}
INDIRECT ulong        patternBackgroundColor {SetPatternBackgroundColor(*value),  GetPatternBackgroundColor()}
INDIRECT boolean      locked            {SetLocked(*value),  GetLocked()}
INDIRECT boolean      hidden            {SetHidden(*value),  GetHidden()}

string         customNumFormat = "" //参考 https://www.libxl.com/custom-format.html

private:

//subroutine Init() system library "pbidea.dll" alias for "xlformatInit"

//添加或获取字体信息
subroutine SetFont(uo_xl_font fnt) system library "pbidea.dll" alias for "xlformatSetFont"
function uo_xl_font GetFont() system library "pbidea.dll" alias for "xlformatGetFont"
function uo_xl_font CreateFont() system library "pbidea.dll" alias for "xlfontCreateFont"

subroutine SetNumFormat(int value) system library "pbidea.dll" alias for "xlformatsetNumFormat"
function int GetNumFormat() system library "pbidea.dll" alias for "xlformatnumFormat"

subroutine SetAlignH(int value) system library "pbidea.dll" alias for "xlformatsetAlignH"
function int GetAlignH() system library "pbidea.dll" alias for "xlformatalignH"

subroutine SetAlignV(int value) system library "pbidea.dll" alias for "xlformatsetAlignV"
function int GetAlignV() system library "pbidea.dll" alias for "xlformatalignV"

function boolean GetWrap() system library "pbidea.dll" alias for "xlformatwrap"
subroutine SetWrap(boolean value) system library "pbidea.dll" alias for "xlformatsetWrap"

function int GetRotation() system library "pbidea.dll" alias for "xlformatrotation"
subroutine SetRotation(int value) system library "pbidea.dll" alias for "xlformatsetRotation"

function int GetIndent() system library "pbidea.dll" alias for "xlformatindent"
subroutine SetIndent(int value) system library "pbidea.dll" alias for "xlformatsetIndent"

function int GetShrinkToFit() system library "pbidea.dll" alias for "xlformatshrinkToFit"
subroutine SetShrinkToFit(int value) system library "pbidea.dll" alias for "xlformatsetShrinkToFit"

subroutine SetBorder(int value) system library "pbidea.dll" alias for "xlformatsetBorder"
subroutine SetBorderColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderColor"

function int GetBorderLeft() system library "pbidea.dll" alias for "xlformatborderLeft"
subroutine SetBorderLeft(int value) system library "pbidea.dll" alias for "xlformatsetBorderLeft"

function int GetBorderRight() system library "pbidea.dll" alias for "xlformatborderRight"
subroutine SetBorderRight(int value) system library "pbidea.dll" alias for "xlformatsetBorderRight"

function int GetBorderTop() system library "pbidea.dll" alias for "xlformatborderTop"
subroutine SetBorderTop(int value) system library "pbidea.dll" alias for "xlformatsetBorderTop"

function int GetBorderBottom() system library "pbidea.dll" alias for "xlformatborderBottom"
subroutine SetBorderBottom(int value) system library "pbidea.dll" alias for "xlformatsetBorderBottom"

function ulong GetBorderLeftColor() system library "pbidea.dll" alias for "xlformatborderLeftColor"
subroutine SetBorderLeftColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderLeftColor"

function ulong GetBorderRightColor() system library "pbidea.dll" alias for "xlformatborderRightColor"
subroutine SetBorderRightColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderRightColor"

function ulong GetBorderTopColor() system library "pbidea.dll" alias for "xlformatborderTopColor"
subroutine SetBorderTopColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderTopColor"

function ulong GetBorderBottomColor() system library "pbidea.dll" alias for "xlformatborderBottomColor"
subroutine SetBorderBottomColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderBottomColor"

function integer GetBorderDiagonal() system library "pbidea.dll" alias for "xlformatborderDiagonal"
subroutine SetBorderDiagonal(integer value) system library "pbidea.dll" alias for "xlformatsetBorderDiagonal"

function integer GetBorderDiagonalStyle() system library "pbidea.dll" alias for "xlformatborderDiagonalStyle"
subroutine SetBorderDiagonalStyle(integer value) system library "pbidea.dll" alias for "xlformatsetBorderDiagonalStyle"

function ulong GetBorderDiagonalColor() system library "pbidea.dll" alias for "xlformatborderDiagonalColor"
subroutine SetBorderDiagonalColor(ulong value) system library "pbidea.dll" alias for "xlformatsetBorderDiagonalColor"

function int GetFillPattern() system library "pbidea.dll" alias for "xlformatfillPattern"
subroutine SetFillPattern(int value) system library "pbidea.dll" alias for "xlformatsetFillPattern"

function ulong GetPatternForegroundColor() system library "pbidea.dll" alias for "xlformatpatternForegroundColor"
subroutine SetPatternForegroundColor(ulong value) system library "pbidea.dll" alias for "xlformatsetPatternForegroundColor"

function ulong GetPatternBackgroundColor() system library "pbidea.dll" alias for "xlformatpatternBackgroundColor"
subroutine SetPatternBackgroundColor(ulong value) system library "pbidea.dll" alias for "xlformatsetPatternBackgroundColor"

function boolean GetLocked() system library "pbidea.dll" alias for "xlformatlocked"
subroutine SetLocked(boolean value) system library "pbidea.dll" alias for "xlformatsetLocked"

function boolean GetHidden() system library "pbidea.dll" alias for "xlformathidden"
subroutine SetHidden(boolean value) system library "pbidea.dll" alias for "xlformatsetHidden"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xl_sheet" id="uo_xl_sheet">uo_xl_sheet</a></div>
<pre><code>
INDIRECT string   name                 {SeName(*value),         GetName()}
INDIRECT integer  FontCount            {NoSet(*value),           GetFontCount()}
INDIRECT integer  FormatCount          {NoSet(*value),           GetFormatCount()}
INDIRECT integer  PictureCount         {NoSet(*value),           GetPictureCount()}
INDIRECT integer  DefaultRowHeight     {SetDefaultRowHeight(*value), DefaultRowHeight()}
INDIRECT integer  mergeCont            {NoSet(*value),           GetMergeSize()}
INDIRECT boolean  displayGridLines     {setDisplayGridlines(*value), displayGridlines()}
INDIRECT boolean  printGridLines       {setPrintGridlines(*value), printGridlines()}

public:

function string GetName() system library "pbidea.dll" alias for "xlworksheetname"
subroutine SetName(readonly string strName) system library "pbidea.dll" alias for "xlworksheetsetName"

//添加或获取字体信息
function uo_xl_font CreateFont() system library "pbidea.dll" alias for "xlfontCreateFont"
function uo_xl_font CreateFont(uo_xl_font font) system library "pbidea.dll" alias for "xlfontCreateFont"
function int GetFontCount() system library "pbidea.dll" alias for "xlworksheetgetFontCount"
function uo_xl_font GetFont(int index) system library "pbidea.dll" alias for "xlfontGetFont"

//添加或获取格式信息
function uo_xl_format CreateFormat() system library "pbidea.dll" alias for "xlformatCreateFormat"
function uo_xl_format CreateFormat(uo_xl_format fmt) system library "pbidea.dll" alias for "xlformatCreateFormat"
function int GetFormatCount() system library "pbidea.dll" alias for "xlworksheetgetFormatCount"
function uo_xl_format GetFormat(int index) system library "pbidea.dll" alias for "xlformatGetFormat"

//获取错误信息
function string GetErrorMessage() system library "pbidea.dll" alias for "xlbookGetErrorMessage"

//自定义数字、日期类型格式, 具体参考 https://www.libxl.com/custom-format.html
function int defineNumFormat(readonly string numFormat) system library "pbidea.dll" alias for "xlbookDefineNumFormat"

//取单元格
function uo_xl_cell GetCell(long r, long c) system library "pbidea.dll" alias for "xlsheetGetCell"
function uo_xl_cell GetActiveCell() system library "pbidea.dll" alias for "xlsheetGetActiveCell"
subroutine SetActiveCell(long r, long c) system library "pbidea.dll" alias for "xlsheetSetActiveCell"

//行 列大小
function int  ColWidth(long col) system library "pbidea.dll" alias for "xlsheetColWidth"
function int  ColWidthPX(long col) system library "pbidea.dll" alias for "xlsheetColWidthPX"
function int  RowHeight(long row) system library "pbidea.dll" alias for "xlsheetRowHeight"
function int  RowHeightPX(long row) system library "pbidea.dll" alias for "xlsheetRowHeightPX"

//列宽，格式，隐藏
function boolean SetCol(long col, double width) system library "pbidea.dll" alias for "xlsheetSetCol"
function boolean SetCol(long col, double width, uo_xl_format fmt) system library "pbidea.dll" alias for "xlsheetSetCol"
function boolean SetCol(long col, double width, uo_xl_format fmt, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetCol"
function boolean SetColPX(long col, double width) system library "pbidea.dll" alias for "xlsheetSetColPX"
function boolean SetColPX(long col, double width, uo_xl_format fmt) system library "pbidea.dll" alias for "xlsheetSetColPX"
function boolean SetColPX(long col, double width, uo_xl_format fmt, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetColPX"

//行高，格式，隐藏
function boolean SetRow(long row, double height) system library "pbidea.dll" alias for "xlsheetSetRow"
function boolean SetRow(long row, double height, uo_xl_format fmt) system library "pbidea.dll" alias for "xlsheetSetRow"
function boolean SetRow(long row, double height, uo_xl_format fmt, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetRow"
function boolean SetRowPX(long row, double height) system library "pbidea.dll" alias for "xlsheetSetRowPX"
function boolean SetRowPX(long row, double height, uo_xl_format fmt) system library "pbidea.dll" alias for "xlsheetSetRowPX"
function boolean SetRowPX(long row, double height, uo_xl_format fmt, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetRowPX"

//隐藏
function boolean RowHidden(long row) system library "pbidea.dll" alias for "xlsheetRowHidden"
function boolean SetRowHidden(long row, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetRowHidden"
function boolean ColHidden(long col) system library "pbidea.dll" alias for "xlsheetColHidden"
function boolean SetColHidden(long col, boolean hidden) system library "pbidea.dll" alias for "xlsheetSetColHidden"

//default row height
function int  DefaultRowHeight() system library "pbidea.dll" alias for "xlworksheetDefaultRowHeight"
subroutine  SetDefaultRowHeight(int height) system library "pbidea.dll" alias for "xlworksheetSetDefaultRowHeight"

//merge
function int  GetMergeSize() system library "pbidea.dll" alias for "xlworksheetmergeSize"
function boolean GetMerage(int index, ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast) system library "pbidea.dll" alias for "xlsheetGetMerge"
function boolean DelMerage(int index) system library "pbidea.dll" alias for "xlsheetDelMerge"

//picture
//添加图片
function long AddPicture(string file) system library "pbidea.dll" alias for "xlbookSetPicture"
function long AddPicture(blob raw_pic) system library "pbidea.dll" alias for "xlbookSetPicture"
function int  GetPictureSize() system library "pbidea.dll" alias for "xlworksheetpictureSize"
function boolean  GetPicture(long index, ref long rowTop, ref long colLeft, ref long rowBottom, ref long colRight, ref long width, ref long height, ref long offsetX, ref long offsetY, ref string linkPath) system library "pbidea.dll" alias for "xlsheetGetPicture"
function boolean  RemovePicture(long index) system library "pbidea.dll" alias for "xlsheetRemovePicture"

//page break
function int  GetHorPageBreakSize() system library "pbidea.dll" alias for "xlworksheetgetHorPageBreakSize"
function int  GetHorPageBreak() system library "pbidea.dll" alias for "xlsheetGetHorPageBreak"
function int  GetVerPageBreakSize() system library "pbidea.dll" alias for "xlworksheetgetVerPageBreakSize"
function int  GetVerPageBreak() system library "pbidea.dll" alias for "xlsheetGetVerPageBreak"

subroutine  Clear() system library "pbidea.dll" alias for "xlsheetClear"

//insert remove col/row
function boolean  InsertCol(long c) system library "pbidea.dll" alias for "xlsheetInsertCol"
function boolean  InsertCol(long c, long count) system library "pbidea.dll" alias for "xlsheetInsertCol"
function boolean  InsertRow(long r) system library "pbidea.dll" alias for "xlsheetInsertRow"
function boolean  InsertRow(long r, long count) system library "pbidea.dll" alias for "xlsheetInsertRow"
function boolean  RemoveCol(long c) system library "pbidea.dll" alias for "xlsheetRemoveCol"
function boolean  RemoveRow(long r) system library "pbidea.dll" alias for "xlsheetRemoveRow"

//copy
function boolean  CopyCell(long srcRow, long srcCol, long dstRow, long dstCol) system library "pbidea.dll" alias for "xlsheetCopyCell"

//
function long FirstRow() system library "pbidea.dll" alias for "xlsheetFirstRow"
function long LastRow() system library "pbidea.dll" alias for "xlsheetLastRow"
function long FirstCol() system library "pbidea.dll" alias for "xlsheetFirstCol"
function long LastCol() system library "pbidea.dll" alias for "xlsheetLastCol"

function long FirstFilledRow() system library "pbidea.dll" alias for "xlsheetFirstFilledRow"
function long LastFilledRow() system library "pbidea.dll" alias for "xlsheetLastFilledRow"
function long FirstFilledCol() system library "pbidea.dll" alias for "xlsheetFirstFilledCol"
function long LastFilledCol() system library "pbidea.dll" alias for "xlsheetLastFilledCol"

//grid
function boolean displayGridlines() system library "pbidea.dll" alias for "xlworksheetdisplayGridlines"
subroutine setDisplayGridlines(boolean display) system library "pbidea.dll" alias for "xlworksheetsetDisplayGridlines"
function boolean printGridlines() system library "pbidea.dll" alias for "xlworksheetprintGridlines"
subroutine setPrintGridlines(boolean display) system library "pbidea.dll" alias for "xlworksheetsetPrintGridlines"

//zoom
function int zoom() system library "pbidea.dll" alias for "xlworksheetzoom"
subroutine setZoom(int zoom) system library "pbidea.dll" alias for "xlworksheetsetZoom"
function int printZoom() system library "pbidea.dll" alias for "xlworksheetprintZoom"
subroutine setPrintZoom(int zoom) system library "pbidea.dll" alias for "xlworksheetsetPrintZoom"

//paper and print
function boolean landscape() system library "pbidea.dll" alias for "xlworksheetlandscape"
subroutine setLandscape(boolean v) system library "pbidea.dll" alias for "xlworksheetsetLandscape"
function int paper() system library "pbidea.dll" alias for "xlworksheetpaper"
subroutine setPaper(int paper) system library "pbidea.dll" alias for "xlworksheetsetPaper"

function boolean GetPrintFit(ref int wPaper, ref int hPaper) system library "pbidea.dll" alias for "xlsheetGetPrintFit"
subroutine SetPrintFit(int wPaper, int hPaper) system library "pbidea.dll" alias for "xlsheetSetPrintFit"

//头部和脚部边距
function boolean GetHeader(ref string header, ref double margin) system library "pbidea.dll" alias for "xlsheetGetHeader"
function boolean SetHeader(readonly string header, double margin) system library "pbidea.dll" alias for "xlsheetSetHeader"
function boolean GetFooter(ref string footer, ref double margin) system library "pbidea.dll" alias for "xlsheetGetFooter"
function boolean SetFooter(readonly string footer, double margin) system library "pbidea.dll" alias for "xlsheetSetFooter"

//横向或垂直居中
function boolean hCenter() system library "pbidea.dll" alias for "xlworksheethCenter"
subroutine setHCenter(boolean v) system library "pbidea.dll" alias for "xlworksheetsetHCenter"
function boolean vCenter() system library "pbidea.dll" alias for "xlworksheetvCenter"
subroutine setVCenter(boolean v) system library "pbidea.dll" alias for "xlworksheetsetVCenter"

//边距
function double MarginLeft() system library "pbidea.dll" alias for "xlsheetMarginLeft"
subroutine SetMarginLeft(boolean v) system library "pbidea.dll" alias for "xlsheetSetMarginLeft"
function double MarginTop() system library "pbidea.dll" alias for "xlsheetMarginTop"
subroutine SetMarginTop(boolean v) system library "pbidea.dll" alias for "xlsheetSetMarginTop"
function double MarginRight() system library "pbidea.dll" alias for "xlsheetMarginRight"
subroutine SetMarginRight(boolean v) system library "pbidea.dll" alias for "xlsheetSetMarginRight"
function double MarginBottom() system library "pbidea.dll" alias for "xlsheetMarginBottom"
subroutine SetMarginBottom(boolean v) system library "pbidea.dll" alias for "xlsheetSetMarginBottom"

//whether the row and column headers are printed.
function boolean PrintRowCol() system library "pbidea.dll" alias for "xlworksheetprintRowCol"
subroutine setPrintRowCol(boolean v) system library "pbidea.dll" alias for "xlworksheetsetPrintRowCol"

//repeated rows/cols on each page
function boolean PrintRepeatRows(ref long firstRow, ref long lastRow) system library "pbidea.dll" alias for "xlsheetPrintRepeatRows"
subroutine SetPrintRepeatRows(long firstRow, long lastRow) system library "pbidea.dll" alias for "xlsheetSetPrintRepeatRows"
function boolean PrintRepeatCols(ref long firstCol, ref long lastCol) system library "pbidea.dll" alias for "xlsheetPrintRepeatCols"
subroutine SetPrintRepeatCols(long firstCol, long lastCol) system library "pbidea.dll" alias for "xlsheetSetPrintRepeatCols"

//print area
function boolean PrintArea(ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast) system library "pbidea.dll" alias for "xlsheetPrintArea"
subroutine SetPrintArea(long rowFirst, long rowLast, long colFirst, long colLast) system library "pbidea.dll" alias for "xlsheetSetPrintArea"
subroutine clearPrintRepeats() system library "pbidea.dll" alias for "xlworksheetclearPrintRepeats"

//named range
function boolean GetNamedRange(readonly string rangeName, ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast) system library "pbidea.dll" alias for "xlsheetGetNamedRange"
function boolean SetNamedRange(readonly string rangeName, long rowFirst, long rowLast, long colFirst, long colLast) system library "pbidea.dll" alias for "xlsheetSetNamedRange"
function boolean DelNamedRange(readonly string rangeName) system library "pbidea.dll" alias for "xlsheetdelNamedRange"
function int NamedRangeSize() system library "pbidea.dll" alias for "xlworksheetnamedRangeSize"
function string NamedRange(int index, ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast) system library "pbidea.dll" alias for "xlsheetNamedRange"

//table
function long tableSize() system library "pbidea.dll" alias for "xlworksheettableSize"
function string table(int index, ref long rowFirst, ref long rowLast, ref long colFirst, ref long colLast, ref long headerCount, ref long totalRowCount) system library "pbidea.dll" alias for "xlsheetTable"

//protect
function boolean protect() system library "pbidea.dll" alias for "xlworksheetprotect"
subroutine SetProtect(boolean protect, readonly string passwd) system library "pbidea.dll" alias for "xlsheetSetProtect"

//auto fit
subroutine SetAutoFitArea() system library "pbidea.dll" alias for "xlsheetSetAutoFitArea"
subroutine SetAutoFitArea(long rowFirst, long colFirst, long rowLast, long colLast) system library "pbidea.dll" alias for "xlsheetSetAutoFitArea"

//addr <-> RowCol
subroutine AddrToRowCol(readonly string addr, ref long row, ref long col, ref boolean rowRelative, ref boolean colRelative) system library "pbidea.dll" alias for "xlsheetAddrToRowCol"
function string RowColToAddr(long row, long col) system library "pbidea.dll" alias for "xlsheetRowColToAddr"
function string RowColToAddr(long row, long col, boolean rowRelative, boolean colRelative) system library "pbidea.dll" alias for "xlsheetRowColToAddr"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xls" id="uo_xls">uo_xls</a></div>
<pre><code>
//xls

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xlsx" id="uo_xlsx">uo_xlsx</a></div>
<pre><code>
//xlsx

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xml" id="uo_xml">uo_xml</a></div>
<pre><code>
//xml

//强烈建议学习 XPath ,https://www.w3schools.com/xml/xpath_intro.asp
//取子节点方法
constant int NODE_FIRST  = 1  //第一个子节点
constant int NODE_LAST  =  2  //最后一个子节点
constant int NODE_NEXT   = 3  //下一个兄弟
constant int NODE_PREV   = 4  //上一个兄弟

//节点类别
constant int node_null             = 0
constant int node_document         = 1
constant int node_element          = 2
constant int node_pcdata           = 3
constant int node_cdata            = 4
constant int node_comment          = 5
constant int node_pi               = 6
constant int node_declaration      = 7
constant int node_doctype          = 8

private:
function ulong xmlCreate() system library "PbIdea.dll" alias for "xmlCreate"
subroutine xmlDestroy() system library "PbIdea.dll" alias for "xmlDestroy"
public:
//解析XML文件
function boolean ParseFile(readonly string xmlFile) system library "PbIdea.dll" alias for "xmlParseFileEx"
//解析XML字符串
function boolean Parse(readonly string xml) system library "PbIdea.dll" alias for "xmlParse"
function boolean Parse(readonly blob xml) system library "PbIdea.dll" alias for "xmlParse"
//取得节点：第一个，下一个，上一个
function uo_xml_node GetNode(int nodeType) system library "PbIdea.dll" alias for "xmlGetNode"
//根据名称取得子节点，支持 xpath 路径方式
function uo_xml_node GetNode(readonly string nodeName) system library "PbIdea.dll" alias for "xmlGetNode"
//取得子节点数组，返回个数
function long GetNode(ref uo_xml_node nodeArray[]) system library "PbIdea.dll" alias for "xmlGetNodeArray"
function long GetNode(ref ulong nodeArray[]) system library "PbIdea.dll" alias for "xmlGetNodeArray"
//不分层次，取出所有节点列表
function long GetAllNodes(ref ulong nodeArray[]) system library "PbIdea.dll" alias for "xmlGetAllNodes"
//导入Datawindow
function long dwImport(readonly datawindow dw) system library "PbIdea.dll" alias for "xmldwImport"

function string ToString() system library "PbIdea.dll" alias for "xmlToString"
function string ToString(boolean crlf) system library "PbIdea.dll" alias for "xmlToString"
function string ToString(boolean crlf, boolean withHeader) system library "PbIdea.dll" alias for "xmlToString"

function boolean Save(readonly string xmlFile) system library "PbIdea.dll" alias for "xmlSave"
function boolean IsEmpty() system library "PbIdea.dll" alias for "xmlIsEmpty"
subroutine Clear() system library "PbIdea.dll" alias for "xmlClear"

//首先移除属性，移除属性失败的情况下，会移除节点
function boolean Remove(readonly string strName) system library "PbIdea.dll" alias for "xmlRemove"
function boolean Remove(readonly uo_xml_node node) system library "PbIdea.dll" alias for "xmlRemove"
function boolean Remove(readonly uo_xml_attribute attr) system library "PbIdea.dll" alias for "xmlRemove"

//添加节点
function uo_xml_node AddNode(readonly string nodeName) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly int nodeType) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly string nodeName,readonly int nodeType) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly uo_xml_node node) system library "PbIdea.dll" alias for "xmlAddNode"

//添加属性
function uo_xml_attribute AddAttribute(readonly string attrName) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly string value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly longlong value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly long value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly ulong value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly int value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly double value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly boolean value) system library "PbIdea.dll" alias for "xmlAddAttribute"

//json 转 xml
function boolean FromJson(uo_json json) system library "PbIdea.dll" alias for "xmlFromJson"
function boolean FromJson(readonly string json) system library "PbIdea.dll" alias for "xmlFromJson"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xml_attribute" id="uo_xml_attribute">uo_xml_attribute</a></div>
<pre><code>
//xml attribute
//取属性方法 int AttributeType
constant int ATTR_FIRST  = 1  //第一个
constant int ATTR_NEXT   = 2  //下一个
constant int ATTR_PREV   = 3  //上一个
constant int ATTR_LAST   = 4  //最后一个

private:
subroutine xmlDestroy() system library "PbIdea.dll" alias for "xmlDestroy"
public:
//取名称和值
function boolean Get(ref string strName,ref string value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref longlong value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref long value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref ulong value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref int value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref double value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref boolean value) system library "PbIdea.dll" alias for "xmlGetNameValue"
//设置属性值
function boolean Set(readonly string name,readonly string value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly longlong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly long value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly ulong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly int value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly double value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly boolean value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly longlong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly long value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly ulong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly int value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly double value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly boolean value) system library "PbIdea.dll" alias for "xmlSetValue"
//是否有效
function boolean Isvalid() system library "PbIdea.dll" alias for "xmlIsvalidAttribute"
//取下一个属性或者上一个属性 ATTR_NEXT , ATTR_PREV
function uo_xml_attribute GetAttribute(int AttributeType) system library "PbIdea.dll" alias for "xmlGetAttribute"
//根据名称取下一个属性
function uo_xml_attribute GetAttribute(readonly string strName) system library "PbIdea.dll" alias for "xmlGetAttribute"
function boolean IsEmpty() system library "PbIdea.dll" alias for "xmlIsEmpty"
function boolean Attach(ulong attributeHandle) system library "PbIdea.dll" alias for "xmlAttachAttribute"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_xml_node" id="uo_xml_node">uo_xml_node</a></div>
<pre><code>
//xml node
//取子节点方法
constant int NODE_FIRST  = 1  //第一个子节点
constant int NODE_LAST  =  2  //最后一个子节点
constant int NODE_NEXT   = 3  //下一个兄弟
constant int NODE_PREV   = 4  //上一个兄弟

//取属性方法 int AttributeType
constant int ATTR_FIRST  = 1  //第一个
constant int ATTR_NEXT   = 2  //下一个
constant int ATTR_PREV   = 3  //上一个
constant int ATTR_LAST   = 4  //最后一个

//节点类别
constant int node_null             = 0
constant int node_document         = 1
constant int node_element          = 2
constant int node_pcdata           = 3
constant int node_cdata            = 4
constant int node_comment          = 5
constant int node_pi               = 6
constant int node_declaration      = 7
constant int node_doctype          = 8

private:
subroutine xmlDestroy() system library "PbIdea.dll" alias for "xmlDestroy"
public:
function string ToString() system library "PbIdea.dll" alias for "xmlToString"
function string ToString(boolean crlf) system library "PbIdea.dll" alias for "xmlToString"
function boolean Attach(ulong handleNode) system library "PbIdea.dll" alias for "xmlAttachNode"

//根据指定方式取得子节点：第一个，上一个，下一个
function uo_xml_node GetNode(int nodeType) system library "PbIdea.dll" alias for "xmlGetNode"
//根据名称取子节点名称，可以是 xpath 方式
function uo_xml_node GetNode(string nodeName) system library "PbIdea.dll" alias for "xmlGetNode"
//取得当前节点的XML内容
function string GetContent() system library "PbIdea.dll" alias for "xmlGetNodeContent"
function string GetContent(boolean crlf) system library "PbIdea.dll" alias for "xmlGetNodeContent"
//取得所有子节点，结果存入数组，返回子节点个数
function long GetNode(ref uo_xml_node nodeArray[]) system library "PbIdea.dll" alias for "xmlGetNodeArray"
function long GetNode(ref ulong nodeArray[]) system library "PbIdea.dll" alias for "xmlGetNodeArray"
//判断一个节点是不是有效
function boolean Isvalid() system library "PbIdea.dll" alias for "xmlIsvalidNode"
//取节点名称和值
function boolean Get(ref string strName,ref string value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref longlong value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref long value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref ulong value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref int value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref double value) system library "PbIdea.dll" alias for "xmlGetNameValue"
function boolean Get(ref string strName,ref boolean value) system library "PbIdea.dll" alias for "xmlGetNameValue"
//设置节点值
function boolean Set(readonly string name,readonly string value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly longlong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly long value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly ulong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly int value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly double value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string name,readonly boolean value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly string value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly longlong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly long value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly ulong value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly int value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly double value) system library "PbIdea.dll" alias for "xmlSetValue"
function boolean Set(readonly boolean value) system library "PbIdea.dll" alias for "xmlSetValue"

//取得节点类型，具体参见实例变量声明
function int GetType() system library "PbIdea.dll" alias for "xmlGetNodeType"

//取得节点的所有属性对象列表，返回属性个数
function long GetAttribute(ref uo_xml_attribute attributeArray[]) system library "PbIdea.dll" alias for "xmlGetAttributeArray"
function long GetAttribute(ref ulong attributeArray[]) system library "PbIdea.dll" alias for "xmlGetAttributeArray"
//取下一个属性或者上一个属性 ATTR_FIRST , ATTR_LAST
function uo_xml_attribute GetAttribute(int AttributeType) system library "PbIdea.dll" alias for "xmlGetAttribute"
//根据名称取属性
function uo_xml_attribute GetAttribute(readonly string strName) system library "PbIdea.dll" alias for "xmlGetAttribute"
function boolean IsEmpty() system library "PbIdea.dll" alias for "xmlIsEmpty"
//首先移除属性，移除属性失败的情况下，会移除节点
function boolean Remove(readonly string strName) system library "PbIdea.dll" alias for "xmlRemove"
function boolean Remove(readonly uo_xml_node node) system library "PbIdea.dll" alias for "xmlRemove"
function boolean Remove(readonly uo_xml_attribute attr) system library "PbIdea.dll" alias for "xmlRemove"

//添加节点
function uo_xml_node AddNode(readonly string nodeName) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly int nodeType) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly string nodeName,readonly int nodeType) system library "PbIdea.dll" alias for "xmlAddNode"
function uo_xml_node AddNode(readonly uo_xml_node node) system library "PbIdea.dll" alias for "xmlAddNode"

//添加属性
function uo_xml_attribute AddAttribute(readonly string attrName) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly string value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly longlong value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly long value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly ulong value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly int value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly double value) system library "PbIdea.dll" alias for "xmlAddAttribute"
function uo_xml_attribute AddAttribute(readonly string attrName,readonly boolean value) system library "PbIdea.dll" alias for "xmlAddAttribute"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_yibao" id="uo_yibao">uo_yibao</a></div>
<pre><code>
//医保专用接口

uo_httpclient hc

//设置医保选项
/*
// 0 甘肃医保（默认）
// 1 黑龙江医保 
// 2 吉林医保
// 3 江苏 
// 4 山西
// 5 黑龙江医保V2,即移动支付版
// 6 黑龙江工伤
SetYiBao_Option("type",0) 
*/
function boolean SetYiBao_Option(readonly string option,readonly string value) system library "PbIdea.dll" alias for "SetYiBao_Option"
function boolean SetYiBao_Option(readonly string option,long value) system library "PbIdea.dll" alias for "SetYiBao_Option"
/*
黑龙江、吉林国家医保（东软）
*/

/*
甘肃医保接口
//参数说明：
uo_json args               :提供接口的一些基础参数，例如http协议,IP 等
uo_json headers            :提供HTTP必须的 header
uo_json body               :要发送的业务JSON
uo_json result             :接口返回的JSON内容
readonly string fileName   :从HTTP返回的数据写入指定文件，这个文件有可能是二进制文件，例如zip或者其他格式，需要再处理.
ref blob data              :从HTTP返回的数据写入指定
readonly string uploadFile :有些接口需要上传文件或者数据，这里指定上传文件名称
readonly blob uploadData   :有些接口需要上传文件或者数据，这里指定上传blob数据
//返回值说明：
1.函数返回 boolean 类型，表明本次调用是否成功完成。当网络有故障，或者其他原因导致调用失败，会返回 false，否则返回true。但此返回不表示接口是否正确处理相应请求.
2.解析 result json ，获取 status 的值，如果是  200，表示接口处理成功。可百度“常见的HTTP状态码”，不同代码的意义，可以接口方联系获取相关信息。
*/  
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName,readonly string uploadFile) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName,readonly blob uploadData) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data,readonly string uploadFile) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  GanShuYiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data,readonly blob uploadData) system library "PbIdea.dll" alias for "GanShuYiBao_Request"

/*
医保接口
//参数说明：
uo_json args               :提供接口的一些基础参数，例如http协议,IP 等
uo_json headers            :提供HTTP必须的 header
uo_json body               :要发送的业务JSON
uo_json result             :接口返回的JSON内容
readonly string fileName   :从HTTP返回的数据写入指定文件，这个文件有可能是二进制文件，例如zip或者其他格式，需要再处理.
ref blob data              :从HTTP返回的数据写入指定blob，这个blob有可能是二进制文件，例如zip或者其他格式，需要再处理.
readonly string uploadFile :有些接口需要上传文件或者数据，这里指定上传文件名称
readonly blob uploadData   :有些接口需要上传文件或者数据，这里指定上传blob数据
//返回值说明：
1.函数返回 boolean 类型，表明本次调用是否成功完成。当网络有故障，或者其他原因导致调用失败，会返回 false，否则返回true。但此返回不表示接口是否正确处理相应请求.
2.解析 result json ，获取 status 的值，如果是  200，表示接口处理成功。可百度“常见的HTTP状态码”，不同代码的意义，可以接口方联系获取相关信息。
*/  
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName,readonly string uploadFile) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,readonly string fileName,readonly blob uploadData) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data,readonly string uploadFile) system library "PbIdea.dll" alias for "GanShuYiBao_Request"
function boolean  YiBao_Request(uo_json args,uo_json headers,uo_json body,uo_json result,ref blob data,readonly blob uploadData) system library "PbIdea.dll" alias for "GanShuYiBao_Request"

//SMx国密函数
function blob sm2sign(blob userID,blob priKey,blob pubKey, blob src) system library "PbIdea.dll" alias for "GM_sm2signEx"
function blob sm2sign(blob userID,blob priKey,blob pubKey, blob src,boolean asn1) system library "PbIdea.dll" alias for "GM_sm2signEx"
//method填"nowith"，不进行hash
function blob sm2sign(blob userID,blob priKey,blob pubKey, blob src,boolean asn1, readonly string method) system library "PbIdea.dll" alias for "GM_sm2signEx"
function boolean sm2verify(blob userID,blob pubKey, blob src,blob sign) system library "PbIdea.dll" alias for "GM_sm2verifyEx"
//method填"nowith"，不进行hash
function boolean sm2verify(readonly blob userID,readonly blob pubKey, readonly blob src,readonly blob sign, readonly string method) system library "PbIdea.dll" alias for "GM_sm2verifyEx"
function blob sm3(blob data) system library "PbIdea.dll" alias for "GM_sm3Ex"
function blob sm4(blob data, blob key, boolean decrypto) system library "PbIdea.dll" alias for "GM_sm4ecbEx"
function blob sm4(blob data, string key, boolean decrypto) system library "PbIdea.dll" alias for "GM_sm4ecbEx"
function blob GetPubKey(blob priKey) system library "PbIdea.dll" alias for "GM_sm2GetPubKey"
//根据BC私钥取公钥
function blob GetPubKey(string priKey) system library "PbIdea.dll" alias for "GM_sm2GetPubKey"
//从PEM格式密钥中取BC密钥
function boolean GM_sm2GetKey(string pemkey,ref string pri,ref string pub) system library "PbIdea.dll" alias for "GM_sm2GetKey"
function string GM_sm2PEM(string key) system library "PbIdea.dll" alias for "GM_sm2PEM"

//导入大文件,国家医保西药中成药那个压缩包,最大的那个
function long ImportYiBaoZip(string zipFileName,uo_json result) system library "PbIdea.dll" alias for "ImportYiBaoZip"
//function long ImportYiBaoZip(string zipFileName,uo_json result,uo_database db) system library "PbIdea.dll" alias for "ImportYiBaoZip"

/*
重庆医保,对 SiInterface_hsf.dll 封装,输入参数和输出参数均为json对象
使用方法:
uo_yibao yb; yb = create uo_yibao
uo_json input ,output; input = create uo_json;output = create uo_json
input.set(...) //一系列业务数据准备
yb.ChongQingRequest(input,output)
MessageBox("",output.toString(true,false,true))
*/
function boolean ChongQingRequest(uo_json input,uo_json output) system library "PbIdea.dll" alias for "ybChongQingRequest"

//调用YhBaseLine.dll 之 yh_baselinecall 函数
/*
string ls_in, ls_out
long ll_ret
uo_yibao yb; yb = create uo_yibao
ls_in = " ... " //初始输入值
ll_ret = yb.YhBaseLineCall(ls_in,ref ls_out)
destroy yb
*/
function long YhBaseLineCall(string input, ref string output) system library "PbIdea.dll" alias for "YhBaseLineCall"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_zip" id="uo_zip">uo_zip</a></div>
<pre><code>
//cn:zip压缩、解压缩
//en:zip compress/decompress

//标准函数
/*
function ulong ZipOpen(string lpFile, string lpPass, boolean bReadOnly) library "pbidea.dll" alias for "stdZipOpen"
subroutine ZipClose(ulong zip) library "pbidea.dll" alias for "stdZipClose"
function boolean ZipAddFile(ulong zip,string lpFile) library "pbidea.dll" alias for "stdZipAddFile"
function long ZipExtract(ulong zip,string lpDir) library "pbidea.dll" alias for "stdZipExtract"

ulong zip
zip = ZipOpen("d:/temp/file/my.zip", "", false)
ZipAddFile(zip,"d:/temp/file/大文件s.txt")
ZipClose(zip)

zip = ZipOpen("d:/temp/file/my.zip", "", true)
ZipExtract(zip,"d:/temp/file/extract")
ZipClose(zip)

*/

private:
function ulong zipCreate() system library "PbIdea.dll" alias for "zipCreate"
subroutine zipDestroy() system library "PbIdea.dll" alias for "zipDestroy"

public:
//zip
function boolean Open(readonly string strZipFile) system library "PbIdea.dll" alias for "zipOpen"
function boolean Open(readonly string strZipFile,boolean bReadOnly) system library "PbIdea.dll" alias for "zipOpen"
function boolean Open(readonly string strZipFile,boolean bReadOnly,readonly string strPassword) system library "PbIdea.dll" alias for "zipOpen"
function boolean Open(readonly blob zipBuffer,string strPassword) system library "PbIdea.dll" alias for "zipOpen" //只能只读方式
function boolean IsOpen() system library "PbIdea.dll" alias for "zipIsOpen"
subroutine Close() system library "PbIdea.dll" alias for "zipClose" //只有close 时，才提交所有操作，包括实际压缩生成文件 ,相当于 commit
subroutine Discard() system library "PbIdea.dll" alias for "zipDiscard" //放弃操作，相当于 rollback
subroutine DeleteFile() system library "PbIdea.dll" alias for "zipDelete"
subroutine SetComment(string comment) system library "PbIdea.dll" alias for "zipSetComment"
function string GetComment() system library "PbIdea.dll" alias for "zipGetComment"
function long AddPath(readonly string strPath) system library "PbIdea.dll" alias for "ZipAddPath"
function boolean Add(readonly string strZipFile) system library "PbIdea.dll" alias for "ZipAddFile"
function boolean Add(readonly string strName,readonly blob data) system library "PbIdea.dll" alias for "zipAddBlob"
function long GetEntryCount() system library "PbIdea.dll" alias for "zipGetEntryCount"
function boolean EntryExist(readonly string strName) system library "PbIdea.dll" alias for "zipEntryExist"
function boolean DeleteEntry(readonly string strName) system library "PbIdea.dll" alias for "zipDeleteEntry"
function boolean RenameEntry(readonly string strName,readonly string strNewName) system library "PbIdea.dll" alias for "zipRenameEntry"
//取列表
function long GetEntryList(ref long index[],ref string strName[],ref long fileSize[],ref long fileSizeCom[],ref string crc[],ref string strDateTime[],ref boolean encrypted[]) system library "PbIdea.dll" alias for "zipGetEntryList"

//unzip
function blob ReadBlob(long index) system library "PbIdea.dll" alias for "zipReadBuffer"  //按索引号读
function blob ReadBlob(readonly string strName) system library "PbIdea.dll" alias for "zipReadBuffer" //按名称读
function long Extract(readonly string strPath) system library "PbIdea.dll" alias for "zipExtract" //解压到指定目录
function long Extract(readonly string strPath,long index) system library "PbIdea.dll" alias for "zipExtract" //按索引号解压到指定目录
function long Extract(readonly string strPath,readonly string strName) system library "PbIdea.dll" alias for "zipExtract" //按名称解压到指定目录


//工具函数
function string FormatNumber(readonly string format,any number) system library "PbIdea.dll" alias for "FormatNumber" //格式化数字为字符串
function blob ReadFile(readonly string file) system library "PbIdea.dll" alias for "zipReadFile" //读文件为blob
function boolean WriteFile(readonly blob data, readonly string file) system library "PbIdea.dll" alias for "zipWriteFile" //将data写为文件
//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"


//test
subroutine PrintInfo(readonly string strZipFile) system library "PbIdea.dll" alias for "zipPrintInfo"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_zplay" id="uo_zplay">uo_zplay</a></div>
<pre><code>
//player
long length = 0   //总时间长，毫秒
long position = 0 //当前播放时长， 毫秒

private:
subroutine mp3Create() system library "PbIdea.dll" alias for "mp3Create"
subroutine mp3Destroy() system library "PbIdea.dll" alias for "mp3Destroy"
public:
//播放wav内容或文件
function boolean AddBlob(blob data) system library "PbIdea.dll" alias for "mp3AddBlob"
function boolean AddFile(string file) system library "PbIdea.dll" alias for "mp3AddFile"

function boolean Play() system library "PbIdea.dll" alias for "mp3Play"
function boolean Play(string file) system library "PbIdea.dll" alias for "mp3Play"
function boolean Play(blob data) system library "PbIdea.dll" alias for "mp3Play"
function boolean Play(ulong hwnd) system library "PbIdea.dll" alias for "mp3Play"
function boolean Play(string file, ulong hwnd) system library "PbIdea.dll" alias for "mp3Play"
function boolean Play(blob data, ulong hwnd) system library "PbIdea.dll" alias for "mp3Play"

function boolean Stop() system library "PbIdea.dll" alias for "mp3PlayStop"
function boolean Pause() system library "PbIdea.dll" alias for "mp3PlayPause"
function boolean Resume() system library "PbIdea.dll" alias for "mp3PlayResume"
function string GetID3(readonly string mp3file) system library "PbIdea.dll" alias for "mp3GetID3"

function boolean Seek(long offset) system library "PbIdea.dll" alias for "mp3Seek"
function boolean SeekToBegin() system library "PbIdea.dll" alias for "mp3SeekToBegin"
function boolean SeekToEnd() system library "PbIdea.dll" alias for "mp3SeekToEnd"

//返回时间长度，单位:毫秒(millisecond)，即秒*1000
function long GetLength() system library "PbIdea.dll" alias for "mp3GetLength"

//获取或设置音量，音量范围 0-100
function boolean GetVolume(ref int left, ref int right) system library "PbIdea.dll" alias for "mp3GetVolume"
function boolean SetVolume(int left, int right) system library "PbIdea.dll" alias for "mp3SetVolume"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_button" id="vo_button">vo_button</a></div>
<pre><code>
long backcolor = 67108864
string id = ""
string image = ""
string tooltip = ""
long color = 0 //text color

int buttonstyle = 0 //0 button , 1 checkbox

boolean checked = true //checkbox value
long iconcolor = 0 //checkbox color
int  checkboxstyle = 0 //0 普通 ，1 切换开关

ulong bordercolor = -1

boolean showfocus = false
int backmode = 0 //平面，或 linear 填充

ulong focus_backcolor = -1
ulong focus_textcolor = -1
ulong hovercolor = -1

int alpha = 230
long radius = 65283 //0xff03

string conner = ""

//子类化按钮
subroutine Init() system library "pbidea.dll" alias for "buttonInit"
subroutine buttonDestroy() system library "pbidea.dll" alias for "buttonDestroy"
subroutine AttachButton(commandbutton btn) system library "pbidea.dll" alias for "buttonInit"
subroutine DetachButton(commandbutton btn) system library "pbidea.dll" alias for "buttonDestroy"

//子类化父对象，以便能在 WM_DRAWITEM消息时刷新按钮
subroutine SubClassParent(window win) system library "pbidea.dll" alias for "buttonSubClassParent"
subroutine SubClassParent(userobject obj) system library "pbidea.dll" alias for "buttonSubClassParent"

//winapi刷新 
FUNCTION ulong InvalidateRect(ulong hwnd,ulong lpRect,ulong bErase) LIBRARY "user32.dll"
FUNCTION ulong UpdateWindow(ulong hwnd) LIBRARY "user32.dll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_datawindow_tree" id="vo_datawindow_tree">vo_datawindow_tree</a></div>
<pre><code>
//public:
constant int LOGPIXELSY = 90
constant int WM_GET_FLAG = 1026

protected:
uo_map _columns //dw all columns

public:
uo_json _dict //根据 rowid 记录状态

private:
int _level
int _rowheight = 0
ulong _hwnd = 0
long _processing = 0
long _units = 0
string _font_face = ""
int _font_height = 0 

uo_tempfile _files //保存临时文件,退出时会自动删除

string _bindcolumn = "" //绑定显示到 tree 的列，例如 text

int _flag_width //列宽状态，鼠标按下，抬起，判断列是否有改变

string _detail_color_express
boolean _row_status[] //每行显示或隐藏状态，用于设置 rowno,达到不同行不同颜色之目的
int _stack_level = 0 //expand 调用深度
boolean ib_clicked = false //是否 clicked 事件中

public:
//可设置参数

//图标和框大小
int BOXSIZE  = 10
int EXTRA    = 32
int ICONSIZE = 18
int ICONSIZE_ITEM = 10

string icon_folder = '<svg t="1695881653930" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14635" width="200" height="200"><path d="M853 266H514c-4 0-6-2-8-4l-38-66c-12-21-38-36-64-36H170c-40 0-74 34-74 74v554c0 40 34 74 74 74h682c40 0 74-34 74-74V341c0-40-34-74-74-74z m-682-42h232c4 0 6 2 8 4l38 66c12 21 38 36 64 36H853c6 0 10 4 10 10v74h-704V234c0-6 4-10 10-10z m682 576H170c-6 0-10-4-10-10V480h704V789c0 6-4 10-10 10z" fill="#e08020" stroke="#e08020" p-id="14636" /></svg>'
string icon_folder_open = '<svg t="1695881684176" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14783" width="200" height="200"><path d="M928 444H820V330c0-17-14-32-32-32H473L355 186c-1-1-3-2-5-2H96c-17 0-32 14-32 32v592c0 17 14 32 32 32h698c13 0 24-7 29-20l134-332c1-3 2-7 2-12 0-17-14-32-32-32zM136 256h188l119 114H748V444H238c-13 0-24 7-29 20L136 643V256z m635 512H159l103-256h612L771 768z" fill="#f0a020" stroke="#e08020" p-id="14784" /></svg>'
string icon_item = '<svg t="1703826337894" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="85292" width="200" height="200"><path d="M575 16l6 3 349 185c41 24 65 65 63 109l-0 5v369c0 45-23 87-62 111l-5 3-349 185c-21 10-43 16-66 16-22 0-43-4-60-13l-5-3-349-185a130 130 0 0 1-67-108l-0-5V320c0-46 23-89 62-113l5-3L446 19a141 141 0 0 1 129-3zM130 367v324c0 9 4 18 12 24l3 2L465 888v-342L130 367z m766 1l-328 175v337l313-165a29 29 0 0 0 15-23l0-3V369zM497 107L175 278l339 180 335-179-322-171a30 30 0 0 0-29-1z" fill="#1989FA" p-id="85293" /></svg>'

boolean ShowRoot = true
boolean ShowLine = true
int _style = 0
boolean FullRowClick = true

//此函数只能在 datawindow 里面声明
function boolean GetRowColUnderPoint(int x1, int y1, ref long row, ref int col) system library "pbidea.dll" alias for "GetRowColUnderPoint"
function boolean GetRowColUnderPointEx(int x1, int y1,int x2,int y2, ref long row1, ref int col1, ref long row2, ref int col2) system library "pbidea.dll" alias for "GetRowColUnderPointEx"
FUNCTION ulong GetSysColor(ulong nIndex) LIBRARY "user32.dll"
FUNCTION ulong SetTextColor(ulong hdc,ulong crColor) LIBRARY "gdi32.dll"
FUNCTION long GetKeyState(ulong nVirtKey) LIBRARY "user32.dll"

function string MD5(readonly string data) system library "PbIdea.dll" alias for "MD5String"
subroutine ParseDWTree (uo_json src, uo_json dict, datawindow dw) system library "PbIdea.dll" alias for "jsonParseDWTree"
function string CreateTreeHeader (datawindow dw, uo_json dict, long row) system library "PbIdea.dll" alias for "dwCreateTreeHeader"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_identification" id="vo_identification">vo_identification</a></div>
<pre><code>
public:
string is_code = ""

private:
uo_painter p

string str = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_json_datawindow" id="vo_json_datawindow">vo_json_datawindow</a></div>
<pre><code>
//cn:dw有关的json导入、导出
//en:Dw related json import and export

/***************************************************
* 特别注意，这组函数必须放在 datawindow/datastore 的继承类中 Local External Function 里面声明 !!!
***************************************************/
//此函数放在 dw/ds 的继承类中使用
//使用方法，在dw/ds 的继承类中 Local External Function 里面声明此函数，然后直接就可以 dw_1.ImportJson("data.json")
function long    ImportJson(string jsonFile) system library "PbIdea.dll" alias for "ImportJson"

//将datawindow/datastore 数据生成JSON，返回生成条数,status : 0:NotModified! , 1:DataModified! ,2:New!,3:NewModified!	
//参数jsonFile为直接生成到文件
//3个参数，可以任意组合，自己声明吧
//使用方法，在dw/ds 的继承类中 Local External Function 里面声明此函数，然后直接就可以 dw_1.ExportJson("data.json")
function long    ExportJson(string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(int status) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(int status ,string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
//只导出listColumns指定的所有列数
function long    ExportJson(string listColumns[]) system library "PbIdea.dll" alias for "ExportJson"
function long    ExportJson(string listColumns[],string jsonFile) system library "PbIdea.dll" alias for "ExportJson"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_lineedit" id="vo_lineedit">vo_lineedit</a></div>
<pre><code>
string PlaceHolder = ""
long PlaceHolderColor = RGB(160, 160, 180)

subroutine Init() system library "pbidea.dll" alias for "lineeditInit"
subroutine UnInit() system library "pbidea.dll" alias for "lineeditUnInit"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_menubar" id="vo_menubar">vo_menubar</a></div>
<pre><code>
string icon = ""

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_pbidea_toolbar" id="vo_pbidea_toolbar">vo_pbidea_toolbar</a></div>
<pre><code>
int backmode = 0
//int style = 0 //0 小图标， 1， 图标在左标签在右， 2 图标在下标签在上
int maxSize = 64 //最宽值，像素
private:
uo_json _json

private:
subroutine tbInit() system library "pbidea.dll" alias for "tbInit"
subroutine tbUnInit() system library "pbidea.dll" alias for "tbUnInit"

public:
subroutine SetJson(uo_json js) system library "pbidea.dll" alias for "tbSetJson"
subroutine GetJson(uo_json js) system library "pbidea.dll" alias for "tbGetJson"
//reset
subroutine Reset() system library "pbidea.dll" alias for "tbReset"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_splitbar" id="vo_splitbar">vo_splitbar</a></div>
<pre><code>
//cn:窗口布局分割器,自动布局
//en: window layout splitter, automatic layout

boolean fixed = false

protected:
subroutine splitbarCreate(int splittype) system library "PbIdea.dll" alias for "splitbarCreate"
subroutine splitbarDestroy() system library "PbIdea.dll" alias for "splitbarDestroy"
public:
//leftORright_topORbottom : 1 为左或上，2为右或下
subroutine AddObject(PowerObject obj,int leftORright_topORbottom) system library "PbIdea.dll" alias for "splitbarAddObject"
subroutine AddObject(ulong hwnd,int leftORright_topORbottom) system library "PbIdea.dll" alias for "splitbarAddObject"
//计算布局，并设置有关控件大小
subroutine Resize() system library "PbIdea.dll" alias for "splitbarResize"
//设置边距
subroutine SetPadding(int left,int top,int right,int bottom) system library "PbIdea.dll" alias for "splitbarSetPadding"
//是否固定，不让拖动
subroutine SetFixed(boolean fixed) system library "PbIdea.dll" alias for "splitbarSetFixed"
//收缩到左/上边
subroutine Shrink(boolean shrinked) system library "PbIdea.dll" alias for "splitbarShrink"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_splitbar_h" id="vo_splitbar_h">vo_splitbar_h</a></div>
<pre><code>
//cn:横向 vo_splitbar
//en:Horizontal vo_ splitbar

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_splitbar_v" id="vo_splitbar_v">vo_splitbar_v</a></div>
<pre><code>
//cn:纵向 vo_splitbar
//en:portrait vo_ splitbar

</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="vo_statusbar" id="vo_statusbar">vo_statusbar</a></div>
<pre><code>
//cn:状态条
//en: status bar

protected:
subroutine stbarCreate() system library "pbidea.dll" alias for "stbarCreate"
subroutine stbarDestroy() system library "pbidea.dll" alias for "stbarDestroy"
public:
//添加一个文本显示域
//size ，文本宽度，如果为-1，则自动宽度. 返回 id,以后用此id操作该项
//align, 0 left, 1 center, 2 right
//icon 前置图标, defaultText 默认文本
function uint AddText(int size) system library "pbidea.dll" alias for "stbarAddText"
function uint AddText(int size, int align) system library "pbidea.dll" alias for "stbarAddText"
function uint AddText(int size, int align, readonly string icon) system library "pbidea.dll" alias for "stbarAddText"
function uint AddText(int size, int align, readonly string icon, readonly string defaultText) system library "pbidea.dll" alias for "stbarAddText"
//添加一个按钮
//size ，文本宽度，如果为-1，则自动宽度. 返回 id,以后用此id操作该项
//align, 0 left, 1 center, 2 right
//icon 前置图标
function uint AddButton(int size) system library "pbidea.dll" alias for "stbarAddButton"
function uint AddButton(int size, readonly string icon) system library "pbidea.dll" alias for "stbarAddButton"
function uint AddButton(int size, readonly string icon, readonly string tip) system library "pbidea.dll" alias for "stbarAddButton"
//设置指定id的文本
subroutine SetText(int id, readonly string strText) system library "pbidea.dll" alias for "stbarSetText"
//设置指定id的图标
subroutine SetIcon(int id, readonly string strIcon) system library "pbidea.dll" alias for "stbarSetIcon"

//任意一个 text 域，可作为进度条显示.
//设置最小值最大值范围，开始显示进度条
subroutine SetProgressMinMax(int id, long minValue, long maxValue) system library "pbidea.dll" alias for "stbarSetProgressMinMax"
//设置值, 当value < minValue or value > maxValue 会自动隐藏，不需要调用 stbarHideProgress. 
//当进度条显示时，在该text上调用 SetText ，也会自动隐藏该进度条
subroutine SetProgressValue(int id, long value) system library "pbidea.dll" alias for "stbarSetProgressValue"
//隐藏
subroutine HideProgress(int id) system library "pbidea.dll" alias for "stbarHideProgress"

//设置皮肤
subroutine SetSkin(uo_json skin) system library "pbidea.dll" alias for "stbarSetSkin"

//reset
subroutine Reset() system library "pbidea.dll" alias for "stbarReset"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_database" id="uo_database">uo_database</a></div>
<pre><code>
//cn:数据库对象，访问各类数据库
//en:Database objects, accessing various databases

//db.DBParm = 'UseAPI=OLEDB;DBPROP_INIT_TIMEOUT=1;UseStreamForLongOrLobParameters="0";ICommandPrepare="SetParameterInfo"' //mssql 后2个参数对blob绑定有效，否则会报错

//字段类型
constant int  NO_TYPE       = 0
constant int  INT_TYPE      = 1
constant int  LONG_TYPE     = 2
constant int  FLOAT_TYPE    = 3
constant int  DOUBLE_TYPE   = 4
constant int  DEC_TYPE      = 5
constant int  STRING_TYPE   = 6
constant int  BOOL_TYPE     = 7
constant int  ANY_TYPE      = 8
constant int  UINT_TYPE     = 9
constant int  ULONG_TYPE    = 10
constant int  BINARY_TYPE   = 11
constant int  DATE_TYPE     = 12
constant int  TIME_TYPE     = 13
constant int  DATETIME_TYPE = 14
constant int  LONGLONG_TYPE = 20

//属性DBMS支持数据库连接有
/*
1.  "ODBC"
2.  "MSS" 或者 "Microsoft SQL Server" 或者 "MSS Microsoft SQL Server" 
3.  "Oracle" 或者 "O90" 或者 "O12" 之类，以大写字母O打头皆视为连接oracle数据库 , 注意设置 ThreadSafe="Yes"
4.  "InterBase" 或者 "Firebird" 或者 "InterBase/Firebird"
5.  "SQLBase"
6.  "DB2"
7.  "Sybase"
8.  "MySQL"
9.  "PostgreSQL"
10. "SQLite"
11. "SQLAnywere"
*/

private:
//创建数据库连接对象
function ulong sqlCreate() system library "PbIdea.dll" alias for "sqlCreate"
//销毁数据库连接对象
subroutine sqlDestroy() system library "PbIdea.dll" alias for "sqlDestroy"

public:
//连接数据库，要先设置好属性
function boolean Open() system library "PbIdea.dll" alias for "sqlOpen"
function boolean Open(readonly string configFile) system library "PbIdea.dll" alias for "sqlOpen"
function boolean IsOpen() system library "PbIdea.dll" alias for "sqlIsOpen"
function boolean IsAlive() system library "PbIdea.dll" alias for "sqlIsAlive"

//设置事务级别
/*
ANSILevel0      = 0, //!< standard ANSI isolation level 0
ANSILevel1      = 1 //!< standard ANSI isolation level 1
ANSILevel2      = 2 //!< standard ANSI isolation level 2
ANSILevel3      = 3 //!< standard ANSI isolation level 3
Snapshot        = 4 //!< isolation level 'Snapshot'
ReadUncommitted = ANSILevel0, //!< isolation level 'Read Uncommitted'
ReadCommitted   = ANSILevel1, //!< isolation level 'Read Committed'
RepeatableRead  = ANSILevel2, //!< isolation level 'Repeatable Read'
Serializable    = ANSILevel3, //!< isolation level 'Serializable'
*/
subroutine SetTransLevel(int level) system library "PbIdea.dll" alias for "sqlSetTransLevel"

//断开数据库连接
subroutine Close() system library "PbIdea.dll" alias for "sqlClose"
//提交
subroutine CommitTrans() system library "PbIdea.dll" alias for "sqlCommit"
//回滚
subroutine RollbackTrans() system library "PbIdea.dll" alias for "sqlRollback"
//执行SQL语句,返回一个结果集对象,参数可以是单独的n个参数，也可以是一个any数组
function uo_recordset ExecuteSQL(readonly string sql,...) system library "PbIdea.dll" alias for "sqlExecute"
//准备语句
function uo_recordset PrepareSQL(readonly string sql) system library "PbIdea.dll" alias for "sqlPrepare"
//执行SQL语句,返回一个any类型的结果值
function any ExecuteScaler(readonly string sql) system library "PbIdea.dll" alias for "sqlExecuteScaler"
function any ExecuteScaler(readonly string sql,ref boolean success) system library "PbIdea.dll" alias for "sqlExecuteScaler"

//返回execute 后受影响的行数
function long RowsAffected() system library "PbIdea.dll" alias for "sqlDbRowsAffected"

//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"

//将所有属性存为配置文件
//注意：可在开发环境下，连接成功后，利用此函数，将属存为配置文件，以后可以直接用 Open(配置文件) 开始连接，不用设置对象的相关属性
function int SaveConfig(readonly string configFile) system library "PbIdea.dll" alias for "sqlSaveConfig"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_database_pool" id="uo_database_pool">uo_database_pool</a></div>
<pre><code>
//cn:数据库连接池，即批量开通连接，在线程里可以通过名称取指定空闲连接
//en:Database connection pool, that is, batch open connections. You can specify idle connections by name in the thread

private:
subroutine InitPool() system library "PbIdea.dll" alias for "dbInitPool"
public:
//创建数据库连接池,指定池名称、预设连接数、模板连接，连接信息从db中取
//这里的名称可以是一组连接共用的名称，例如sqlserver ,oracle ora1 ,sql1 等等
function int CreatePool(readonly string poolName,uo_database db) system library "PbIdea.dll" alias for "dbCreatePool"

//销毁连接池，并且将数据库连接全部释放
subroutine DestroyPool() system library "PbIdea.dll" alias for "dbDestroyPool"

//从池中申请一个连接，切记用完要还回去，destroy也会自动还回去.
//连接池中的连接在10钟后如果没有活动，则会被自动断开
function uo_database QueryPool(readonly string poolNam) system library "PbIdea.dll" alias for "dbQueryPool"

//还给连接池
subroutine GiveBackPool(uo_database db) system library "PbIdea.dll" alias for "dbGiveBackPool"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_field" id="uo_field">uo_field</a></div>
<pre><code>
//cn:结果集的字段记录
//en:Field record of result set

subroutine close() system library "PbIdea.dll" alias for "sqlFieldClose"
//取字段名
function string GetName()  system library "PbIdea.dll" alias for "sqlGetName"
//取字段类型,类型定义在 uo_connect 里面
function int GetType()  system library "PbIdea.dll" alias for "sqlGetType"
//取字段大小
function int GetSize()  system library "PbIdea.dll" alias for "sqlGetSize"
//取字段精度
function int GetPrecision()  system library "PbIdea.dll" alias for "sqlGetPrecision"
//取字段小数位数
function int GetScale()  system library "PbIdea.dll" alias for "sqlGetScale"

//取字段值,注意，几乎所有字段值都可以强制为string
function string   GetString()    system library "PbIdea.dll" alias for "sqlGetString"
function decimal  GetDeciaml()   system library "PbIdea.dll" alias for "sqlGetDeciaml"
function double   GetDouble()    system library "PbIdea.dll" alias for "sqlGetDouble"
function long     GetLong()      system library "PbIdea.dll" alias for "sqlGetLong"
function int      GetInt()       system library "PbIdea.dll" alias for "sqlGetInt"
function longlong GetLongLong()  system library "PbIdea.dll" alias for "sqlGetLongLong"
function date     GetDate()      system library "PbIdea.dll" alias for "sqlGetDate"
function time     GetTime()      system library "PbIdea.dll" alias for "sqlGetTime"
function datetime GetDateTime()  system library "PbIdea.dll" alias for "sqlGetDateTime"
function blob     GetBlob()      system library "PbIdea.dll" alias for "sqlGetBlob"
function boolean  GetBool()      system library "PbIdea.dll" alias for "sqlGetBool"


//工具函数，打印数据到控制台
function int Printf(string strFormat,...) system library "PbIdea.dll" alias for "Printf"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_recordset" id="uo_recordset">uo_recordset</a></div>
<pre><code>
//cn:记录结果集
//en:Record result set

public:
//销毁数据库连接对象
subroutine Close() system library "PbIdea.dll" alias for "sqlResultSetDestroy"
//是否是结果集，可以检索数据
//如果有多个结果集，可以不断判断后检索数据
function boolean HasResultSet() system library "PbIdea.dll" alias for "sqlHasResultSet"
//DML语句后，查多少条记录受到影响
function long RowsAffected() system library "PbIdea.dll" alias for "sqlRowsAffected"
//取字段个数
function int GetFieldCount()  system library "PbIdea.dll" alias for "sqlGetFieldCount"
//取字段
function uo_field GetField(int fieldIndex)  system library "PbIdea.dll" alias for "sqlGetField"
function uo_field GetField(readonly string fieldName)  system library "PbIdea.dll" alias for "sqlGetField"
//检索数据
function boolean FetchNext() system library "PbIdea.dll" alias for "sqlFetch"
function boolean FetchNext(ref any fieldValue[]) system library "PbIdea.dll" alias for "sqlFetch"
//检索数据到 uo_json, binaryMode: 对 BINARY_TYPE字段处理方式： 0(默认): 不处理值为NULL, 1: 努力解析为字符串, 2: 编码为base64
function uo_json FetchJson() system library "PbIdea.dll" alias for "sqlFetchJson"
function uo_json FetchJson(int binaryMode) system library "PbIdea.dll" alias for "sqlFetchJson"
function int FetchJsons(ref uo_json jsons[]) system library "PbIdea.dll" alias for "sqlFetchJsons"
function int FetchJsons(ref uo_json jsons[], int binaryMode) system library "PbIdea.dll" alias for "sqlFetchJsons"
//批量绑定参数,参数可以是单独的n个参数，也可以是一个any数组
function boolean BindParams(...) system library "PbIdea.dll" alias for "sqlBindParams"
//单个绑定参数,如果有出参，一定要使用此函数
/*参数说明：
nParamPos   : 位置 ，1 2 3 4 ... 等
nParamName  : 参数名称
any value   : 入参参数值
ref any returnValue : 出参参数变量
nSize       : 出参参数大小，字符串和blob时有效。如果为0，默认取1024
*/
function boolean BindParam(int    nParamPos  ,readonly any value) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(int    nParamPos  ,ref string   returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(int    nParamPos  ,ref long     returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(int    nParamPos  ,ref longlong returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(int    nParamPos  ,ref double   returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(int    nParamPos  ,ref uo_recordset rs) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName ,readonly any value) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName ,ref string   returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName ,ref long     returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName ,ref longlong returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName ,ref double   returnValue , long nSize) system library "PbIdea.dll" alias for "sqlBindParam"
function boolean BindParam(readonly string nParamName,ref uo_recordset rs) system library "PbIdea.dll" alias for "sqlBindParam"
//执行语句
function boolean ExecuteSQL() system library "PbIdea.dll" alias for "sqlExecuteSQL"


//工具函数，打印数据到控制台
function int Printf(readonly string strFormat,...) system library "PbIdea.dll" alias for "Printf"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_chart" id="uo_chart">uo_chart</a></div>
<pre><code>
//cn:图表控件
//en:chart control

public:
//常量定义
//绘制类别
CONSTANT int PAINT_HWND   = 1
CONSTANT int PAINT_HDC    = 2
CONSTANT int PAINT_IMAGE  = 3

uo_painter p

public:
string charttype[] = {"line","bar","area","pie","npie","percent","scatter","radar","barline","guage","h_bar"}
string is_charttype = "line" //默认类型

string is_title = "本周数据统计" //主标题
string is_title1 = "(单位:万元)" //副标题
string is_unit[]          //计量单位

ulong il_color[] //颜色
ulong il_colorstyle = 1 //颜色风格
int  ii_linewidth = 2 //线宽 
ulong il_backcolor = RGB(24,24,24) //RGB(255,255,255) //背景颜色
ulong il_textcolor = RGB(220,220,220)  //RGB(60,60,60)    //普通字体颜色 
ulong il_axiscolor = RGB(220,220,220)  //坐标线
string is_picture = "" //自动生成的图片名称 
string is_legend[]       //图例
boolean ib_DrawGridV = TRUE //是否绘制坐标网络线
boolean ib_DrawGridH = TRUE //是否绘制坐标网络线
int ii_alpha = 200         //图表的透明度
int ii_padding = 30 //边距

int ii_nodeType = 3 //用于折线交接节点，0 无 1 方块 2 圆 3 周围留空的圆
boolean ib_curve = false //曲线 或折线
boolean ib_link = TRUE //是否是一个圆环，pie 有效
boolean ib_3dbar = FALSE //是否是3D bar
boolean ib_stack = TRUE //是否是堆叠,用于bar
ulong il_tipbkcolor = RGB(50,50,50) // RGB(255,255,187) //tip颜色
ulong il_tipcolor = RGB(255,255,255) // RGB(255,255,187) //tip颜色
boolean ib_show_dzz = TRUE //是否显示大自在水印在底部
double id_percent[] = {1.0} //百分比chart的值,仅对 percent 环形图有效,guage 有效
double id_maxvalue[] = {100} //结合上面id_percent，显示 guage指针位置
int ii_space = 2 //percent guage ，有多个时，两者之间的间隔

private:
str_option istr_option //数据
long il_clientwidth,il_clientheight //窗口客户区高度宽度
long il_split_width,il_split_height
long il_ydata_count,il_xdata_count
long il_ysplit_count,il_xsplit_count
double il_yarray[]
double il_xarray[] //for hbar
string is_xarray[]
string is_yarray[] //for hbar

long il_titleheight = 0    //标题高度
long il_x = 100,il_y = 100 //坐标
long il_height = 80 //chart 高度
long il_width = 100 //chart 宽度

boolean ib_rader_fill = false //雷达图是否填充
boolean ib_v2h = false
//
long il_xpos = 0,il_ypos = 0 //鼠标位置
long il_posindex = 0 //即当前鼠标所指的数据索引,列数据,单行时只此就行了，多行时要结合 il_posrow
long il_posrow   = 0 //即当前鼠标所指的数据索引,行数据,多行时用得到

//pie
long il_pie_r = 1 //饼图半径
long il_ox,il_oy //pie 的圆心
long il_angle[]  //角度
long il_pie_out = 0 //饼图脱离距离

//bar
apirect is_bar[] //bar rect

//line,area
apipoint is_point[] //line , area

//新特性
ulong il_color1[] = { &
rgb(99,178,238), rgb(118,218,145), rgb(248,203,127), rgb(248,149,136), rgb(124,214,207), rgb(145,146,171), rgb(120,152,225), rgb(239,166,102), &
rgb(237,221,134), rgb(153,135,206), rgb(99,178,238), rgb(118,218,145), rgb(248,203,127), rgb(248,149,136), rgb(124,214,207), rgb(145,146,171), &
rgb(120,152,225), rgb(239,166,102), rgb(237,221,134), rgb(153,135,206), rgb(99,178,238), rgb(118,218,145), rgb(248,203,127), rgb(248,149,136), &
rgb(124,214,207), rgb(145,146,171), rgb(120,152,225), rgb(239,166,102), rgb(237,221,134), rgb(153,135,206), rgb(99,178,238), rgb(118,218,145) &
} 
//明亮
ulong il_color2[] = { &
 rgb(14,114,204), rgb(108,163,15), rgb(245,147,17), rgb(250,67,67), rgb(22,175,204), rgb(133,192,33), rgb(209,42,106), rgb(14,114,204), &
rgb(108,163,15), rgb(245,147,17), rgb(250,67,67), rgb(22,175,204), rgb(133,192,33), rgb(209,42,106), rgb(14,114,204), rgb(108,163,15), rgb(245,147,17), &
rgb(250,67,67), rgb(22,175,204), rgb(133,192,33), rgb(209,42,106), rgb(14,114,204), rgb(108,163,15), rgb(245,147,17), rgb(250,67,67), rgb(22,175,204), &
rgb(133,192,33), rgb(209,42,106), rgb(14,114,204), rgb(108,163,15), rgb(245,147,17), rgb(250,67,67) &
}
//雅致
ulong il_color3[] = { &
 rgb(54,130,190), rgb(69,167,118), rgb(240,83,38), rgb(238,215,119), rgb(51,79,101), rgb(179,151,78), rgb(56,203,125), rgb(221,174,51), &
rgb(132,75,179), rgb(147,197,85), rgb(95,102,148), rgb(223,56,129), rgb(46,146,150), rgb(54,130,190), rgb(69,167,118), rgb(240,83,38), rgb(238,215,119), &
rgb(51,79,101), rgb(179,151,78), rgb(56,203,125), rgb(221,174,51), rgb(132,75,179), rgb(147,197,85), rgb(95,102,148), rgb(223,56,129), rgb(46,146,150), &
rgb(54,130,190), rgb(69,167,118), rgb(240,83,38), rgb(238,215,119), rgb(51,79,101), rgb(179,151,78) &
}
//柔和
ulong il_color4[] = { &
 rgb(91,155,213), rgb(237,125,49), rgb(112,173,71), rgb(255,192,0), rgb(68,114,196), rgb(145,208,36), rgb(178,53,230), rgb(2,174,117), &
rgb(91,155,213), rgb(237,125,49), rgb(112,173,71), rgb(255,192,0), rgb(68,114,196), rgb(145,208,36), rgb(178,53,230), rgb(2,174,117), rgb(91,155,213), &
rgb(237,125,49), rgb(112,173,71), rgb(255,192,0), rgb(68,114,196), rgb(145,208,36), rgb(178,53,230), rgb(2,174,117), rgb(91,155,213), rgb(237,125,49), &
rgb(112,173,71), rgb(255,192,0), rgb(68,114,196), rgb(145,208,36), rgb(178,53,230), rgb(2,174,117) &
}
//淡雅
ulong il_color5[] = { &
 rgb(124,181,236), rgb(67,67,72), rgb(144,237,125), rgb(247,163,92), rgb(128,133,233), rgb(241,92,128), rgb(228,211,84), rgb(124,181,236), &
rgb(67,67,72), rgb(144,237,125), rgb(247,163,92), rgb(128,133,233), rgb(241,92,128), rgb(228,211,84), rgb(124,181,236), rgb(67,67,72), rgb(144,237,125), &
rgb(247,163,92), rgb(128,133,233), rgb(241,92,128), rgb(228,211,84), rgb(124,181,236), rgb(67,67,72), rgb(144,237,125), rgb(247,163,92), rgb(128,133,233), &
rgb(241,92,128), rgb(228,211,84), rgb(124,181,236), rgb(67,67,72), rgb(144,237,125), rgb(247,163,92) &
}
//复古
ulong il_color6[] = { &
 rgb(7,128,207), rgb(118,80,5), rgb(250,109,29), rgb(14,44,130), rgb(182,181,31), rgb(218,31,24), rgb(112,24,102), rgb(244,122,117), &
rgb(0,157,178), rgb(2,75,81), rgb(7,128,207), rgb(118,80,5), rgb(250,109,29), rgb(14,44,130), rgb(182,181,31), rgb(218,31,24), rgb(112,24,102), &
rgb(244,122,117), rgb(0,157,178), rgb(2,75,81), rgb(7,128,207), rgb(118,80,5), rgb(250,109,29), rgb(14,44,130), rgb(182,181,31), rgb(218,31,24), &
rgb(112,24,102), rgb(244,122,117), rgb(0,157,178), rgb(2,75,81), rgb(7,128,207), rgb(118,80,5) &
} 
//商务
ulong il_color7[] = { &
 rgb(25,79,151), rgb(85,85,85), rgb(189,107,8), rgb(0,104,107), rgb(200,45,49), rgb(98,91,161), rgb(137,137,137), rgb(156,152,0), rgb(0,127,84), &
rgb(161,149,197), rgb(16,54,103), rgb(241,146,114), rgb(193,140,0), rgb(54,54,54), rgb(66,111,179), rgb(102,191,127), rgb(249,205,118), rgb(57,40,132), &
rgb(0,174,113), rgb(147,170,214), rgb(73,7,97), rgb(250,241,75), rgb(149,83,5), rgb(1,98,65), rgb(115,136,193), rgb(143,30,32), rgb(249,205,118), rgb(214,155,1), &
rgb(183,183,183), rgb(81,31,144), rgb(153,208,185), rgb(199,195,0) &
}
//清新
ulong il_color8[] = { &
 rgb(0,168,225), rgb(153,204,0), rgb(227,0,57), rgb(252,211,0), rgb(128,0,128), rgb(0,153,78), rgb(255,102,0), rgb(128,128,0), rgb(219,0,194), &
rgb(0,128,128), rgb(0,0,255), rgb(200,204,0), rgb(0,18,133), rgb(0,202,204), rgb(224,56,0), rgb(250,155,0), rgb(133,10,0), rgb(153,0,137), rgb(191,102,0), &
rgb(0,191,94), rgb(141,0,220), rgb(250,241,0), rgb(149,83,0), rgb(0,98,65), rgb(115,136,193), rgb(143,30,32), rgb(249,205,118), rgb(214,155,1), rgb(183,183,183), &
rgb(81,31,144), rgb(153,208,185), rgb(199,195,0) &
}
//经典
ulong il_color9[] = { &
 rgb(0,44,83), rgb(255,165,16), rgb(12,132,198), rgb(255,189,102), rgb(247,77,77), rgb(36,85,164), rgb(65,183,172), rgb(0,44,83), &
rgb(255,165,16), rgb(12,132,198), rgb(255,189,102), rgb(247,77,77), rgb(36,85,164), rgb(65,183,172), rgb(0,44,83), rgb(255,165,16), rgb(12,132,198), &
rgb(255,189,102), rgb(247,77,77), rgb(36,85,164), rgb(65,183,172), rgb(0,44,83), rgb(255,165,16), rgb(12,132,198), rgb(255,189,102), rgb(247,77,77), &
rgb(36,85,164), rgb(65,183,172), rgb(0,44,83), rgb(255,165,16), rgb(12,132,198), rgb(255,189,102) &
}
//渐变
ulong il_color10[] = { &
 rgb(93,165,80), rgb(113,174,70), rgb(150,183,68), rgb(196,204,56), rgb(235,225,42), rgb(234,176,38), rgb(227,133,43), rgb(216,93,42), rgb(206,38,38), rgb(172,32,38), &
rgb(113,174,70), rgb(150,183,68), rgb(196,204,56), rgb(235,225,42), rgb(234,176,38), rgb(227,133,43), rgb(216,93,42), rgb(206,38,38), rgb(172,32,38), rgb(113,174,70), &
rgb(150,183,68), rgb(196,204,56), rgb(235,225,42), rgb(234,176,38), rgb(227,133,43), rgb(216,93,42), rgb(206,38,38), rgb(172,32,38), rgb(113,174,70), rgb(150,183,68), &
rgb(196,204,56), rgb(235,225,42), rgb(234,176,38) &
}
//怀旧
ulong il_color11[] = { &
 rgb(59,98,145), rgb(148,60,57), rgb(119,144,67), rgb(98,76,124), rgb(56,132,152), rgb(191,115,52), rgb(63,104,153), rgb(156,64,61), &
rgb(125,152,71), rgb(103,80,131), rgb(59,139,161), rgb(201,121,55), rgb(66,109,161), rgb(164,67,64), rgb(132,159,75), rgb(108,84,138), rgb(63,146,169), &
rgb(211,127,58), rgb(69,114,167), rgb(170,70,67), rgb(137,165,78), rgb(113,88,143), rgb(65,152,175), rgb(219,132,61), rgb(72,118,174), rgb(177,73,70), &
rgb(142,172,81), rgb(117,91,149), rgb(68,158,182), rgb(228,138,64), rgb(75,123,180), rgb(183,76,73), rgb(255,0,0) &
} 
//echart
ulong il_color12[] = {rgb(194,53,49),rgb(97,160,168),rgb(47,69,84),rgb(212,130,101),rgb(145,199,174),rgb(116,159,131),rgb(202,134,34),rgb(189,162,154),rgb(110,112,116),rgb(84,101,112),rgb(196,204,211)}
//echart light
ulong il_color13[] = {rgb(49,165,222),rgb(49,198,239),rgb(99,231,231),rgb(156,231,189),rgb(255,222,90),rgb(255,156,123),rgb(255,115,148),rgb(231,99,173),rgb(231,148,214),rgb(231,189,247),rgb(156,148,247),rgb(132,123,239),rgb(148,189,255)}
//echart dark
ulong il_color14[] = {rgb(222,107,99),rgb(115,156,165),rgb(231,156,132),rgb(140,198,173),rgb(239,123,82),rgb(239,222,123),rgb(115,165,115),rgb(115,189,189),rgb(115,140,173),rgb(148,206,140),rgb(247,156,66)}

FUNCTION ulong InvalidateRect(ulong hwnd,long lpRect,ulong bErase) LIBRARY "user32.dll"
FUNCTION ulong UpdateWindow(ulong hwnd) LIBRARY "user32.dll"
FUNCTION ulong BitBlt(ulong hDestDC,ulong x,ulong y,ulong nWidth,ulong nHeight,ulong hSrcDC,ulong xSrc,ulong ySrc,ulong dwRop) LIBRARY "gdi32.dll"
FUNCTION ulong ClientToScreen(ulong hwnd,ref APIPOINT lpPoint) system LIBRARY "pbidea.dll" alias for "utilClientToScreen"
FUNCTION ulong ScreenToClient(ulong hwnd,ref APIPOINT lpPoint) system LIBRARY "pbidea.dll" alias for "utilScreenToClient"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_led" id="uo_led">uo_led</a></div>
<pre><code>
//led control

public:
long il_backcolor = RGB(255,255,255)
long il_id = 0
string is_image = ""
int ii_alpha = 255

private:
uo_painter p
//boolean ib_breathing = false
boolean ib_add = false
int ii_breath_depth = 0
long il_timerid = 0

FUNCTION ulong SetTimer(ulong hWnd,ulong nIDEvent,ulong uElapse,ulong lpTimerFunc) LIBRARY "user32.dll"
FUNCTION ulong KillTimer(ulong hwnd,ulong nIDEvent) LIBRARY "user32.dll"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_fingerprint" id="uo_fingerprint">uo_fingerprint</a></div>
<pre><code>
//cn:海康威视指纹仪
//en:Hikvision fingerprint instrument

constant int FP_MSG_PRESS_FINGER     = 0 // 录入指纹 提示按手指
constant int FP_MSG_RISE_FINGER      = 1 // 录入指纹 提示抬手指
constant int FP_MSG_ENROLL_TIME      = 2 // 录入指纹 次数提示
constant int FP_MSG_READ_FINGER      = 4 // 刷指纹读取到ID号

private:
//初始函数，对象私用
function ulong FP_Create() system library "PbIdea.dll" alias for "FP_Create"
subroutine FP_Destroy() system library "PbIdea.dll" alias for "FP_Destroy"

public:
//判断是不是完成初始化
function boolean FP_Ready() system library "PbIdea.dll" alias for "FP_Ready"
//检查一下，当前是不是有指头放在指纹仪上
function boolean FP_DetectFinger() system library "PbIdea.dll" alias for "FP_DetectFinger"
//抓取指纹图像,返回blob数据,如果给字fileName参数，在返回图片数据的同时 ，存为文件.
function blob FP_CaptuteImage() system library "PbIdea.dll" alias for "FP_CaptuteImage"
function blob FP_CaptuteImage(string fileName) system library "PbIdea.dll" alias for "FP_CaptuteImage"
//设置超时,通常是采集指纹时，等待输入指纹的时间
function boolean FP_SetTimerout(int nSeconds) system library "PbIdea.dll" alias for "FP_SetTimerout"
//设置采集次数。通常在采集指纹时设置为0，即自动采集2-4次。在刷指纹时，设置为1，即读一次指纹后进行比对
function boolean FP_SetCollectTimes(int nTimes) system library "PbIdea.dll" alias for "FP_SetCollectTimes"
//采集指纹，通常先超时和采集次数，然后调用本函数.返回值0->执行成功 1->通信失败 2->采集超时 3->录入失败 ，data 返回十六进制的指纹特征.quantity 返回数据质量0-100
function boolean FP_CollectData(ref string data,ref int quantity) system library "PbIdea.dll" alias for "FP_CollectData"
//装载指纹数据到内存，以便后面刷指纹比对
function long FP_LoadData(uo_json jsonData) system library "PbIdea.dll" alias for "FP_LoadData"
//刷指纹
function boolean FP_ReadFinger() system library "PbIdea.dll" alias for "FP_ReadFinger"
function boolean FP_ReadFinger(boolean autoRead) system library "PbIdea.dll" alias for "FP_ReadFinger"
//取错误信息
function string FP_GetError() system library "PbIdea.dll" alias for "FP_GetError"
</code></pre>
</div>


</div>
<div class="library">
<div class="entry">
<div class="entrytitle"><a name="uo_hcusb" id="uo_hcusb">uo_hcusb</a></div>
<pre><code>
//cn:海康威视身份证
//en:Hikvision ID Card

//ctrl
constant string USB_SDK_CTRL_RESET_RFC             = "0x0102"
constant string USB_SDK_CTRL_STOP_CARD_OPER        = "0x0105"
constant string USB_SDK_CTRL_M1_BLOCK_TO_REG       = "0x010C"
constant string USB_SDK_CTRL_M1_REG_TO_BLOCK       = "0x010D"

//get
constant string USB_SDK_GET_HAIRPIN_VERSION        = "0x0101"
constant string USB_SDK_GET_ACTIVATE_CARD          = "0x0104"
constant string USB_SDK_GET_M1_READ_BLOCK          = "0x0107"
constant string USB_SDK_GET_CPU_CARD_RESET         = "0x0112"

private:
//初始函数，对象私用
function ulong HCUsb_Create() system library "PbIdea.dll" alias for "HCUsb_Create"
subroutine HCUsb_Destroy() system library "PbIdea.dll" alias for "HCUsb_Destroy"

public:
//获取设备列表,返回值为设备数，列表存在 json里,注意json 里的 deviceID，后续功能需要这个 deviceID
function int HCUsb_GetDeviceList(uo_json json) system library "PbIdea.dll" alias for "HCUsb_GetDeviceList"
function boolean HCUsb_Login(uo_json json) system library "PbIdea.dll" alias for "HCUsb_Login"
function boolean HCUsb_Logout() system library "PbIdea.dll" alias for "HCUsb_Logout"
//控制设备
function boolean HCUsb_ControlDevice(uo_json json) system library "PbIdea.dll" alias for "HCUsb_ControlDevice"
//获取设备信息
function boolean HCUsb_GetDeviceConfig(uo_json json) system library "PbIdea.dll" alias for "HCUsb_GetDeviceConfig"

function ulong H(readonly string strHex) SYSTEM library "PbIdea.dll" alias for "FromHex"
</code></pre>
</div>


</div>

</body>
</html>
